<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1">



<title>Estimating the intensive and extensive margin of trade</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Estimating the intensive and extensive margin of trade</h1>



<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>In econometrics, fixed effects models are popular to control for unobserved heterogeneity in data sets with a panel structure. In non-linear models this is usually done by including a dummy variable for each level of a fixed effects category. This approach can quickly become infeasible if the number of levels and/or fixed effects categories increases (either due to memory or time limitations).</p>
<p>Two examples of this limitation can be found in the literature on international trade. Firstly, when it comes to estimating the determinants of trade volumes (intensive margin) or secondly, when it comes to the export decisions (extensive margin). In order to demonstrate the functionality and capablilities of <code>alpaca</code>, we replicate parts of <span class="citation">Larch et al. (2019)</span> as an example for the intensive margin and extend it to the extensive margin. Our example is based on the panel data set of 2,973,168 bilateral trade flows used by <span class="citation">Glick and Rose (2016)</span>. For our estimations we specify a three-way error component with 56,608 levels.</p>
</div>
<div id="data-preparation" class="section level2">
<h2>Data preparation</h2>
<p>The data set is available either from <a href="http://faculty.haas.berkeley.edu/arose/RecRes.htm">Andrew Rose’s website</a> or from <a href="https://www.sciencedirect.com/science/article/pii/S0014292116300630#ec0005">sciencedirect</a>. We use the same variable names as <span class="citation">Glick and Rose (2016)</span> such that we are able to compare our summary statistics with the ones provided in their <em>Stata</em> log-files.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="co"># Import the data set</span></a>
<a class="sourceLine" id="cb1-2" title="2"><span class="kw">library</span>(haven)</a>
<a class="sourceLine" id="cb1-3" title="3"><span class="kw">library</span>(data.table)</a>
<a class="sourceLine" id="cb1-4" title="4">cudata &lt;-<span class="st"> </span><span class="kw">read_dta</span>(<span class="st">&quot;dataaxj1.dta&quot;</span>)</a>
<a class="sourceLine" id="cb1-5" title="5"><span class="kw">setDT</span>(cudata)</a>
<a class="sourceLine" id="cb1-6" title="6"></a>
<a class="sourceLine" id="cb1-7" title="7"><span class="co"># Subsetting relevant variables</span></a>
<a class="sourceLine" id="cb1-8" title="8">var.nms &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;exp1to2&quot;</span>, <span class="st">&quot;custrict11&quot;</span>, <span class="st">&quot;ldist&quot;</span>, <span class="st">&quot;comlang&quot;</span>, <span class="st">&quot;border&quot;</span>, <span class="st">&quot;regional&quot;</span>,</a>
<a class="sourceLine" id="cb1-9" title="9">             <span class="st">&quot;comcol&quot;</span>, <span class="st">&quot;curcol&quot;</span>, <span class="st">&quot;colony&quot;</span>, <span class="st">&quot;comctry&quot;</span>, <span class="st">&quot;cuwoemu&quot;</span>, <span class="st">&quot;emu&quot;</span>, <span class="st">&quot;cuc&quot;</span>,</a>
<a class="sourceLine" id="cb1-10" title="10">             <span class="st">&quot;cty1&quot;</span>, <span class="st">&quot;cty2&quot;</span>, <span class="st">&quot;year&quot;</span>, <span class="st">&quot;pairid&quot;</span>)</a>
<a class="sourceLine" id="cb1-11" title="11">cudata &lt;-<span class="st"> </span>cudata[, ..var.nms]</a>
<a class="sourceLine" id="cb1-12" title="12"></a>
<a class="sourceLine" id="cb1-13" title="13"><span class="co"># Generate identifiers required for structural gravity</span></a>
<a class="sourceLine" id="cb1-14" title="14">cudata[, pairid <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">factor</span>(pairid)]</a>
<a class="sourceLine" id="cb1-15" title="15">cudata[, exp.time <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">interaction</span>(cty1, year)]</a>
<a class="sourceLine" id="cb1-16" title="16">cudata[, imp.time <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">interaction</span>(cty2, year)]</a>
<a class="sourceLine" id="cb1-17" title="17"></a>
<a class="sourceLine" id="cb1-18" title="18"><span class="co"># Generate dummies for disaggregated currency unions</span></a>
<a class="sourceLine" id="cb1-19" title="19">cudata[, cuau <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">as.integer</span>(cuc <span class="op">==</span><span class="st"> &quot;au&quot;</span>)]</a>
<a class="sourceLine" id="cb1-20" title="20">cudata[, cube <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">as.integer</span>(cuc <span class="op">==</span><span class="st"> &quot;be&quot;</span>)]</a>
<a class="sourceLine" id="cb1-21" title="21">cudata[, cuca <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">as.integer</span>(cuc <span class="op">==</span><span class="st"> &quot;ca&quot;</span>)]</a>
<a class="sourceLine" id="cb1-22" title="22">cudata[, cucf <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">as.integer</span>(cuc <span class="op">==</span><span class="st"> &quot;cf&quot;</span>)]</a>
<a class="sourceLine" id="cb1-23" title="23">cudata[, cucp <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">as.integer</span>(cuc <span class="op">==</span><span class="st"> &quot;cp&quot;</span>)]</a>
<a class="sourceLine" id="cb1-24" title="24">cudata[, cudk <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">as.integer</span>(cuc <span class="op">==</span><span class="st"> &quot;dk&quot;</span>)]</a>
<a class="sourceLine" id="cb1-25" title="25">cudata[, cuea <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">as.integer</span>(cuc <span class="op">==</span><span class="st"> &quot;ea&quot;</span>)]</a>
<a class="sourceLine" id="cb1-26" title="26">cudata[, cuec <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">as.integer</span>(cuc <span class="op">==</span><span class="st"> &quot;ec&quot;</span>)]</a>
<a class="sourceLine" id="cb1-27" title="27">cudata[, cuem <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">as.integer</span>(cuc <span class="op">==</span><span class="st"> &quot;em&quot;</span>)]</a>
<a class="sourceLine" id="cb1-28" title="28">cudata[, cufr <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">as.integer</span>(cuc <span class="op">==</span><span class="st"> &quot;fr&quot;</span>)]</a>
<a class="sourceLine" id="cb1-29" title="29">cudata[, cugb <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">as.integer</span>(cuc <span class="op">==</span><span class="st"> &quot;gb&quot;</span>)]</a>
<a class="sourceLine" id="cb1-30" title="30">cudata[, cuin <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">as.integer</span>(cuc <span class="op">==</span><span class="st"> &quot;in&quot;</span>)]</a>
<a class="sourceLine" id="cb1-31" title="31">cudata[, cuma <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">as.integer</span>(cuc <span class="op">==</span><span class="st"> &quot;ma&quot;</span>)]</a>
<a class="sourceLine" id="cb1-32" title="32">cudata[, cuml <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">as.integer</span>(cuc <span class="op">==</span><span class="st"> &quot;ml&quot;</span>)]</a>
<a class="sourceLine" id="cb1-33" title="33">cudata[, cunc <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">as.integer</span>(cuc <span class="op">==</span><span class="st"> &quot;nc&quot;</span>)]</a>
<a class="sourceLine" id="cb1-34" title="34">cudata[, cunz <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">as.integer</span>(cuc <span class="op">==</span><span class="st"> &quot;nz&quot;</span>)]</a>
<a class="sourceLine" id="cb1-35" title="35">cudata[, cupk <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">as.integer</span>(cuc <span class="op">==</span><span class="st"> &quot;pk&quot;</span>)]</a>
<a class="sourceLine" id="cb1-36" title="36">cudata[, cupt <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">as.integer</span>(cuc <span class="op">==</span><span class="st"> &quot;pt&quot;</span>)]</a>
<a class="sourceLine" id="cb1-37" title="37">cudata[, cusa <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">as.integer</span>(cuc <span class="op">==</span><span class="st"> &quot;sa&quot;</span>)]</a>
<a class="sourceLine" id="cb1-38" title="38">cudata[, cusp <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">as.integer</span>(cuc <span class="op">==</span><span class="st"> &quot;sp&quot;</span>)]</a>
<a class="sourceLine" id="cb1-39" title="39">cudata[, cuua <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">as.integer</span>(cuc <span class="op">==</span><span class="st"> &quot;ua&quot;</span>)]</a>
<a class="sourceLine" id="cb1-40" title="40">cudata[, cuus <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">as.integer</span>(cuc <span class="op">==</span><span class="st"> &quot;us&quot;</span>)]</a>
<a class="sourceLine" id="cb1-41" title="41">cudata[, cuwa <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">as.integer</span>(cuc <span class="op">==</span><span class="st"> &quot;wa&quot;</span>)]</a>
<a class="sourceLine" id="cb1-42" title="42">cudata[, cuwoo <span class="op">:</span><span class="er">=</span><span class="st"> </span>custrict11]</a>
<a class="sourceLine" id="cb1-43" title="43">cudata[cuc <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;em&quot;</span>, <span class="st">&quot;au&quot;</span>, <span class="st">&quot;cf&quot;</span>, <span class="st">&quot;ec&quot;</span>, <span class="st">&quot;fr&quot;</span>, <span class="st">&quot;gb&quot;</span>, <span class="st">&quot;in&quot;</span>, <span class="st">&quot;us&quot;</span>), cuwoo <span class="op">:</span><span class="er">=</span><span class="st"> </span>0L]</a>
<a class="sourceLine" id="cb1-44" title="44"></a>
<a class="sourceLine" id="cb1-45" title="45"><span class="co"># Set missing trade flows to zero</span></a>
<a class="sourceLine" id="cb1-46" title="46">cudata[<span class="kw">is.na</span>(exp1to2), exp1to2 <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="fl">0.0</span>]</a>
<a class="sourceLine" id="cb1-47" title="47"></a>
<a class="sourceLine" id="cb1-48" title="48"><span class="co"># Construct binary and lagged dependent variable for the extensive margin</span></a>
<a class="sourceLine" id="cb1-49" title="49">cudata[, trade <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">as.integer</span>(exp1to2 <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.0</span>)]</a>
<a class="sourceLine" id="cb1-50" title="50">cudata[, ltrade <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">shift</span>(trade), by =<span class="st"> </span>pairid]</a></code></pre></div>
</div>
<div id="estimating-the-intensive-margin-of-trade" class="section level2">
<h2>Estimating the intensive margin of trade</h2>
<p>After preparing the data, we show how to replicate column 3 of table 2 in <span class="citation">Larch et al. (2019)</span>. In addition to coefficients and robust standard errors, the authors also report standard errors clustered by exporter, importer, and time.</p>
<p>If we want <code>feglm()</code> to report standard errors that are clustered by variables, which are not already part of the model itself, we have to additionally provide them using the third part of the <code>formula</code> interface. In this example, we have to additionally add identifiers for exporters (<code>cty1</code>), importers (<code>cty2</code>), and time (<code>year</code>).</p>
<p>First we report robust standard errors indicated by the option <code>&quot;sandwich&quot;</code> in <code>summary()</code>.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1">mod &lt;-<span class="st"> </span><span class="kw">feglm</span>(exp1to2 <span class="op">~</span><span class="st"> </span>emu <span class="op">+</span><span class="st"> </span>cuwoo <span class="op">+</span><span class="st"> </span>cuau <span class="op">+</span><span class="st"> </span>cucf <span class="op">+</span><span class="st"> </span>cuec <span class="op">+</span><span class="st"> </span>cufr <span class="op">+</span><span class="st"> </span>cugb <span class="op">+</span><span class="st"> </span>cuin <span class="op">+</span><span class="st"> </span>cuus <span class="op">+</span></a>
<a class="sourceLine" id="cb2-2" title="2"><span class="st">               </span>regional <span class="op">+</span><span class="st"> </span>curcol <span class="op">|</span><span class="st"> </span>exp.time <span class="op">+</span><span class="st"> </span>imp.time <span class="op">+</span><span class="st"> </span>pairid <span class="op">|</span><span class="st"> </span>cty1 <span class="op">+</span><span class="st"> </span>cty2 <span class="op">+</span><span class="st"> </span>year, cudata,</a>
<a class="sourceLine" id="cb2-3" title="3">             <span class="dt">family =</span> <span class="kw">poisson</span>())</a>
<a class="sourceLine" id="cb2-4" title="4"><span class="kw">summary</span>(mod, <span class="st">&quot;sandwich&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="co">## poisson - log link</span></a>
<a class="sourceLine" id="cb3-2" title="2"><span class="co">## </span></a>
<a class="sourceLine" id="cb3-3" title="3"><span class="co">## exp1to2 ~ emu + cuwoo + cuau + cucf + cuec + cufr + cugb + cuin + </span></a>
<a class="sourceLine" id="cb3-4" title="4"><span class="co">##     cuus + regional + curcol | exp.time + imp.time + pairid | </span></a>
<a class="sourceLine" id="cb3-5" title="5"><span class="co">##     cty1 + cty2 + year</span></a>
<a class="sourceLine" id="cb3-6" title="6"><span class="co">## </span></a>
<a class="sourceLine" id="cb3-7" title="7"><span class="co">## Estimates:</span></a>
<a class="sourceLine" id="cb3-8" title="8"><span class="co">##           Estimate Std. error z value Pr(&gt; |z|)    </span></a>
<a class="sourceLine" id="cb3-9" title="9"><span class="co">## emu       0.048895   0.010277   4.758  1.96e-06 ***</span></a>
<a class="sourceLine" id="cb3-10" title="10"><span class="co">## cuwoo     0.765988   0.053272  14.379   &lt; 2e-16 ***</span></a>
<a class="sourceLine" id="cb3-11" title="11"><span class="co">## cuau      0.384469   0.118832   3.235   0.00121 ** </span></a>
<a class="sourceLine" id="cb3-12" title="12"><span class="co">## cucf     -0.125608   0.099674  -1.260   0.20760    </span></a>
<a class="sourceLine" id="cb3-13" title="13"><span class="co">## cuec     -0.877318   0.083451 -10.513   &lt; 2e-16 ***</span></a>
<a class="sourceLine" id="cb3-14" title="14"><span class="co">## cufr      2.095726   0.062952  33.291   &lt; 2e-16 ***</span></a>
<a class="sourceLine" id="cb3-15" title="15"><span class="co">## cugb      1.059957   0.034680  30.564   &lt; 2e-16 ***</span></a>
<a class="sourceLine" id="cb3-16" title="16"><span class="co">## cuin      0.169745   0.147029   1.154   0.24830    </span></a>
<a class="sourceLine" id="cb3-17" title="17"><span class="co">## cuus      0.018323   0.021530   0.851   0.39473    </span></a>
<a class="sourceLine" id="cb3-18" title="18"><span class="co">## regional  0.159181   0.008714  18.267   &lt; 2e-16 ***</span></a>
<a class="sourceLine" id="cb3-19" title="19"><span class="co">## curcol    0.386882   0.046827   8.262   &lt; 2e-16 ***</span></a>
<a class="sourceLine" id="cb3-20" title="20"><span class="co">## ---</span></a>
<a class="sourceLine" id="cb3-21" title="21"><span class="co">## Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span></a>
<a class="sourceLine" id="cb3-22" title="22"><span class="co">## </span></a>
<a class="sourceLine" id="cb3-23" title="23"><span class="co">## residual deviance= 35830778.62,</span></a>
<a class="sourceLine" id="cb3-24" title="24"><span class="co">## null deviance= 2245707302.17,</span></a>
<a class="sourceLine" id="cb3-25" title="25"><span class="co">## n= 1610165, l= [11227, 11277, 34104]</span></a>
<a class="sourceLine" id="cb3-26" title="26"><span class="co">## </span></a>
<a class="sourceLine" id="cb3-27" title="27"><span class="co">## ( 1363003 observation(s) deleted due to perfect classification )</span></a>
<a class="sourceLine" id="cb3-28" title="28"><span class="co">## </span></a>
<a class="sourceLine" id="cb3-29" title="29"><span class="co">## Number of Fisher Scoring Iterations: 13 </span></a></code></pre></div>
<p>We observe that roughly 1,4 million observations do not contribute to the identification of the structural parameters and we end up with roughly 1,6 million observations and 57,000 fixed effects.</p>
<p>Replicating the clustered standard errors is straightforward. We simply have to change the option to <code>&quot;clustered&quot;</code> and provide <code>summary</code> with the requested cluster dimensions.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1"><span class="kw">summary</span>(mod, <span class="st">&quot;clustered&quot;</span>, <span class="dt">cluster =</span> <span class="op">~</span><span class="st"> </span>cty1 <span class="op">+</span><span class="st"> </span>cty2 <span class="op">+</span><span class="st"> </span>year)</a></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1"><span class="co">## poisson - log link</span></a>
<a class="sourceLine" id="cb5-2" title="2"><span class="co">## </span></a>
<a class="sourceLine" id="cb5-3" title="3"><span class="co">## exp1to2 ~ emu + cuwoo + cuau + cucf + cuec + cufr + cugb + cuin + </span></a>
<a class="sourceLine" id="cb5-4" title="4"><span class="co">##     cuus + regional + curcol | exp.time + imp.time + pairid | </span></a>
<a class="sourceLine" id="cb5-5" title="5"><span class="co">##     cty1 + cty2 + year</span></a>
<a class="sourceLine" id="cb5-6" title="6"><span class="co">## </span></a>
<a class="sourceLine" id="cb5-7" title="7"><span class="co">## Estimates:</span></a>
<a class="sourceLine" id="cb5-8" title="8"><span class="co">##          Estimate Std. error z value Pr(&gt; |z|)    </span></a>
<a class="sourceLine" id="cb5-9" title="9"><span class="co">## emu       0.04890    0.09455   0.517   0.60507    </span></a>
<a class="sourceLine" id="cb5-10" title="10"><span class="co">## cuwoo     0.76599    0.24933   3.072   0.00213 ** </span></a>
<a class="sourceLine" id="cb5-11" title="11"><span class="co">## cuau      0.38447    0.22355   1.720   0.08546 .  </span></a>
<a class="sourceLine" id="cb5-12" title="12"><span class="co">## cucf     -0.12561    0.35221  -0.357   0.72137    </span></a>
<a class="sourceLine" id="cb5-13" title="13"><span class="co">## cuec     -0.87732    0.29493  -2.975   0.00293 ** </span></a>
<a class="sourceLine" id="cb5-14" title="14"><span class="co">## cufr      2.09573    0.30625   6.843  7.75e-12 ***</span></a>
<a class="sourceLine" id="cb5-15" title="15"><span class="co">## cugb      1.05996    0.23766   4.460  8.19e-06 ***</span></a>
<a class="sourceLine" id="cb5-16" title="16"><span class="co">## cuin      0.16974    0.30090   0.564   0.57267    </span></a>
<a class="sourceLine" id="cb5-17" title="17"><span class="co">## cuus      0.01832    0.05092   0.360   0.71898    </span></a>
<a class="sourceLine" id="cb5-18" title="18"><span class="co">## regional  0.15918    0.07588   2.098   0.03593 *  </span></a>
<a class="sourceLine" id="cb5-19" title="19"><span class="co">## curcol    0.38688    0.15509   2.495   0.01261 *  </span></a>
<a class="sourceLine" id="cb5-20" title="20"><span class="co">## ---</span></a>
<a class="sourceLine" id="cb5-21" title="21"><span class="co">## Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span></a>
<a class="sourceLine" id="cb5-22" title="22"><span class="co">## </span></a>
<a class="sourceLine" id="cb5-23" title="23"><span class="co">## residual deviance= 35830779,</span></a>
<a class="sourceLine" id="cb5-24" title="24"><span class="co">## null deviance= 2245707302,</span></a>
<a class="sourceLine" id="cb5-25" title="25"><span class="co">## n= 1610165, l= [11227, 11277, 34104]</span></a>
<a class="sourceLine" id="cb5-26" title="26"><span class="co">## </span></a>
<a class="sourceLine" id="cb5-27" title="27"><span class="co">## ( 1363003 observation(s) deleted due to perfect classification )</span></a>
<a class="sourceLine" id="cb5-28" title="28"><span class="co">## </span></a>
<a class="sourceLine" id="cb5-29" title="29"><span class="co">## Number of Fisher Scoring Iterations: 13</span></a></code></pre></div>
</div>
<div id="testing-linear-restrictions" class="section level2">
<h2>Testing linear restrictions</h2>
<p>Our package is also compatible with <code>linearHypothesis()</code> of the <code>car</code> package. In the next example we show how to test if all currency union effects except being in the EMU are jointly different from zero using a Wald test based on a clustered covariance matrix.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1"><span class="kw">library</span>(car)</a>
<a class="sourceLine" id="cb6-2" title="2">cus &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;cuwoo&quot;</span>, <span class="st">&quot;cuau&quot;</span>, <span class="st">&quot;cucf&quot;</span>, <span class="st">&quot;cuec&quot;</span>, <span class="st">&quot;cufr&quot;</span>, <span class="st">&quot;cugb&quot;</span>, <span class="st">&quot;cuin&quot;</span>, <span class="st">&quot;cuus&quot;</span>)</a>
<a class="sourceLine" id="cb6-3" title="3"><span class="kw">linearHypothesis</span>(mod, cus, <span class="dt">vcov. =</span> <span class="kw">vcov</span>(mod, <span class="st">&quot;clustered&quot;</span>, <span class="dt">cluster =</span> <span class="op">~</span><span class="st"> </span>cty1 <span class="op">+</span><span class="st"> </span>cty2 <span class="op">+</span><span class="st"> </span>year))</a></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1"><span class="co">## Linear hypothesis test</span></a>
<a class="sourceLine" id="cb7-2" title="2"><span class="co">## </span></a>
<a class="sourceLine" id="cb7-3" title="3"><span class="co">## Hypothesis:</span></a>
<a class="sourceLine" id="cb7-4" title="4"><span class="co">## cuwoo = 0</span></a>
<a class="sourceLine" id="cb7-5" title="5"><span class="co">## cuau = 0</span></a>
<a class="sourceLine" id="cb7-6" title="6"><span class="co">## cucf = 0</span></a>
<a class="sourceLine" id="cb7-7" title="7"><span class="co">## cuec = 0</span></a>
<a class="sourceLine" id="cb7-8" title="8"><span class="co">## cufr = 0</span></a>
<a class="sourceLine" id="cb7-9" title="9"><span class="co">## cugb = 0</span></a>
<a class="sourceLine" id="cb7-10" title="10"><span class="co">## cuin = 0</span></a>
<a class="sourceLine" id="cb7-11" title="11"><span class="co">## cuus = 0</span></a>
<a class="sourceLine" id="cb7-12" title="12"><span class="co">## </span></a>
<a class="sourceLine" id="cb7-13" title="13"><span class="co">## Model 1: restricted model</span></a>
<a class="sourceLine" id="cb7-14" title="14"><span class="co">## Model 2: exp1to2 ~ emu + cuwoo + cuau + cucf + cuec + cufr + cugb + cuin + </span></a>
<a class="sourceLine" id="cb7-15" title="15"><span class="co">##     cuus + regional + curcol | exp.time + imp.time + pairid | </span></a>
<a class="sourceLine" id="cb7-16" title="16"><span class="co">##     cty1 + cty2 + year</span></a>
<a class="sourceLine" id="cb7-17" title="17"><span class="co">## </span></a>
<a class="sourceLine" id="cb7-18" title="18"><span class="co">## Note: Coefficient covariance matrix supplied.</span></a>
<a class="sourceLine" id="cb7-19" title="19"><span class="co">## </span></a>
<a class="sourceLine" id="cb7-20" title="20"><span class="co">##   Df  Chisq Pr(&gt;Chisq)    </span></a>
<a class="sourceLine" id="cb7-21" title="21"><span class="co">## 1                         </span></a>
<a class="sourceLine" id="cb7-22" title="22"><span class="co">## 2  8 96.771  &lt; 2.2e-16 ***</span></a>
<a class="sourceLine" id="cb7-23" title="23"><span class="co">## ---</span></a>
<a class="sourceLine" id="cb7-24" title="24"><span class="co">## Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span></a></code></pre></div>
</div>
<div id="estimating-the-extensive-margin-of-trade" class="section level2">
<h2>Estimating the extensive margin of trade</h2>
<p>Now we turn to the estimation of the extensive margin. First we estimate a static probit model.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1">mods &lt;-<span class="st"> </span><span class="kw">feglm</span>(trade <span class="op">~</span><span class="st"> </span>emu <span class="op">+</span><span class="st"> </span>cuwoo <span class="op">+</span><span class="st"> </span>cuau <span class="op">+</span><span class="st"> </span>cucf <span class="op">+</span><span class="st"> </span>cuec <span class="op">+</span><span class="st"> </span>cufr <span class="op">+</span><span class="st"> </span>cugb <span class="op">+</span><span class="st"> </span>cuin <span class="op">+</span><span class="st"> </span>cuus <span class="op">+</span></a>
<a class="sourceLine" id="cb8-2" title="2"><span class="st">                </span>regional <span class="op">+</span><span class="st"> </span>curcol <span class="op">|</span><span class="st"> </span>exp.time <span class="op">+</span><span class="st"> </span>imp.time <span class="op">+</span><span class="st"> </span>pairid, cudata,</a>
<a class="sourceLine" id="cb8-3" title="3">              <span class="dt">family =</span> <span class="kw">binomial</span>(<span class="st">&quot;probit&quot;</span>))</a>
<a class="sourceLine" id="cb8-4" title="4"><span class="kw">summary</span>(mods)</a></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1"><span class="co">## binomial - probit link</span></a>
<a class="sourceLine" id="cb9-2" title="2"><span class="co">## </span></a>
<a class="sourceLine" id="cb9-3" title="3"><span class="co">## trade ~ emu + cuwoo + cuau + cucf + cuec + cufr + cugb + cuin + </span></a>
<a class="sourceLine" id="cb9-4" title="4"><span class="co">##     cuus + regional + curcol | exp.time + imp.time + pairid</span></a>
<a class="sourceLine" id="cb9-5" title="5"><span class="co">## </span></a>
<a class="sourceLine" id="cb9-6" title="6"><span class="co">## Estimates:</span></a>
<a class="sourceLine" id="cb9-7" title="7"><span class="co">##          Estimate Std. error z value Pr(&gt; |z|)    </span></a>
<a class="sourceLine" id="cb9-8" title="8"><span class="co">## emu       0.28257    0.12830   2.202  0.027633 *  </span></a>
<a class="sourceLine" id="cb9-9" title="9"><span class="co">## cuwoo     0.56822    0.07686   7.393  1.44e-13 ***</span></a>
<a class="sourceLine" id="cb9-10" title="10"><span class="co">## cuau      1.10887    0.28988   3.825  0.000131 ***</span></a>
<a class="sourceLine" id="cb9-11" title="11"><span class="co">## cucf      0.13957    0.05263   2.652  0.008001 ** </span></a>
<a class="sourceLine" id="cb9-12" title="12"><span class="co">## cuec      0.05410    0.61908   0.087  0.930358    </span></a>
<a class="sourceLine" id="cb9-13" title="13"><span class="co">## cufr      2.30667    0.24342   9.476   &lt; 2e-16 ***</span></a>
<a class="sourceLine" id="cb9-14" title="14"><span class="co">## cugb      0.18393    0.04272   4.305  1.67e-05 ***</span></a>
<a class="sourceLine" id="cb9-15" title="15"><span class="co">## cuin      0.25151    0.15735   1.598  0.109947    </span></a>
<a class="sourceLine" id="cb9-16" title="16"><span class="co">## cuus     -0.36144    0.07948  -4.547  5.43e-06 ***</span></a>
<a class="sourceLine" id="cb9-17" title="17"><span class="co">## regional  0.06285    0.01787   3.518  0.000435 ***</span></a>
<a class="sourceLine" id="cb9-18" title="18"><span class="co">## curcol   -0.89259    0.23332  -3.826  0.000130 ***</span></a>
<a class="sourceLine" id="cb9-19" title="19"><span class="co">## ---</span></a>
<a class="sourceLine" id="cb9-20" title="20"><span class="co">## Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span></a>
<a class="sourceLine" id="cb9-21" title="21"><span class="co">## </span></a>
<a class="sourceLine" id="cb9-22" title="22"><span class="co">## residual deviance= 681267.38,</span></a>
<a class="sourceLine" id="cb9-23" title="23"><span class="co">## null deviance= 1947737.97,</span></a>
<a class="sourceLine" id="cb9-24" title="24"><span class="co">## n= 1406505, l= [11227, 11273, 29630]</span></a>
<a class="sourceLine" id="cb9-25" title="25"><span class="co">## </span></a>
<a class="sourceLine" id="cb9-26" title="26"><span class="co">## ( 1566663 observation(s) deleted due to perfect classification )</span></a>
<a class="sourceLine" id="cb9-27" title="27"><span class="co">## </span></a>
<a class="sourceLine" id="cb9-28" title="28"><span class="co">## Number of Fisher Scoring Iterations: 7</span></a></code></pre></div>
<p>To mitigate the incidental parameters problem (see <span class="citation">Neyman and Scott (1948)</span>) we apply the bias correction suggested by <span class="citation">Hinz, Stammann, and Wanner (2019)</span>. Note that the argument <code>panel.structure = &quot;network&quot;</code> is necessary to apply the appropriate bias correction.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1">modsbc &lt;-<span class="st"> </span><span class="kw">biasCorr</span>(mods, <span class="dt">panel.structure =</span> <span class="st">&quot;network&quot;</span>)</a>
<a class="sourceLine" id="cb10-2" title="2"><span class="kw">summary</span>(modsbc)</a></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1"><span class="co">## binomial - probit link</span></a>
<a class="sourceLine" id="cb11-2" title="2"><span class="co">## </span></a>
<a class="sourceLine" id="cb11-3" title="3"><span class="co">## trade ~ emu + cuwoo + cuau + cucf + cuec + cufr + cugb + cuin + </span></a>
<a class="sourceLine" id="cb11-4" title="4"><span class="co">##     cuus + regional + curcol | exp.time + imp.time + pairid</span></a>
<a class="sourceLine" id="cb11-5" title="5"><span class="co">## </span></a>
<a class="sourceLine" id="cb11-6" title="6"><span class="co">## Estimates:</span></a>
<a class="sourceLine" id="cb11-7" title="7"><span class="co">##          Estimate Std. error z value Pr(&gt; |z|)    </span></a>
<a class="sourceLine" id="cb11-8" title="8"><span class="co">## emu       0.26909    0.12830   2.097  0.035957 *  </span></a>
<a class="sourceLine" id="cb11-9" title="9"><span class="co">## cuwoo     0.50380    0.07686   6.555  5.58e-11 ***</span></a>
<a class="sourceLine" id="cb11-10" title="10"><span class="co">## cuau      0.99443    0.28988   3.430  0.000603 ***</span></a>
<a class="sourceLine" id="cb11-11" title="11"><span class="co">## cucf      0.12965    0.05263   2.463  0.013763 *  </span></a>
<a class="sourceLine" id="cb11-12" title="12"><span class="co">## cuec      0.01616    0.61908   0.026  0.979177    </span></a>
<a class="sourceLine" id="cb11-13" title="13"><span class="co">## cufr      2.08515    0.24342   8.566   &lt; 2e-16 ***</span></a>
<a class="sourceLine" id="cb11-14" title="14"><span class="co">## cugb      0.16730    0.04272   3.916  9.00e-05 ***</span></a>
<a class="sourceLine" id="cb11-15" title="15"><span class="co">## cuin      0.21050    0.15735   1.338  0.180960    </span></a>
<a class="sourceLine" id="cb11-16" title="16"><span class="co">## cuus     -0.33648    0.07948  -4.233  2.30e-05 ***</span></a>
<a class="sourceLine" id="cb11-17" title="17"><span class="co">## regional  0.06350    0.01787   3.554  0.000379 ***</span></a>
<a class="sourceLine" id="cb11-18" title="18"><span class="co">## curcol   -0.72566    0.23332  -3.110  0.001870 ** </span></a>
<a class="sourceLine" id="cb11-19" title="19"><span class="co">## ---</span></a>
<a class="sourceLine" id="cb11-20" title="20"><span class="co">## Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span></a>
<a class="sourceLine" id="cb11-21" title="21"><span class="co">## </span></a>
<a class="sourceLine" id="cb11-22" title="22"><span class="co">## residual deviance= 681267.38,</span></a>
<a class="sourceLine" id="cb11-23" title="23"><span class="co">## null deviance= 1947737.97,</span></a>
<a class="sourceLine" id="cb11-24" title="24"><span class="co">## n= 1406505, l= [11227, 11273, 29630]</span></a>
<a class="sourceLine" id="cb11-25" title="25"><span class="co">## </span></a>
<a class="sourceLine" id="cb11-26" title="26"><span class="co">## ( 1566663 observation(s) deleted due to perfect classification )</span></a>
<a class="sourceLine" id="cb11-27" title="27"><span class="co">## </span></a>
<a class="sourceLine" id="cb11-28" title="28"><span class="co">## Number of Fisher Scoring Iterations: 7 </span></a></code></pre></div>
<p>Because coefficients itself are not very meaningful, econometricians are usually interested in so called partial effects (also known as marginal or ceteris paribus effects). A commonly used statistic is the average partial effect. <code>alpaca</code> offers a post-estimation routine to estimate average partial effects and their corresponding standard errors. In the following the bias-corrected average partial effects are computed.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1">apesbc &lt;-<span class="st"> </span><span class="kw">getAPEs</span>(modsbc, <span class="dt">n.pop =</span> <span class="kw">nrow</span>(cudata))</a>
<a class="sourceLine" id="cb12-2" title="2"><span class="kw">summary</span>(apesbc)</a></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1"><span class="co">## Estimates:</span></a>
<a class="sourceLine" id="cb13-2" title="2"><span class="co">##           Estimate Std. error z value Pr(&gt; |z|)    </span></a>
<a class="sourceLine" id="cb13-3" title="3"><span class="co">## emu       0.020386   0.018029   1.131  0.258178    </span></a>
<a class="sourceLine" id="cb13-4" title="4"><span class="co">## cuwoo     0.038504   0.012516   3.076  0.002095 ** </span></a>
<a class="sourceLine" id="cb13-5" title="5"><span class="co">## cuau      0.076624   0.031081   2.465  0.013688 *  </span></a>
<a class="sourceLine" id="cb13-6" title="6"><span class="co">## cucf      0.009758   0.008048   1.212  0.225349    </span></a>
<a class="sourceLine" id="cb13-7" title="7"><span class="co">## cuec      0.001209   0.080143   0.015  0.987966    </span></a>
<a class="sourceLine" id="cb13-8" title="8"><span class="co">## cufr      0.179129   0.050085   3.576  0.000348 ***</span></a>
<a class="sourceLine" id="cb13-9" title="9"><span class="co">## cugb      0.012612   0.006424   1.963  0.049600 *  </span></a>
<a class="sourceLine" id="cb13-10" title="10"><span class="co">## cuin      0.015905   0.023544   0.676  0.499333    </span></a>
<a class="sourceLine" id="cb13-11" title="11"><span class="co">## cuus     -0.024633   0.011286  -2.183  0.029067 *  </span></a>
<a class="sourceLine" id="cb13-12" title="12"><span class="co">## regional  0.004765   0.002633   1.810  0.070334 .  </span></a>
<a class="sourceLine" id="cb13-13" title="13"><span class="co">## curcol   -0.051613   0.037436  -1.379  0.167982    </span></a>
<a class="sourceLine" id="cb13-14" title="14"><span class="co">## ---</span></a>
<a class="sourceLine" id="cb13-15" title="15"><span class="co">## Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span></a></code></pre></div>
<p><span class="citation">Hinz, Stammann, and Wanner (2019)</span> propose to estimate the extensive margin using a dynamic specification, where the lagged dependent variable is added to the explanatory variables. Again, a bias correction is necessary. Contrary to the one for static models, we need to additionally provide a bandwidth parameter (<code>L</code>) that is required for the estimation of spectral densities (see <span class="citation">Hahn and Kuersteiner (2011)</span>). <span class="citation">Fernández-Val and Weidner (2016)</span> suggest to do a sensitivity analysis and try different values for <code>L</code> but not larger than four. Note that in this case the order of factors to be concentrated out, specified in the second part of the formula, is important (importer-/exporter-time identifiers first and pair identifier last).</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1">modd &lt;-<span class="st"> </span><span class="kw">feglm</span>(trade <span class="op">~</span><span class="st"> </span>ltrade <span class="op">+</span><span class="st"> </span>emu <span class="op">+</span><span class="st"> </span>cuwoo <span class="op">+</span><span class="st"> </span>cuau <span class="op">+</span><span class="st"> </span>cucf <span class="op">+</span><span class="st"> </span>cuec <span class="op">+</span><span class="st"> </span>cufr <span class="op">+</span><span class="st"> </span>cugb <span class="op">+</span><span class="st"> </span>cuin <span class="op">+</span><span class="st"> </span>cuus <span class="op">+</span></a>
<a class="sourceLine" id="cb14-2" title="2"><span class="st">                </span>regional <span class="op">+</span><span class="st"> </span>curcol <span class="op">|</span><span class="st"> </span>exp.time <span class="op">+</span><span class="st"> </span>imp.time <span class="op">+</span><span class="st"> </span>pairid, cudata,</a>
<a class="sourceLine" id="cb14-3" title="3">              <span class="dt">family =</span> <span class="kw">binomial</span>(<span class="st">&quot;probit&quot;</span>))</a>
<a class="sourceLine" id="cb14-4" title="4">moddbc &lt;-<span class="st"> </span><span class="kw">biasCorr</span>(modd, <span class="dt">L =</span> 2L, <span class="dt">panel.structure =</span> <span class="st">&quot;network&quot;</span>)</a>
<a class="sourceLine" id="cb14-5" title="5"><span class="kw">summary</span>(moddbc)</a></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1"><span class="co">## binomial - probit link</span></a>
<a class="sourceLine" id="cb15-2" title="2"><span class="co">## </span></a>
<a class="sourceLine" id="cb15-3" title="3"><span class="co">## trade ~ ltrade + emu + cuwoo + cuau + cucf + cuec + cufr + cugb + </span></a>
<a class="sourceLine" id="cb15-4" title="4"><span class="co">##     cuin + cuus + regional + curcol | exp.time + imp.time + pairid</span></a>
<a class="sourceLine" id="cb15-5" title="5"><span class="co">## </span></a>
<a class="sourceLine" id="cb15-6" title="6"><span class="co">## Estimates:</span></a>
<a class="sourceLine" id="cb15-7" title="7"><span class="co">##          Estimate Std. error z value Pr(&gt; |z|)    </span></a>
<a class="sourceLine" id="cb15-8" title="8"><span class="co">## ltrade    1.24341    0.00443 280.702   &lt; 2e-16 ***</span></a>
<a class="sourceLine" id="cb15-9" title="9"><span class="co">## emu       0.18274    0.13543   1.349   0.17724    </span></a>
<a class="sourceLine" id="cb15-10" title="10"><span class="co">## cuwoo     0.41965    0.08064   5.204  1.95e-07 ***</span></a>
<a class="sourceLine" id="cb15-11" title="11"><span class="co">## cuau      0.79096    0.30410   2.601   0.00930 ** </span></a>
<a class="sourceLine" id="cb15-12" title="12"><span class="co">## cucf      0.10147    0.05446   1.863   0.06244 .  </span></a>
<a class="sourceLine" id="cb15-13" title="13"><span class="co">## cuec      0.17175    0.68499   0.251   0.80202    </span></a>
<a class="sourceLine" id="cb15-14" title="14"><span class="co">## cufr      1.46319    0.24244   6.035  1.59e-09 ***</span></a>
<a class="sourceLine" id="cb15-15" title="15"><span class="co">## cugb      0.10097    0.04451   2.268   0.02331 *  </span></a>
<a class="sourceLine" id="cb15-16" title="16"><span class="co">## cuin      0.17055    0.16394   1.040   0.29819    </span></a>
<a class="sourceLine" id="cb15-17" title="17"><span class="co">## cuus     -0.25668    0.08215  -3.124   0.00178 ** </span></a>
<a class="sourceLine" id="cb15-18" title="18"><span class="co">## regional  0.04656    0.01867   2.494   0.01262 *  </span></a>
<a class="sourceLine" id="cb15-19" title="19"><span class="co">## curcol   -0.44021    0.25167  -1.749   0.08026 .  </span></a>
<a class="sourceLine" id="cb15-20" title="20"><span class="co">## ---</span></a>
<a class="sourceLine" id="cb15-21" title="21"><span class="co">## Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span></a>
<a class="sourceLine" id="cb15-22" title="22"><span class="co">## </span></a>
<a class="sourceLine" id="cb15-23" title="23"><span class="co">## residual deviance= 603826.72,</span></a>
<a class="sourceLine" id="cb15-24" title="24"><span class="co">## null deviance= 1930471.73,</span></a>
<a class="sourceLine" id="cb15-25" title="25"><span class="co">## n= 1394201, l= [11133, 11178, 29538]</span></a>
<a class="sourceLine" id="cb15-26" title="26"><span class="co">## </span></a>
<a class="sourceLine" id="cb15-27" title="27"><span class="co">## ( 45048 observation(s) deleted due to missingness )</span></a>
<a class="sourceLine" id="cb15-28" title="28"><span class="co">## ( 1533919 observation(s) deleted due to perfect classification )</span></a>
<a class="sourceLine" id="cb15-29" title="29"><span class="co">## </span></a>
<a class="sourceLine" id="cb15-30" title="30"><span class="co">## Number of Fisher Scoring Iterations: 13 </span></a></code></pre></div>
<p>Again we compute bias-corrected average partial effects to get interpretable quantities.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1">apedbc &lt;-<span class="st"> </span><span class="kw">getAPEs</span>(moddbc, <span class="dt">n.pop =</span> <span class="kw">nrow</span>(cudata[<span class="op">!</span><span class="kw">is.na</span>(ltrade)]))</a>
<a class="sourceLine" id="cb16-2" title="2"><span class="kw">summary</span>(apedbc)</a></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1"><span class="co">## Estimates:</span></a>
<a class="sourceLine" id="cb17-2" title="2"><span class="co">##           Estimate Std. error z value Pr(&gt; |z|)    </span></a>
<a class="sourceLine" id="cb17-3" title="3"><span class="co">## ltrade    0.128362   0.000981 130.849   &lt; 2e-16 ***</span></a>
<a class="sourceLine" id="cb17-4" title="4"><span class="co">## emu       0.012547   0.016227   0.773   0.43942    </span></a>
<a class="sourceLine" id="cb17-5" title="5"><span class="co">## cuwoo     0.029436   0.010014   2.940   0.00329 ** </span></a>
<a class="sourceLine" id="cb17-6" title="6"><span class="co">## cuau      0.057520   0.031869   1.805   0.07109 .  </span></a>
<a class="sourceLine" id="cb17-7" title="7"><span class="co">## cucf      0.006920   0.006713   1.031   0.30261    </span></a>
<a class="sourceLine" id="cb17-8" title="8"><span class="co">## cuec      0.011782   0.077696   0.152   0.87947    </span></a>
<a class="sourceLine" id="cb17-9" title="9"><span class="co">## cufr      0.112661   0.051794   2.175   0.02962 *  </span></a>
<a class="sourceLine" id="cb17-10" title="10"><span class="co">## cugb      0.006885   0.005096   1.351   0.17666    </span></a>
<a class="sourceLine" id="cb17-11" title="11"><span class="co">## cuin      0.011697   0.019782   0.591   0.55430    </span></a>
<a class="sourceLine" id="cb17-12" title="12"><span class="co">## cuus     -0.017074   0.009183  -1.859   0.06298 .  </span></a>
<a class="sourceLine" id="cb17-13" title="13"><span class="co">## regional  0.003162   0.002185   1.447   0.14793    </span></a>
<a class="sourceLine" id="cb17-14" title="14"><span class="co">## curcol   -0.029015   0.032597  -0.890   0.37342    </span></a>
<a class="sourceLine" id="cb17-15" title="15"><span class="co">## ---</span></a>
<a class="sourceLine" id="cb17-16" title="16"><span class="co">## Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span></a></code></pre></div>
</div>
<div id="references" class="section level2 unnumbered">
<h2>References</h2>
<div id="refs" class="references">
<div id="ref-fw16">
<p>Fernández-Val, Iván, and Martin Weidner. 2016. “Individual and Time Effects in Nonlinear Panel Models with Large N, T.” <em>Journal of Econometrics</em> 192 (1): 291–312.</p>
</div>
<div id="ref-gr16">
<p>Glick, Reuven, and Andrew K. Rose. 2016. “Currency Unions and Trade: A Post-Emu Reassessment.” <em>European Economic Review</em> 87: 78–91.</p>
</div>
<div id="ref-hk11">
<p>Hahn, Jinyong, and Guido Kuersteiner. 2011. “Bias Reduction for Dynamic Nonlinear Panel Models with Fixed Effects.” <em>Econometric Theory</em> 27 (6): 1152–91.</p>
</div>
<div id="ref-hsw19">
<p>Hinz, Julian, Amrei Stammann, and Joschka Wanner. 2019. “Persistent Zeros: The Extensive Margin of Trade.” <em>Working Paper</em>.</p>
</div>
<div id="ref-lwyz19">
<p>Larch, Mario, Joschka Wanner, Yoto V. Yotov, and Thomas Zylkin. 2019. “Currency Unions and Trade: A Ppml Re-Assessment with High-Dimensional Fixed Effects.” <em>Oxford Bulletin of Economics and Statistics</em> 81 (3): 487–510.</p>
</div>
<div id="ref-ns48">
<p>Neyman, Jerzy, and Elizabeth L. Scott. 1948. “Consistent Estimates Based on Partially Consistent Observations.” <em>Econometrica</em> 16 (1): 1–32.</p>
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
