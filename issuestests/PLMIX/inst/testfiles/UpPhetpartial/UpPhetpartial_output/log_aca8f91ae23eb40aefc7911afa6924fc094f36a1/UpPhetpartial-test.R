testlist <- list(n_rank = c(382061684L, -656299549L, -37205850L, -975720720L,  -1281419032L, -458013190L, -1753155340L, 399372590L, -1833065878L,  -1639166564L, 345391833L, 1844496672L, -1881077645L, -1806865108L,  -832167707L, 856757189L, -810143891L, 41748758L, 323809152L,  1018732748L, -1716961490L, -156411196L, 326806086L, -1950545062L,  1933232245L, 1553454333L, NA, 854271692L, -1805256054L, 307515173L,  -822514855L, -1233734614L, -1317232792L, 1294676843L, -1518484008L,  1760273660L, 1352566627L, -220821312L, -806086267L, 1791864603L,  1229948055L, 2058813983L, 885520285L, -1298425598L, 958424363L,  -152114235L, -502969524L, -755341284L, 1240249283L, -1548360745L,  2094691374L, 1980641455L, 781638437L, -2067338650L, -885673314L,  807058041L, 107822505L, 572555678L, -84554640L, 66854962L, -1829021930L,  -1052672883L, 1999580071L, 1239752784L, 1381890420L, 2105152120L,  1893656691L, -636967571L, 66880453L, 1040208565L, 796744824L,  1652345012L, -624809897L, 1010487212L, 414720242L, -1060806716L,  -1025275648L, -472140526L, 1477544634L, -1923912089L, 362200913L ), p = structure(c(1.30636490769866e+224, 4.34503364526558e-162,  8.87096742202714e-171, 4.25532932957808e+214, 1.11210241755163e-219,  1.18662619906731e-303, 3.45044863252006e+159, 3.5278860450043e+174,  3.43961268995667e-105, 0.000217737678953195, 6.67945510230888e+229,  2.43278710488382e-289, 4.77770321797571e+122, 2.88268489422876e+224,  5.34284422802472e-266, 2.65509258432105e-171, 4.46988290372226e-168,  2.78894641493927e+119, 2.12983640026911e-197, 1.27204680054112e+252,  7.04246471067801e+44), .Dim = c(3L, 7L)), pi_inv = structure(c(1.93774402666345e-132,  1.22246453601825e-131, 1.72050294120113e+58, 9.50606484572159e+194,  1.93270183736328e-175, 2.81725294873006e-194, 4.33051766730302e-220,  3.34809183334979e+34, 4.16672315285331e+266, 3.34397520763931e-297,  1.02649261994771e+114, 1.1379315096024e+284, 1.79129846978762e+260,  6.05164505756814e+177, 880085078.69576, 3784562013977.42, 1.31708558434065e-07,  4.26634427697153e+307, 3.5876348623736e-160, 1.6034661333406e+218,  1.78023310635684e+144, 22071295847.7237, 2.84297469121074e+241,  1.97347405694243e-173), .Dim = c(4L, 6L)), rate0 = c(2.9727151525712e-27,  -9.22386899091368e-185, 9.87579225719365e+193, 9.84332049266789e-279,  -3.15001626805275e-55, 9.44166444593156e+45, 8.52337310485128e+271,  -1.97207914019748e+307, -4.12368639712875e-228, -2.31514110015435e-220,  -9.42032324788869e-288, 3.57434806343699e-153, -3.72483454084344e-107,  5198496485781098496, 4.35218077052704e+30, -2.40391451999428e-120,  -7.93144240700313e+80, NA, -447.629689867083, 1.75054277709167e+138,  2.09426817887708e+104, -4.47294744164373e-114, -5.12151847967579e-239,  1.36195473930652e-257, 2.82257823111791e+228, -9.08884423734536e-215,  1.38711180895223e-202, 2.45549051380788e+255, -7.49378268550081e+303,  -4.3756228304321e-76, 2.44362705348442e-17, Inf, 1.10467983672324e-283,  3.35446128459361e-249, 1.05888821430538e+184, -1.40799488713284e-138,  -7.8636976575642e-273, -2.22244356855476e+31, -7.66845252913304e-212,  -2.96157302383773e+169, 4.8077409645935e-300, -8.08109893158201e-266,  2.30640253554875e+280, -1.84481924263749e-39, -1.35050451275495e+164,  -6.5045295419653e+297, -7.04019551297477e-182, 1.30000493895159e+194,  -4.42311017434053e-70, -1.85728562535448e+169, 5.69529145698883e-12,  1.73099834695145e+174, -5.39820954225464e+23, 2.0866257948288e-128,  -1.50214403363687e-269, 5.7434892462759e-217, NaN, NA, 1.57916255670936e+109,  1.26069416811135e-266, -1.28474100722954e+258, 6.56712868958693e+202,  9.60961463445e+294, 7.87047642530938e+29, 5.2029335407599e-107,  0), ref_order = structure(c(1.32397418379173e+268, 1.23991491174873e+194,  5.03517802155569e-80, 6.2871969428448e-224, 4.18262977588226e+248,  2.51703339793493e+120, 1.56034786058085e-114, 7.39436627086532e+29,  1.90721426295308e-32, 3.5083575512719e+255, 2.21835085538264e-89,  8.70640540442011e+188, 2.23428923987326e+200, 9.84440339773293e+239,  7.57005515051058e+79, 2.7249727421391e+210, 1.52077390431171e+175,  3.10779913274055e-154, 3.7893620591286e+57, 1.99474356229232e+239,  1.56854792720188e+152, 4.10200454625651e-224, 7.2546627967985e+50,  3.10816799760684e-112, 1.3381867680961e-168, 6.47223325771418e+128,  8.39760581417075e-66, 1.83749469873203e-174, 1.02217424616698e-265,  5.0193826576211e+123, 1.15316360480455e-64, 1.21671868485112e-233,  7.88049731404895e-266, 5.45513349367512e+73, 2.47630564319354e-131 ), .Dim = c(5L, 7L)), shape0 = structure(c(6.34861331197354e-177,  1.21905777570843e-164, 2.31105958501317e-195, 6.65886466726221e+298,  2.83065992811983e-62, 4.66464987252894e+256, 1.21750082475599e-97,  3.94850550921934e+86, 5.73519877050866e-89, 3.73335499224241e-171,  2.10846802978063e-210, 1.2043933557423e-77, 6.52627988979348e+158,  7.93739426800726e+283, 4.06261501791326e-18, 1.77654932146413e-35,  5.03392881054697e+179, 2.44469005149554e-129, 1.60360030366983e+130,  1.27397440156329e-163, 2.78726885747174e-226, 1.82261360824059e-252,  1.49932381925678e-210, 1.75594772947093e+173, 3.20096683126477e-137,  3.97885469168908e+26, 1.27754413192109e+75, 3.2607614630943e-248,  1.24583908168079e+199, 6.92585658594332e-281, 1.29688206967416e+168,  8.38020488375893e+161, 9.21062240565446e-198, 3.45890127177958e-222,  9.92458648287689e-214, 7.09288743965422e+76, 9.99506867396713e+295,  5.2576846381267e+200, 5.21530196250476e-246, 8564779144.85426,  1.16833675305522e-110, 9.54760765600019e+77, 2.02588849553886e-184,  2.28750360381249e-236, 7.79697893643073e+186, 2.72624512722644e+242,  5.57369306431349e+155, 4.58143567687391e+97, 2.54295928451314e-93,  5.16577458185361e-99, 1.77835433389459e+194, 1.19944208677488e+46,  3.70708182478656e+36, 3.71635152764621e-59, 2.93645101476738e-96,  1.23152255788051e+128, 5.72806101356627e+218, 1.31227145821916e-100,  2.36010558166127e-209, 2.52426112884196e-82, 6.6644218288867e+107,  2.13036903860291e+156, 1.05752491678215e-280, 2.68624744416338e+240,  7.66064795699223e-94, 2.29688835842742e-276, 1.74000278318814e-36,  8.26471365850999e+244, 2.81781451902998e-120, 4.57430249203904e-105,  4.09921962745699e+90, 0.0108748225240619, 1.21453038944259e+171,  2.22518174621843e-235, 6.56137008329197e+137, 3.02708218201265e+147,  1.99898960281066e-170, 2.26091083794968e-146, 7.39775469238942e-225,  2.75352586886644e+280), .Dim = c(10L, 8L)), u_bin = structure(c(1.53319500726807e-289,  2.06230742021026e-245, 0.0096386929847412, 1.83317198615273e+118,  7.01608304072621e+202, 9.61329982069234e+224, 1.5601614799947e+32,  6.6690433180895e-300, 9.61661985564593e+95, 1.63919424482166e-158,  9.67003192440403e-42, 4.3123746380022e+291, 11020177700.1213,  7.93048203782881e-247, 6.89539237281603e+210, 3.13369506413282e-132,  2.63656112525328e+126, 6.52050405686561e-277, 2.47546442523081e+97,  3.74624078027769e-186, 3.54515187000149e+191, 1.61846796281364e-169,  3.36327676751022e-45, 6.43290361788923e-168, 3.17006759360828e+41,  1.99504127147371e+254, 3.17784216962826e+144, 7.10042990637227e-275,  3.71814514449696e+254, 1.38432562426864e+122, 1.25844153496231e+285,  1.55113186850317e+100, 9.27727696422797e+89, 5.85110909851125e-244,  4.48001325128459e-303, 2.16750565066222e+229, 1.04072575197054e+268,  2.17069199504153e+307, 2.79827497668676e+283, 1.36133620787803e+244,  9.2445676541358e-173, 1.12617016571362e+114, 380974775.494557,  2.55121607209708e-148, 1.27414229855996e-117, 6.48490394608148e-122,  7.83774360350009e-188, 5.65366544977239e+302, 3.12734066910494e-110,  1.11996632561777e+170, 2.61988598510438e-59, 2.77093755978678e+145,  2.03021603436892e-123, 3.11111791539095e+172, 5.63290817152764e+159,  4.3640304075813e-303, 1.89563338102703e+104, 3.58562437799113e+99,  6.81598447593692e-278, 1.09163867235984e+176), .Dim = c(6L, 10L )), z_hat = structure(c(2.68729496048422e+107, 1.01651252856391e+213,  7.9653669097845e-87, 4.27595294138868e+140, 0.179384915223439,  2.64130833746635e-283), .Dim = c(6L, 1L)))
result <- do.call(PLMIX:::UpPhetpartial,testlist)
str(result)