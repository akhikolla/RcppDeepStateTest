<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Marco Geraci, University of South Carolina" />


<title>Qtools: A Collection of Models and Tools for Quantile Inference</title>






<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Qtools: A Collection of Models and Tools for Quantile Inference</h1>
<h4 class="author">Marco Geraci, University of South Carolina</h4>


<div id="TOC">
<ul>
<li><a href="#abstract">Abstract</a></li>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#unconditional-quantiles">Unconditional quantiles</a><ul>
<li><a href="#definition-and-estimation-of-quantiles">Definition and estimation of quantiles</a></li>
<li><a href="#lss---location-scale-and-shape-of-a-distribution">LSS - Location, scale and shape of a distribution</a></li>
</ul></li>
<li><a href="#conditional-quantiles">Conditional quantiles</a><ul>
<li><a href="#linear-models">Linear models</a></li>
<li><a href="#goodness-of-fit">Goodness of fit</a></li>
<li><a href="#transformation-models">Transformation models</a></li>
<li><a href="#conditional-lss">Conditional LSS</a></li>
</ul></li>
<li><a href="#other-functions-in-qtools">Other functions in <strong>Qtools</strong></a><ul>
<li><a href="#restricted-quantile-regression">Restricted quantile regression</a></li>
<li><a href="#conditional-quantiles-of-discrete-data">Conditional quantiles of discrete data</a><ul>
<li><a href="#jittering-for-count-responses">Jittering for count responses</a></li>
<li><a href="#conditional-mid-quantiles-for-discrete-responses">Conditional mid-quantiles for discrete responses</a></li>
</ul></li>
<li><a href="#quantile-based-multiple-imputation">Quantile-based multiple imputation</a></li>
</ul></li>
<li><a href="#final-remarks">Final remarks</a></li>
<li><a href="#acknowledgements">Acknowledgements</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

<div id="abstract" class="section level1">
<h1>Abstract</h1>
<p>Quantiles play a fundamental role in statistics. The quantile function defines the distribution of a random variable and, thus, provides a way to describe the data that is specular but equivalent to that given by the corresponding cumulative distribution function. There are many advantages in working with quantiles, starting from their properties. The renewed interest in their usage seen in the last years is due to the theoretical, methodological, and software contributions that have broadened their applicability. This paper presents the R package <strong>Qtools</strong>, a collection of utilities for unconditional and conditional quantiles.</p>
</div>
<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>Quantiles have a long history in applied statistics, especially the median. The analysis of astronomical data by Galileo Galilei in 1632 <span class="citation">(Hald 2003, 149)</span> and geodic measurements by Roger Boscovich in 1757 <span class="citation">(Koenker 2005, 2)</span> are presumably the earliest examples of application of the least absolute deviation (<span class="math inline">\(L_1\)</span>) estimator in its, respectively, unconditional and conditional forms. The theoretical studies on quantiles of continuous random variables started to appear in the statistical literature of the 20th century. In the case of discrete data, studies have somewhat lagged behind most probably because of the analytical drawbacks surrounding the discontinuities that characterise discrete quantile functions. Some forms of approximation to continuity have been recently proposed to study the large sample behavior of quantile estimators. For example, <span class="citation">Ma, Genton, and Parzen (2011)</span> have demonstrated the asymptotic normality of unconditional sample quantiles based on the definition of the mid-distribution function <span class="citation">(Parzen 2004)</span>. <span class="citation">Machado and Santos Silva (2005)</span> proposed inferential approaches to the estimation of conditional quantiles for counts based on data jittering.</p>
<p>Functions implementing quantile methods can be found in common statistical software. A considerable number of R packages that provide such functions are available on the Comprehensive R Archive Network (CRAN). The base package <strong>stats</strong> contains basic functions to estimate sample quantiles or compute quantiles of common parametric distributions. The <strong>quantreg</strong> package <span class="citation">(Koenker 2013)</span> is arguably a benchmark for distribution-free estimation of linear quantile regression models, as well as the base for other packages which make use of linear programming (LP) algorithms <span class="citation">(Koenker and D’Orey 1987; Koenker and Park 1996)</span>. Other contributions to the modelling of conditional quantile functions include packages for Bayesian regression, e.g. <strong>bayesQR</strong> <span class="citation">(Benoit et al. 2014)</span> and <strong>BSquare</strong> <span class="citation">(Smith and Reich 2013)</span>, and the <strong>lqmm</strong> package <span class="citation">(Geraci and Bottai 2014; Geraci 2014)</span> for random-effects regression.</p>
<p>The focus of this paper is on the R package <strong>Qtools</strong>, a collection of models and tools for quantile inference. These include commands for</p>
<ul>
<li>quantile-based analysis of the location, scale and shape of a distribution;</li>
<li>transformation-based quantile regression;</li>
<li>goodness of fit and restricted quantile regression;</li>
<li>quantile regression for discrete data;</li>
<li>quantile-based multiple imputation. The emphasis will be put on the first two topics listed above as they represent the main contribution of the package, while a short description of the other topics is given for completeness.</li>
</ul>
</div>
<div id="unconditional-quantiles" class="section level1">
<h1>Unconditional quantiles</h1>
<div id="definition-and-estimation-of-quantiles" class="section level2">
<h2>Definition and estimation of quantiles</h2>
<p>Let <span class="math inline">\(Y\)</span> be a random variable with cumulative distribution function (CDF) <span class="math inline">\(F_{Y}\)</span> and support <span class="math inline">\(S_{Y}\)</span>. The CDF calculated at <span class="math inline">\(y \in S_{Y}\)</span> returns the probability <span class="math inline">\(F_{Y}(y) \equiv p = \Pr\left(Y \leq y\right)\)</span>. The quantile function (QF) is defined as <span class="math inline">\(Q(p) = \inf_{y}\{F_{Y}(y) \geq p\}\)</span>, for <span class="math inline">\(0 &lt; p &lt; 1\)</span>. (Some authors consider <span class="math inline">\(0 \leq p \leq 1\)</span>. For practical purposes, it is simpler to exclude the endpoints 0 and 1.) When <span class="math inline">\(F_{Y}\)</span> is continuous and strictly monotone (hence, <span class="math inline">\(f_{Y}(y) \equiv F_{Y}&#39;(y) &gt; 0\)</span> for all <span class="math inline">\(y \in S_{Y}\)</span>), the quantile function is simply the inverse of <span class="math inline">\(F_{Y}\)</span>. In other cases, the quantile <span class="math inline">\(p\)</span> is defined, by convention, as the smallest value <span class="math inline">\(y\)</span> such that <span class="math inline">\(F_{Y}(y)\)</span> is at least <span class="math inline">\(p\)</span>.</p>
<p>Quantiles enjoy a number of properties. An excellent overview is given by <span class="citation">Gilchrist (2000)</span>. In particular, the <em>Q-tranformation rule</em> <span class="citation">(Gilchrist 2000)</span> or equivariance to monotone transformations states that if <span class="math inline">\(h(\cdot)\)</span> is a non-decreasing function on <span class="math inline">\(\mathbb{R}\)</span>, then <span class="math inline">\(Q_{h(Y)}(p) = h\left\{Q_{Y}(p)\right\}\)</span>. Hence <span class="math inline">\(Q_{Y}(p) = h^{-1}\left\{Q_{h(Y)}(p)\right\}\)</span>. Note that this property does not generally hold for the expected value.</p>
<p>Sample quantiles for a random variable <span class="math inline">\(Y\)</span> can be calculated in a number of ways, depending on how they are defined <span class="citation">(Hyndman and Fan 1996)</span>. For example, the function <tt>quantile</tt> in the base package <strong>stats</strong> provides nine different sample quantile estimators, which are based on the sample order statistics or the inverse of the empirical CDF. These estimators are distribution-free as they do not depend on any parametric assumption about <span class="math inline">\(F\)</span> (or <span class="math inline">\(Q\)</span>).</p>
<p>Let <span class="math inline">\(Y_{1}, Y_{2}, \ldots, Y_{n}\)</span> be a sample of <span class="math inline">\(n\)</span> independent and identically distributed (<em>iid</em>) observations from the population <span class="math inline">\(F_{Y}\)</span>. Let <span class="math inline">\(\xi_p\)</span> denote the <span class="math inline">\(p\)</span>th population quantile and <span class="math inline">\(\hat{\xi}_p\)</span> the corresponding sample quantile. (The subscripts will be dropped occasionally to ease notation, e.g. <span class="math inline">\(F\)</span> will be used in place of <span class="math inline">\(F_{Y}\)</span> or <span class="math inline">\(\xi\)</span> in place of <span class="math inline">\(\xi_{p}\)</span>.) In the continuous case, it is well known that <span class="math inline">\(\sqrt{n}\left(\hat{\xi}_{p} - \xi_{p}\right)\)</span> is approximately normal with mean zero and variance <span class="math display">\[\begin{equation}\label{eq:1}
\tag{1}
\omega^2 = \frac{p(1-p)}{\{f_{Y}(\xi_p)\}^2}.
\end{equation}\]</span> A more general result is obtained when the <span class="math inline">\(Y_{i}\)</span>’s, <span class="math inline">\(i = 1, \ldots, n\)</span>, are independent but not identically distributed (<em>nid</em>). The density evaluated at the <span class="math inline">\(p\)</span>th quantile, <span class="math inline">\(f(\xi_p)\)</span>, is called density-quantile function by <span class="citation">Parzen (1979)</span>. Its reciprocal, <span class="math inline">\(s(p) \equiv 1/f(\xi_p)\)</span>, is called sparsity function <span class="citation">(Tukey 1965)</span> or quantile-density function <span class="citation">(Parzen 1979)</span>.</p>
<p>As mentioned previously, the discontinuities of <span class="math inline">\(F_{Y}\)</span> when <span class="math inline">\(Y\)</span> is discrete represent a mathematical inconvenience. <span class="citation">Ma, Genton, and Parzen (2011)</span> derived the asymptotic distribution of the sample mid-quantiles, that is, the sample quantiles based on the mid-distribution function (mid-CDF). The latter is defined as <span class="math inline">\(F^{mid}_{Y}(y) = F_{Y}(y) - 0.5p_{Y}(y)\)</span>, where <span class="math inline">\(p_{Y}(y)\)</span> denotes the probability mass function <span class="citation">(Parzen 2004)</span>. In particular, they showed that, as <span class="math inline">\(n\)</span> becomes large, <span class="math inline">\(\sqrt{n}\left(\hat{\xi}^{mid}_{p} - \xi_{p}\right)\)</span> is approximately normal with mean <span class="math inline">\(0\)</span>. Under <em>iid</em> assumptions, the expression for the sampling variance is similar to that in (1); see <span class="citation">Ma, Genton, and Parzen (2011)</span> for details.</p>
<p>The package <strong>Qtools</strong> provides the functions <tt>midecdf</tt> and <tt>midquantile</tt>, which return objects of class <tt>“midecdf”</tt> or <tt>“midquantile”</tt>, respectively, containing: the values or the probabilities at which mid-cumulative probabilities or mid-quantiles are calculated (<span class="math inline">\(x\)</span>), the mid-cumulative probabilities or the mid-quantiles (<span class="math inline">\(y\)</span>), and the functions that linearly interpolate those coordinates (<span class="math inline">\(fn\)</span>). An example is shown below using data simulated from a Poisson distribution.</p>
<pre><code>&gt; library(&quot;Qtools&quot;)
&gt; set.seed(467)
&gt; y &lt;- rpois(1000, 4)
&gt; pmid &lt;- midecdf(y)
&gt; xmid &lt;- midquantile(y, probs = pmid$y)
&gt; pmid

Empirical mid-ECDF
Call:
midecdf(x = y)

&gt; xmid

Empirical mid-ECDF
Call:
midquantile(x = y, probs = pmid$y)</code></pre>
<p>A confidence interval for sample mid-quantiles can be obtained using <tt>confint.midquantile</tt>. This function is applied to the output of <tt>midquantile</tt> and returns an object of class <tt>“data.frame”</tt> containing sample mid-quantiles, lower and upper bounds of the confidence intervals of a given level (<span class="math inline">\(95\%\)</span> by default), along with standard errors as an attribute named <tt>‘stderr’</tt>. This is shown below using the sample <span class="math inline">\(y\)</span> generated in the previous example.</p>
<pre><code>&gt; xmid &lt;- midquantile(y, probs = 1:3/4)
&gt; x &lt;- confint(xmid, level = 0.95)
&gt; x

    midquantile    lower    upper
25%    2.540000 2.416462 2.663538
50%    3.822816 3.693724 3.951907
75%    5.254902 5.072858 5.436946

&gt; attr(x, &quot;stderr&quot;)
[1] 0.06295447 0.06578432 0.09276875</code></pre>
<pre><code>&gt; par(mfrow = c(1,2))
&gt; plot(pmid, xlab = &quot;y&quot;, ylab = &quot;CDF&quot;, jumps = TRUE)
&gt; points(pmid$x, pmid$y, pch = 15)
&gt; plot(xmid, xlab = &quot;p&quot;, ylab = &quot;Quantile&quot;, jumps = TRUE)
&gt; points(xmid$x, xmid$y, pch = 15)</code></pre>
<div class="figure">
<img src="data:image/png;base64,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" alt />
<p class="caption">Figure 1. Cumulative distribution (a) and quantile (b) functions for simulated Poisson data. The ordinary cumulative distribution function (CDF) and quantile function (QF) are represented by step-functions (grey lines), with the convention that, at the point of discontinuity or `jump’, the function takes its value corresponding to the ordinate of the filled circle as opposed to that of the hollow circle. The mid-CDF and mid-QF are represented by filled squares, while the piecewise linear functions (dashed lines) connecting the squares represent continuous versions of, respectively, the ordinary CDF and QF.</p>
</div>
<p>Finally, a plot method is available for both <tt>midecdf</tt> and <tt>midquantile</tt> objects. An illustration is given in Figure 1. The mid-distribution and mid-quantile functions are discrete and their values are marked by filled squares. The piecewise linear functions connecting the filled squares represent continuous versions of the CDF and QF which interpolate between the steps of, respectively, the ordinary CDF and quantile functions. Note that the argument <tt>jumps</tt> is a logical value indicating whether values at jumps should be marked.</p>
</div>
<div id="lss---location-scale-and-shape-of-a-distribution" class="section level2">
<h2>LSS - Location, scale and shape of a distribution</h2>
<p>Since the cumulative distribution and quantile functions are two sides of the same coin, the location, scale, and shape (LSS) of a distribution can be examined using one or the other. Well-known quantile-based measures of location and scale are the median and inter-quartile range (IQR), respectively. Similarly, there are also a number of quantile-based measures for skewness and kurtosis <span class="citation">(Groeneveld and Meeden 1984; Groeneveld 1998; Jones, Rosco, and Pewsey 2011)</span>.</p>
<p>Define the ‘central’ portion of the distribution as that delimited by the quantiles <span class="math inline">\(Q(p)\)</span> and <span class="math inline">\(Q(1-p)\)</span>, <span class="math inline">\(0 &lt; p &lt; 0.5\)</span>, and define the ‘tail’ portion as that lying outside these quantiles. Let <span class="math inline">\(IPR(p) = Q(1-p) - Q(p)\)</span> denote the inter-quantile range at level <span class="math inline">\(p\)</span>. Building on the results by <span class="citation">Horn (1983)</span> and <span class="citation">Ruppert (1987)</span>, <span class="citation">Staudte (2014)</span> considered the following identity: <span class="math display">\[\begin{equation}\label{eq:2}
\tag{2}
\underbrace{\frac{IPR(p)}{IPR(r)}}_\text{kurtosis} = \underbrace{\frac{IPR(p)}{IPR(q)}}_\text{tail-weight} \, \cdot \, \underbrace{\frac{IPR(q)}{IPR(r)}}_\text{peakedness},
\end{equation}\]</span> where <span class="math inline">\(0 &lt; p &lt; q &lt; r &lt; 0.5\)</span>. These quantile-based measures of shape are sign, location and scale invariant. As compared to moment-based indices, they are also more robust to outliers and easier to interpret <span class="citation">(Groeneveld 1998; Jones, Rosco, and Pewsey 2011)</span>.</p>
<p>It is easy to verify that a quantile function can be written as <span class="math display">\[\begin{equation}\label{eq:3}
\tag{3}
Q(p) = \underbrace{Q(0.5)}_\text{median}\,\, + \,\, \frac{1}{2}\underbrace{IPR(0.25)}_\text{IQR} \, \cdot \, \underbrace{\frac{IPR(p)}{IPR(0.25)}}_\text{shape index} \, \cdot \, \bigg(\underbrace{\frac{Q(p) + Q(1-p) - 2Q(0.5)}{IPR(p)}}_\text{skewness index} - 1\bigg).
\end{equation}\]</span> This identity establishes a relationship between the location (median), scale (IQR) and shape of a distribution. (This identity appears in <span class="citation">Gilchrist (2000, 74)</span> with an error of sign. See also <span class="citation">Benjamini and Krieger (1996, eq.1)</span>.) The quantity <span class="math inline">\(IPR(p)/IPR(0.25)\)</span> in (3) is loosely defined as the ‘shape index’ <span class="citation">(Gilchrist 2000, 72)</span>, although it can be seen as the tail-weight measure given in (2) when <span class="math inline">\(p &lt; 0.25\)</span>. For symmetric distributions, the contribution of the skewness index vanishes. Note that the skewness index not only is location and scale invariant, but is also bounded between <span class="math inline">\(-1\)</span> and <span class="math inline">\(1\)</span> (as opposed to the Pearson’s third standardised moment which can be infinite or even undefined). When this index is near the bounds <span class="math inline">\(-1\)</span> or <span class="math inline">\(1\)</span>, then <span class="math inline">\(Q(1-p) \approx Q(0.5)\)</span> or <span class="math inline">\(Q(p) \approx Q(0.5)\)</span>, respectively.</p>
<p>The function <tt>qlss</tt> provides a quantile-based LSS summary with the indices defined in (3) of either a <em>theoretical</em> or an <em>empirical</em> distribution. It returns an object of class <tt>“qlss”</tt>, which is a list containing measures of location (median), scale (IQR and IPR), and shape (skewness and shape indices) for each of the probabilities specified in the argument <tt>probs</tt> (by default, <tt>probs</tt> = 0.1). The quantile-based LSS summary of the normal distribution is given in the example below for <span class="math inline">\(p =0.1\)</span>. The argument <tt>fun</tt> can take any quantile function whose probability argument is named  (this is the case for many standard quantile functions in R, e.g. <tt>qt</tt>, <tt>qchisq</tt>, <tt>qf</tt>, etc.).</p>
<pre><code>&gt; qlss(fun = &quot;qnorm&quot;, probs = 0.1)

call:
qlss.default(fun = &quot;qnorm&quot;, probs = 0.1)

Unconditional Quantile-Based Location, Scale, and Shape

** Location **
Median
[1] 0
** Scale **
Inter-quartile range (IQR)
[1] 1.34898
Inter-quantile range (IPR)
     0.1
2.563103
** Shape **
Skewness index
0.1
  0
Shape index
     0.1
1.900031</code></pre>
<p>An empirical example is now illustrated using the <tt>faithful</tt> data set, which contains <span class="math inline">\(272\)</span> observations on waiting time (minutes) between eruptions and the duration (minutes) of the eruption for the Old Faithful geyser in Yellowstone National Park, Wyoming, USA. Summary statistics are given in Table 1.</p>
<table>
<tr>
<td>
</td>
<td>
Minimum
</td>
<td>
Q1
</td>
<td>
Q2
</td>
<td>
Q3
</td>
<td>
Maximum
</td>
</tr>
<tr>
<td>
Wating time
</td>
<td>
43.0
</td>
<td>
58.0
</td>
<td>
76.0
</td>
<td>
82.0
</td>
<td>
96.0
</td>
</tr>
<td>
Duration
</td>
<td>
1.6
</td>
<td>
2.2
</td>
<td>
4.0
</td>
<td>
4.5
</td>
<td>
5.1
</td>
Table 1: Minimum, maximum and three quartiles (Q1, Q2, Q3) for waiting time and duration in the Old Faithful Geyser data set.
</table>
<div class="figure">
<img src="data:image/png;base64,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" alt />
<p class="caption">Figure 2. Estimated density (a) and empirical mid-quantile (b) functions of waiting time between eruptions in the Old Faithful Geyser data set.</p>
</div>
<p>Suppose the interest is in describing the distribution of waiting times. The density is plotted in Figure 2, along with the mid-quantile function. The distribution is bimodal with peaks at around <span class="math inline">\(54\)</span> and <span class="math inline">\(80\)</span> minutes. Note that the arguments of the base function <tt>quantile</tt>, including the argument <tt>type</tt>, can be passed on to <tt>qlss</tt>.</p>
<pre><code>&gt; y &lt;- faithful$waiting
&gt; par(mfrow = c(1,2))
&gt; plot(density(y))
&gt; plot(midquantile(y, probs = p), jumps = FALSE)
&gt; qlss(y, probs = c(0.05, 0.1, 0.25), type = 7)

call:
qlss.numeric(x = y, probs = c(0.05, 0.1, 0.25), type = 7)

Unconditional Quantile-Based Location, Scale, and Shape

** Location **
Median
[1] 76
** Scale **
Inter-quartile range (IQR)
[1] 24
Inter-quantile range (IPR)
0.05  0.1 0.25
  41   35   24
** Shape **
Skewness index
      0.05        0.1       0.25
-0.3658537 -0.4285714 -0.5000000
Shape index
    0.05      0.1     0.25
1.708333 1.458333 1.000000</code></pre>
<p>At <span class="math inline">\(p = 0.1\)</span>, the skewness index is approximately <span class="math inline">\(-0.43\)</span>, which denotes a rather strong left asymmetry. As for the shape index, which is equal to <span class="math inline">\(1.46\)</span>, one could say that the tails of this distribution weigh less than those of a normal distribution (<span class="math inline">\(1.90\)</span>), though of course a comparison between unimodal and bimodal distributions is not meaningful.</p>
</div>
</div>
<div id="conditional-quantiles" class="section level1">
<h1>Conditional quantiles</h1>
<div id="linear-models" class="section level2">
<h2>Linear models</h2>
<p>In general, the <span class="math inline">\(p\)</span>th linear QR model is of the form <span class="math display">\[\begin{equation}\label{eq:4}
\tag{4}
Q_{Y|X}(p) = \mathbf{x}^{\top}\boldsymbol \beta(p)
\end{equation}\]</span> where <span class="math inline">\(\mathbf{x}\)</span> is a <span class="math inline">\(k\)</span>-dimensional vector of covariates (including <span class="math inline">\(1\)</span> as first element) and <span class="math inline">\(\boldsymbol \beta(p) = [\beta_{0}(p), \beta_{1}(p),\)</span> <span class="math inline">\(\ldots, \beta_{k-1}(p)]^{\top}\)</span> is a vector of coefficients. The ‘slopes’ <span class="math inline">\(\beta_{j}(p)\)</span>, <span class="math inline">\(j = 1,\ldots, k-1\)</span>, have the usual interpretation of partial derivatives. For example, in case of the simple model <span class="math inline">\(Q_{Y|X}(p) = \beta_{0}(p) + \beta_{1}(p)x\)</span>, one obtains <span class="math display">\[
\frac{\partial Q_{Y|X}(p)}{\partial x} =  \beta_{1}(p).\\
\]</span> If <span class="math inline">\(x\)</span> is a dummy variable, then <span class="math inline">\(\beta_{1}(p) = Q_{Y|X = 1}(p) - Q_{Y|X=0}(p)\)</span>, i.e. the so-called ‘quantile treatment effect’ <span class="citation">(Doksum 1974; Lehmann 1975; Koenker and Xiao 2002)</span>. Estimation can be carried out using LP algorithms which, given a sample <span class="math inline">\((\mathbf{x}_{i},y_{i})\)</span>, <span class="math inline">\(i=1,\dots,n\)</span>, solve <span class="math display">\[
\min_{b \in \mathbb{R}^{k}} \sum_{i=1}^{n} \kappa_{p}\left(y_{i} - \mathbf{x}_{i}^{\top}\mathbf{b}\right),
\]</span> where <span class="math inline">\(\kappa_{p}(u) = u(p - I(u &lt; 0))\)</span>, <span class="math inline">\(0 &lt; p &lt; 1\)</span>, is the check loss function. Large-<span class="math inline">\(n\)</span> approximation of standard errors can be obtained from the sampling distribution of the linear quantile estimators <span class="citation">(Koenker and Bassett 1978)</span>.</p>
<div class="figure">
<img src="data:image/png;base64,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" alt />
<p class="caption">Figure 3. (a) Waiting times between eruptions against durations of eruptions (dashed vertical line drawn at <span class="math inline">\(3\)</span> minutes) in the Old Faithful Geyser data set. (b) Mid-CDF of waiting time by duration of eruption (solid line, shorter than 3 minutes; dashed line, longer than 3 minutes).</p>
</div>
<p>Waiting times between eruptions are plotted against the durations of the eruptions in Figure 3. Two clusters of observations can be defined for durations below and above 3 minutes <span class="citation">(see also Azzalini and Bowman 1990)</span>. The distribution shows a strong bimodality as already illustrated in Figure 2. A dummy variable for durations equal to or longer than <span class="math inline">\(3\)</span> minutes is created to define the two distributions and included as covariate <span class="math inline">\(X\)</span> in a model as the one specified in (4). The latter is then fitted to the Old Faithful Geyser data using the function <tt>rq</tt> in the package <strong>quantreg</strong> for <span class="math inline">\(p \in \{0.1, 0.25, 0.5, 0.75, 0.9\}\)</span>.</p>
<pre><code>&gt; require(&quot;quantreg&quot;)
&gt; y &lt;- faithful$waiting
&gt; x &lt;- as.numeric(faithful$eruptions &gt;= 3)
&gt; fit &lt;- rq(formula = y ~ x, tau = c(0.1, 0.25, 0.5, 0.75, 0.9))
&gt; fit


Call:
rq(formula = y ~ x, tau = c(0.1, 0.25, 0.5, 0.75, 0.9))

Coefficients:
            tau= 0.10 tau= 0.25 tau= 0.50 tau= 0.75 tau= 0.90
(Intercept)        47        50        54        59        63
x                  26        26        26        25        25

Degrees of freedom: 272 total; 270 residual</code></pre>
<p>From the output above, it is quite evident that the distribution of waiting times is shifted by an approximately constant amount at all considered values of <span class="math inline">\(p\)</span>. The location-shift hypothesis can be tested by using the Khmaladze test. The null hypothesis is that two distributions, say <span class="math inline">\(F_{0}\)</span> and <span class="math inline">\(F_{1}\)</span>, differ by a pure location shift <span class="citation">(Koenker and Xiao 2002)</span>, that is <span class="math display">\[
H_{0}: \, F^{-1}_{1}(p) = F^{-1}_{0}(p) + \delta_{0},
\]</span> where <span class="math inline">\(\delta_{0}\)</span> is the quantile treatment effect, constant over <span class="math inline">\(p\)</span>. The location–scale-shift specification of the test considers <span class="math display">\[
H_{0}: \, F^{-1}_{1}(p) = \delta_{1}F^{-1}_{0}(p) + \delta_{0}.
\]</span> The alternative hypothesis is that the model is more complex than the one specified in the null hypothesis. The Khmaladze test is implemented in <strong>quantreg</strong> (see <tt>?quantreg::KhmaladzeTest</tt> for further details). The critical values of the test and corresponding significance levels <span class="citation">(Koenker 2005)</span> are not readily available in the same package. These have been hardcoded in the <strong>Qtools</strong> function <tt>KhmaladzeFormat</tt> which can be applied to <tt>“KhmaladzeTest”</tt> objects. For the Old Faithful Geyser data, the result of the test is not statistically significant at the <span class="math inline">\(10\%\)</span> level.</p>
<pre><code>&gt; kt &lt;- KhmaladzeTest(formula = y ~ x, taus = seq(.05, .95, by = .01),
&gt; KhmaladzeFormat(kt, 0.05)

Khmaladze test for the location-shift hypothesis
Joint test is not significant at 10% level
Test(s) for individual slopes:
 not significant at 10% level</code></pre>
</div>
<div id="goodness-of-fit" class="section level2">
<h2>Goodness of fit</h2>
<p>Distribution-free quantile regression does not require introducing an assumption on the functional form of the error distribution <span class="citation">(Koenker and Bassett 1978)</span>, but only weaker quantile restrictions <span class="citation">(Powell 1994)</span>. Comparatively, the linear specification of the conditional quantile function in Equation 4 is a much stronger assumption and thus plays an important role for inferential purposes.</p>
<p>The problem of assessing the goodness of fit (GOF) is rather neglected in applications of QR. Although some approaches to GOF have been proposed <span class="citation">(Zheng 1998; Koenker and Machado 1999; He and Zhu 2003; Khmaladze and Koul 2004)</span>, there is currently a shortage of software code available to users. The function <tt>GOFTest</tt> implements a test based on the cusum process of the gradient vector <span class="citation">(He and Zhu 2003)</span>. Briefly, the test statistic is given by the largest eigenvalue of <span class="math display">\[
n^{-1}\sum_{i}^{n} \mathbf{R}_{n}(\mathbf{x}_{i})\mathbf{R}^{\top}_{n}(\mathbf{x}_{i})
\]</span> where <span class="math inline">\(\mathbf{R}_{n}(\mathbf{t}) = n^{-1/2} \sum_{j=1}^{n} \psi_{p}(r_{j})\mathbf{x}_{j} I(\mathbf{x}_{j} \leq \mathbf{t})\)</span> is the residual cusum (RC) process and <span class="math inline">\(\psi_{p}(r_{j})\)</span> is the derivative of the loss function <span class="math inline">\(\kappa_{p}\)</span> calculated for residual <span class="math inline">\(r_{j} = y_{j} - \mathbf{x}_{j}^{\top}\boldsymbol \beta(p)\)</span>. The sampling distribution of this test statistic is non-normal <span class="citation">(He and Zhu 2003)</span> and a resampling approach is used to obtain the <span class="math inline">\(p\)</span>-value under the null hypothesis.</p>
<p>An example is provided further below using the New York Air Quality data set, which contains <span class="math inline">\(111\)</span> complete observations on daily mean ozone (parts per billion – ppb) and solar radiation (Langleys – Ly). For simplicity, wind speed and maximum daily temperature, also included in the data set, are not analysed here.</p>
<p>Suppose that the model of interest is <span class="math display">\[\begin{equation}\label{eq:5}
\tag{5}
Q_{\text{ozone}}(p) = \beta_{0}(p) + \beta_{1}(p) \cdot \text{Solar.R}.
\end{equation}\]</span> Three conditional quantiles (<span class="math inline">\(p \in \{0.1,0.5,0.9\}\)</span>) are estimated and plotted using the following code:</p>
<pre><code>&gt; dd &lt;- airquality[complete.cases(airquality), ]
&gt; dd &lt;- dd[order(dd$Solar.R), ]
&gt; fit.rq &lt;- rq(Ozone ~ Solar.R, tau = c(.1, .5, .9), data = dd)
&gt; x &lt;- seq(min(dd$Solar.R), max(dd$Solar.R), length = 200)
&gt; yhat &lt;- predict(fit.rq, newdata = data.frame(Solar.R = x))
&gt; plot(Ozone ~ Solar.R, data = dd)
&gt; apply(yhat, 2, function(y,x) lines(x,y), x = x)</code></pre>
<div class="figure">
<img src="data:image/png;base64,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" alt />
<p class="caption">Figure 4. Predicted 10th (solid line), 50th (dashed line), and 90th (dot-dashed line) centiles of ozone conditional on solar radiation in the New York Air Quality data set.</p>
</div>
<p>As a function of solar radiation, the median of the ozone daily averages increases by <span class="math inline">\(0.09\)</span> ppb for each Ly increase in solar radiation (Figure 4). The 90th centile of conditional ozone shows a steeper slope at <span class="math inline">\(0.39\)</span> ppb/Ly, about nine times larger than the slope of the conditional <span class="math inline">\(10\)</span>th centile at <span class="math inline">\(0.04\)</span> ppb/Ly.</p>
<p>The RC test applied to the the object <tt>fit.rq</tt> provides evidence of lack of fit for all quantiles considered, particularly for <span class="math inline">\(p = 0.1\)</span> and <span class="math inline">\(p = 0.5\)</span>. Therefore the straight-line model in Equation 5 for these three conditional quantiles does not seem to be appropriate. The New York Air Quality data set will be analysed again in the next section, where a transformation-based approach to nonlinear modelling is discussed.</p>
<pre><code>&gt; gof.rq &lt;- GOFTest(fit.rq, alpha = 0.05, B = 1000, seed = 987)
&gt; gof.rq

Goodness-of-fit test for quantile regression based on the cusum process
Quantile 0.1: Test statistic = 0.1057; p-value = 0.001
Quantile 0.5: Test statistic = 0.2191; p-value = 0
Quantile 0.9: Test statistic = 0.0457; p-value = 0.018</code></pre>
</div>
<div id="transformation-models" class="section level2">
<h2>Transformation models</h2>
<p>Complex dynamics may result in nonlinear effects in the relationship between the covariates and the response variable. For instance, in kinesiology, pharmacokinetics, and enzyme kinetics, the study of the dynamics of an agent in a system involves the estimation of nonlinear models; phenomena like human growth, certain disease mechanisms and the effects of harmful environmental substances such as lead and mercury, may show strong nonlinearities over time. In this section, the linear model is abandoned in favor of a more general model of the type <span class="math display">\[\begin{equation}\label{eq:6}
\tag{6}
Q_{Y|X}(p) = g\left\{\mathbf{x}^{\top}\boldsymbol \beta(p)\right\},
\end{equation}\]</span> for some real-valued function <span class="math inline">\(g\)</span>. If <span class="math inline">\(g\)</span> is nonlinear, the alternative approaches to conditional quantile modelling are</p>
<ol style="list-style-type: decimal">
<li>nonlinear parametric models—this approach may provide a model with substantive interpretability, possibly parsimonious (in general more parsimonious than polynomials), and valid beyond the observed range of the data. A nonlinear model depends on either prior knowledge of the phenomenon or the introduction of new, strong theory to explain the observed relationship with potential predictive power. Estimation may present challenges;</li>
<li>polynomial models and smoothing splines—this approach goes under the label of <em>nonparametric regression</em>, in which the complexity of the model is approximated by a sequence of linear polynomials (a naive global polynomial trend can be considered to be a special case). A nonparametric model need not introducing strong assumptions about the relationship and is essentially data-driven. Estimation is based on linear approximations and, typically, requires the introduction of a penalty term to control the degree of smoothing; and</li>
<li>transformation models—a flexible, parsimonious family of parametric transformations is applied to the response seeking to obtain approximate linearity on the transformed scale. The data provide information about the ‘best’ transformation among a family of transformations. Estimation is facilitated by the application of methods for linear models.</li>
</ol>
<p>The focus of this section is on the third approach. More specifically the functions available in <strong>Qtools</strong> refer to the methods for transformation-based QR models developed by <span class="citation">Powell (1991)</span>, <span class="citation">Chamberlain (1994)</span>, <span class="citation">Mu and He (2007)</span>, <span class="citation">Dehbi, Cortina-Borja, and Geraci (2016)</span> and <span class="citation">Geraci and Jones (2015)</span>. Examples of approaches to nonlinear QR based on parametric models or splines can be found in <span class="citation">Koenker and Park (1996)</span> and <span class="citation">Yu and Jones (1998)</span>, respectively.</p>
<p>The goal of transformation-based QR is to fit the model <span class="math display">\[\begin{equation}\label{eq:7}
\tag{7}
Q_{h\left(Y;\lambda_{p}\right)}(p) = \mathbf{x}^{\top}\boldsymbol \beta(p).
\end{equation}\]</span> The assumption is that the transformation <span class="math inline">\(h\)</span> is the inverse of <span class="math inline">\(g\)</span>, <span class="math inline">\(h(Y; \lambda_{p}) \equiv g^{-1}(Y)\)</span>, so that the <span class="math inline">\(p\)</span>th quantile function of the transformed response variable is linear. (In practice, it is satisfactory to achieve approximate linearity.) The parameter <span class="math inline">\(\lambda_{p}\)</span> is a low-dimensional parameter that gives some flexibility to the shape of the transformation and is estimated from the data. In general, the interest is on predicting <span class="math inline">\(Q_{Y|X}(p)\)</span> and estimating the effects of the covariates on <span class="math inline">\(Q_{Y|X}(p)\)</span>. If <span class="math inline">\(h\)</span> is a non-decreasing function on <span class="math inline">\(\mathbb{R}\)</span> (as is the case for all transformations considered here), predictions can be easily obtained from (7) by virtue of the equivariance property of quantiles, <span class="math display">\[\begin{equation}\label{eq:8}
\tag{8}
Q_{Y|X}(p) = h^{-1}\left\{\mathbf{x}^{\top}\boldsymbol \beta(p); \lambda_{p}\right\}.
\end{equation}\]</span> The marginal effect of the <span class="math inline">\(j\)</span>th covariate <span class="math inline">\(x_{j}\)</span> can be obtained by differentiating the quantile function <span class="math inline">\(Q_{Y|X}(p)\)</span> with respect to <span class="math inline">\(x_{j}\)</span>. This can be written as the derivative of the composition <span class="math inline">\(Q \circ \eta\)</span>, i.e.<br />
<span class="math display">\[\begin{equation}\label{eq:9}
\tag{9}
\frac{\partial Q(p)}{\partial x_{j}} = \frac{\partial Q(p)}{\partial \eta(p)} \cdot \frac{\partial \eta(p)}{\partial x_{j}},
\end{equation}\]</span> <span class="math inline">\(\eta(p) = \mathbf{x}^{\top}\boldsymbol \beta(p)\)</span>. Once the estimates <span class="math inline">\(\hat{\boldsymbol{\beta}}(p)\)</span> and <span class="math inline">\(\hat{\lambda}_{p}\)</span> are obtained, these can be plugged in Equations 8 and 9.</p>
<p>The package <strong>Qtools</strong> provides several transformation families, namely the Box–Cox <span class="citation">(Box and Cox 1964)</span>, Aranda-Ordaz <span class="citation">(Aranda-Ordaz 1981)</span>, and Jones <span class="citation">(Jones 2007; Geraci and Jones 2015)</span> transformations. A distinction between these families is made in terms of the support of the response variable to which the transformation is applied and the number of transformation parameters. The Box–Cox model is a one-parameter family of transformations which applies to singly bounded variables, <span class="math inline">\(y &gt; 0\)</span>. The Aranda-Ordaz symmetric and asymmetric transformations too have one parameter and are used when responses are bounded on the unit interval, <span class="math inline">\(0 &lt; y &lt; 1\)</span> (doubly bounded). <span class="citation">Geraci and Jones (2015)</span> developed two families of transformations which can be applied to either singly or doubly bounded responses:</p>
<ul>
<li>Proposal I transformations – this family has one parameter and it comes in both symmetric and asymmetric forms;</li>
<li>Proposal II transformations – this family has two parameters, with one parameter modelling the symmetry (or lack thereof) of the transformation.</li>
</ul>
<p>Originally, <span class="citation">Box and Cox (1964)</span> proposed using power transformations to address lack of linearity, homoscedasticity and normality of the residuals in mean regression modelling.  () reported that ``seldom does this transformation fulfil the basic assumptions of linearity, normality and homoscedasticity simultaneously as originally suggested by Box &amp; Cox (1964). The Box-Cox transformation has found more practical utility in the empirical determination of functional relationships in a variety of fields, especially in econometrics’’.</p>
<p>Indeed, the practical utility of power transformations has been long recognised in QR modelling <span class="citation">(Powell 1991; Buchinsky 1995; Chamberlain 1994; Mu and He 2007)</span>. Model 7 is the Box–Cox QR model if <span class="math display">\[\begin{equation}\label{eq:10}
\tag{10}
h_{BC}\left(Y;\lambda_{p}\right) =
\begin{cases}
 \dfrac{Y^{\lambda_{p}} - 1}{\lambda_{p}} &amp; \text{if $\lambda_{p}
\neq 0$}\\[.5cm]
\log Y &amp; \text{if $\lambda_{p} = 0$}.
\end{cases}
\end{equation}\]</span> Note that when <span class="math inline">\(\lambda_{p} \neq 0\)</span>, the range of this transformation is not <span class="math inline">\(\mathbb{R}\)</span> but the singly bounded interval <span class="math inline">\((-1/\lambda_{p},\infty)\)</span>. This implies that the inversion in (8) is defined only for <span class="math inline">\(\lambda_{p} \mathbf{x}^{\top}\boldsymbol \beta(p) + 1 &gt; 0\)</span>.</p>
<p>The ‘symmetric’ Aranda-Ordaz transformation is given by <span class="math display">\[\begin{equation}\label{eq:11}
\tag{11}
h_{AOs}\left(Y;\lambda_{p}\right) =
\begin{cases}
\dfrac{2}{\lambda_{p}} \quad \dfrac{Y^{\lambda_{p}} -
\left(1-Y\right)^{\lambda_{p}}}{Y^{\lambda_{p}}  +
\left(1-Y\right)^{\lambda_{p}}}&amp; \text{if  $\lambda_{p} \neq
0$},\\[.5cm]
\log\left(\dfrac{Y}{1-Y}\right) &amp; \text{if $\lambda_{p} =
0$}.
\end{cases}
\end{equation}\]</span> (The symmetry here is that <span class="math inline">\(h_{AOs}(\theta;\lambda_p) = -h_{AOs}(1-\theta;\lambda_p)=h_{AOs}(\theta;-\lambda_p)\)</span>.) There is a range problem with this transformation too since, for all <span class="math inline">\(\lambda_p \neq 0\)</span>, the range of <span class="math inline">\(h_{AOs}\)</span> is not <span class="math inline">\(\mathbb{R}\)</span>, but <span class="math inline">\((-2/|\lambda_{p}|, 2/|\lambda_{p}|)\)</span>. The ‘asymmetric’ Aranda-Ordaz transformation is given by <span class="math display">\[\begin{equation}\label{eq:12}
\tag{12}
h_{AOa}\left(Y;\lambda_{p}\right) =
\begin{cases}
\log \left\{\dfrac{\left(1-Y\right)^{-\lambda_{p}} -
1}{\lambda_{p}} \right\}&amp; \text{if $\lambda_{p} \neq 0$},\\[.5cm]
\log \left\{-\log\left(1 - Y\right)\right\} &amp; \text{if
$\lambda_{p} = 0$}.
\end{cases}
\end{equation}\]</span> For <span class="math inline">\(\lambda_{p} = 0\)</span>, this is equivalent to the complementary log-log. The asymmetric Aranda-Ordaz transformation does have range <span class="math inline">\(\mathbb{R}\)</span>. Note that <span class="math inline">\(h_{AOa}(Y;1) = \log (Y/(1-Y))\)</span>, i.e. the transformation is symmetric.</p>
<p>To overcome range problems, which give rise to computational difficulties, <span class="citation">Geraci and Jones (2015)</span> proposed to use instead one-parameter transformations with range <span class="math inline">\(\mathbb{R}\)</span>. Proposal I is written in terms of the variable (say) <span class="math inline">\(W\)</span>, where <span class="math display">\[\begin{equation}\label{eq:13}
\tag{13}
h_I\left(W;\lambda_{p}\right) =
\begin{cases}
\dfrac{1}{2\lambda_{p}}\left(W^{\lambda_{p}} -
\dfrac{1}{W^{\lambda_{p}}}\right)&amp; \text{if $\lambda_{p} \neq
0$}\\[.5cm]
\log W &amp; \text{if $\lambda_{p} = 0$},
\end{cases}
\end{equation}\]</span> which takes on four forms depending on the relationship of <span class="math inline">\(W\)</span> to <span class="math inline">\(Y\)</span>, as described in Table 2. For each of domains <span class="math inline">\((0,\infty)\)</span> and <span class="math inline">\((0,1)\)</span>, there are symmetric and asymmetric forms.</p>
<table>
<tr>
<td>
Support of <span class="math inline">\(Y\)</span>
</td>
<td>
Symmetric
</td>
<td>
Asymmetric
</td>
</tr>
<tr>
<td>
<span class="math inline">\((0,\infty)\)</span>
</td>
<td>
<span class="math inline">\(W= Y\)</span>
</td>
<td>
<span class="math inline">\(W= \log(1+Y)\)</span>
</td>
</tr>
<td>
</td>
<td>
<span class="math inline">\(h_{Is}(Y;\lambda_p)\)</span>
</td>
<td>
<span class="math inline">\(h_{Ia}(Y;\lambda_p)\)</span>
</td>
</tr>
<td>
<span class="math inline">\((0,1)\)</span>
</td>
<td>
<span class="math inline">\(W= Y/(1-Y)\)</span>
</td>
<td>
<span class="math inline">\(W= -\log(1-Y)\)</span>
</td>
</tr>
<td>
</td>
<td>
<span class="math inline">\(h_{Is}(Y;\lambda_p)\)</span>
</td>
<td>
<span class="math inline">\(h_{Ia}(Y;\lambda_p)\)</span>
</td>
Table 2: Choices of <span class="math inline">\(W\)</span> and corresponding notation for transformations based on (13).
</table>
<p>Since the transformation in (13) has range <span class="math inline">\(\mathbb{R}\)</span> for all <span class="math inline">\(\lambda_{p}\)</span>, it admits an explicit inverse transformation. In addition, in the case of a single covariate, every estimated quantile that results will be monotone increasing, decreasing or constant, although different estimated quantiles can have different shapes from this collection. <span class="citation">Geraci and Jones (2015)</span> also proposed a transformation that unifies the symmetric and asymmetric versions of <span class="math inline">\(h_{I}\)</span> into a single two-parameter transformation, namely <span class="math display">\[\begin{equation}\label{eq:14}
\tag{14}
h_{II}(W;\lambda_p) = h_I(W_{\delta_p};\lambda_p),
\end{equation}\]</span> where <span class="math inline">\(h_I\)</span> is given in (13) and <span class="math display">\[\begin{equation*}
W_{\delta_{p}} = h_{BC}(1+W;\delta_p) =
\begin{cases}
 \dfrac{(1+W)^{\delta_{p}} - 1}{\delta_{p}} &amp; \text{if $\delta_{p} &gt; 0$}\\[.5cm]
\log (1+W) &amp; \text{if $\delta_{p} = 0$},
\end{cases}
\end{equation*}\]</span> with <span class="math inline">\(W=Y\)</span>, if <span class="math inline">\(Y &gt; 0\)</span>, and <span class="math inline">\(W=Y/(1-Y)\)</span>, if <span class="math inline">\(Y \in (0,1)\)</span>. The additional parameter <span class="math inline">\(\delta_{p}\)</span> controls the asymmetry: symmetric forms of <span class="math inline">\(h_{I}\)</span> correspond to <span class="math inline">\(\delta_p = 1\)</span> while asymmetric forms of <span class="math inline">\(h_{I}\)</span> to <span class="math inline">\(\delta_p = 0\)</span>.</p>
<p>All transformation models discussed above can be fitted using a two-stage (TS) estimator <span class="citation">(Chamberlain 1994; Buchinsky 1995)</span> whereby <span class="math inline">\(\boldsymbol \beta(p)\)</span> is estimated conditionally on a fine grid of values for the transformation parameter(s). Alternatively, point estimation can be approached using the RC process <span class="citation">(Mu and He 2007)</span>, which is akin to the process that leads to the RC test introduced in the previous section. The RC estimator avoids the troublesome inversion of the Box-Cox and Aranda-Ordaz transformations, but it is computationally more intensive than the TS estimator.</p>
<p>There are several methods for interval estimation, including those based on large-<span class="math inline">\(n\)</span> approximations and the ubiquitous bootstrap. Both the TS and RC estimators have an asymptotic normal distribution. The large-sample properties of the TS estimator for monotonic quantile regression models have been studied by <span class="citation">Powell (1991)</span> (see also <span class="citation">Chamberlain (1994)</span>;<span class="citation">Machado and Mata (2000)</span>). Under regularity conditions, it can be shown that the TS estimator is unbiased and will converge to a normal distribution with a sandwich-type limiting covariance matrix which is easy to calculate. In contrast, the form of the covariance matrix of the sampling distribution for the RC estimator is rather complicated and its estimation requires resampling <span class="citation">(Mu and He 2007)</span>. Finally, if the transformation parameter is assumed to be known, then conditional inference is apposite. In this case, the estimation procedures simplify to those for standard quantile regression problems.</p>
<p>In <strong>Qtools</strong>, model fitting for one-parameter transformation models can be carried out using the function <tt>tsrq</tt>. The <tt>formula</tt> argument specifies the model for the linear predictor as in (7), while the argument <tt>tsf</tt> provides the desired transformation <span class="math inline">\(h\)</span> as specified in Equations 10-13: <tt>bc</tt> for the Box–Cox model, <tt>ao</tt> for Aranda-Ordaz families, and <tt>mcjI</tt> for proposal I transformations. Additional arguments in the function <tt>tsrq</tt> include</p>
<ul>
<li><tt>symmetry</tt>, a logical flag to specify the symmetric or asymmetric version of <tt>ao</tt> and <tt>mcjI</tt>;</li>
<li><tt>dbounded</tt>, a logical flag to specify whether the response variable is doubly bounded (default is strictly positive, i.e. singly bounded);</li>
<li><tt>lambda</tt>, a numerical vector to define the grid of values for estimating <span class="math inline">\(\lambda_p\)</span>; and <tt>conditional</tt>, a logical flag indicating whether <span class="math inline">\(\lambda_{p}\)</span> is assumed to be known (in which case the argument <tt>lambda</tt> provides such known value). \end{itemize}</li>
</ul>
<p>There are other functions to fit transformation models. The function <tt>rcrq</tt> fits one-parameter transformation models using the RC estimator. The functions <tt>tsrq2</tt> and <tt>nlrq2</tt> are specific to Geraci and Jones’s (2015) Proposal II transformations. The former employs a two-way grid search while the latter is based on Nelder-Mead optimization as implemented in <tt>optim</tt>. Simulation studies in <span class="citation">Geraci and Jones (2015)</span> suggest that, although computationally slower, a two grid search is numerically more stable than the derivative-free approach.</p>
<p>A summary of the basic differences between all fitting functions is given in Table 3. The table also shows the available methods in <tt>summary.rqt</tt> to estimate standard errors and confidence intervals for the model’s parameters. Unconditional inference is carried out jointly on <span class="math inline">\(\boldsymbol \beta(p)\)</span> and the transformation parameter by means of bootstrap using the package <strong>boot</strong> <span class="citation">(Canty and Ripley 2014; Davison and Hinkley 1997)</span>. Large-<span class="math inline">\(n\)</span> approximations <span class="citation">(Powell 1991; Chamberlain 1994; Machado and Mata 2000)</span> are also available for the one-parameter TS estimator under <em>iid</em> or <em>nid</em> assumptions.</p>
<p>When <tt>summary.rqt</tt> is executed with the argument <tt>conditional = TRUE</tt>, confidence interval estimation for <span class="math inline">\(\boldsymbol \beta_{p}\)</span> is performed with one of the several methods developed for linear quantile regression estimators  (see options <tt>rank</tt>, <tt>iid</tt>, <tt>nid</tt>, <tt>ker</tt>, and <tt>boot</tt> in <tt>quantreg::summary.rq</tt>).</p>
<table>
<tr>
<td>
Function name
<td>
<td>
Transformation parameters
<td>
<td>
Estimation
<td>
<td>
Standard errors or confidence intervals
<td>
<td>
<td>
<tr>
<td>
<td>
<td>
<td>
<td>
<td>
<td>
Unconditional
<td>
<td>
Conditional
<td>
</tr>
<td>
<tt>tsrq</tt>
<td>
<td>
1
<td>
<td>
Two-stage
<td>
<td>
<tt>iid</tt>, <tt>nid</tt>, <tt>boot</tt>
<td>
<td>
All types
<td>
</tr>
<td>
<tt>rcrq</tt>
<td>
<td>
1
<td>
<td>
Residual cusum process
<td>
<td>
<tt>boot</tt>
<td>
<td>
All types
<td>
</tr>
<td>
<tt>tsrq2</tt>
<td>
<td>
2
<td>
<td>
Two-stage
<td>
<td>
<tt>boot</tt>
<td>
<td>
All types
<td>
</tr>
<td>
<tt>nlrq2</tt>
<td>
<td>
2
<td>
<td>
Nelder–Mead
<td>
<td>
<tt>boot</tt>
<td>
<td>
–
<td>
Table 3: Transformation-based quantile regression in package <strong>Qtools</strong>. ‘All types’ consists of options <tt>rank</tt>, <tt>iid</tt>, <tt>nid</tt>, <tt>ker</tt>, and <tt>boot</tt> as provided by function <tt>summary</tt> in package <strong>quantreg</strong>.
</table>
<p>In the New York Air Quality data example, a linear model was found unsuitable to describe the relationship between ozone and solar radiation. At closer inspection, Figure 4 reveals that the conditional distribution of ozone may in fact be nonlinearly associated with solar radiation, at least for some of the conditional quantiles. The model <span class="math display">\[\begin{equation}\label{eq:15}
\tag{15}
Q_{h_{Is}\{\text{ozone}\}}(p) = \beta_{0}(p) + \beta_{1}(p) \cdot \text{Solar.R},
\end{equation}\]</span> where <span class="math inline">\(h_{Is}\)</span> denotes the symmetric version of (13) for a singly bounded response variable, is fitted for the quantiles <span class="math inline">\(p \in \{0.1,0.5,0.9\}\)</span> using the following code:</p>
<pre><code>&gt; system.time(fit.rqt &lt;- tsrq(Ozone ~ Solar.R, data = dd, tsf = &quot;mcjI&quot;,
+    symm = TRUE, dbounded = FALSE, lambda = seq(1, 3, by = 0.005),
+    conditional = FALSE, tau = c(.1, .5, .9)))
   user  system elapsed
    0.5     0.0     0.5
&gt; fit.rqt

call:
tsrq(formula = Ozone ~ Solar.R, data = dd, tsf = &quot;mcjI&quot;, symm = TRUE,
    dbounded = FALSE, lambda = seq(1, 3, by = 0.005), conditional = FALSE,
    tau = c(0.1, 0.5, 0.9))

Proposal I symmetric transformation (singly bounded response)

Optimal transformation parameter:
tau = 0.1 tau = 0.5 tau = 0.9
    2.210     2.475     1.500

Coefficients linear model (transformed scale):
             tau = 0.1  tau = 0.5 tau = 0.9
(Intercept) -3.3357578 -48.737341 16.557327
Solar.R      0.4169697   6.092168  1.443407

Degrees of freedom: 111 total; 109 residual</code></pre>
<p>The TS estimator makes a search for <span class="math inline">\(\lambda_{p}\)</span> over the grid <span class="math inline">\(1.000, 1.005, \ldots, 2.995, 3.000\)</span>. The choice of the search interval usually results from a compromise between accuracy and performance: the coarser the grid, the faster the computation but the less accurate the estimate. A reasonable approach would be to start with a coarse, wide-ranging grid (e.g. <tt>seq(-5, 5, by = 0.5)</tt>), then center the interval about the resulting estimate using a finer grid, and re-fit the model.</p>
<p>The output above reports the estimates <span class="math inline">\(\boldsymbol{\hat{\beta}}(p)\)</span> and <span class="math inline">\(\hat{\lambda}_p\)</span> for each quantile level specified in <tt>tau</tt>. Here, the quantities of interest are the predictions on the ozone scale and the marginal effect of solar radiation, which can obtained using the function <tt>predict.rqt</tt>.</p>
<pre><code>&gt; x &lt;- seq(9, 334, length = 200)
&gt; qhat &lt;- predict(fit.rqt, newdata = data.frame(Solar.R = x),
+    type = &quot;response&quot;)
&gt; dqhat &lt;- predict(fit.rqt, newdata = data.frame(Solar.R = x),
+    type = &quot;maref&quot;, namevec = &quot;Solar.R&quot;)
The linear component of the marginal effect is calculated as derivative of
 Ozone ~ beta1 * Solar.R
 with respect to Solar.R</code></pre>
<p>The calculations above are based on a sequence of 200 ozone values in the interval <span class="math inline">\([9,334]\)</span> Ly, as provided via the argument <tt>newdata</tt> (if this argument is missing, the function returns the fitted values). There are three types of predictions available:</p>
<ol style="list-style-type: decimal">
<li><tt>link</tt>—predictions of conditional quantiles on the transformed scale (7), i.e. <span class="math display">\[\hat{Q}_{h\left(Y;\hat{\lambda}_{p}\right)}(p) = \mathbf{x}^{T}\hat{\boldsymbol{\beta}}(p);\]</span></li>
<li><tt>response</tt>—predictions of conditional quantiles on the original scale (8), i.e. <span class="math display">\[\hat{Q}_{Y|X}(p) = h^{-1}\left\{\mathbf{x}^{\top}\hat{\boldsymbol{\beta}}(p); \hat{\lambda}_{p}\right\};\]</span> and</li>
<li><tt>maref</tt>—predictions of the marginal effect (9).</li>
</ol>
<p>In the latter case, the argument <tt>namevec</tt> is used to specify the name of the covariate with respect to which the marginal effect has to be calculated. The function <tt>maref.rqt</tt> computes derivatives symbolically using the <strong>stats</strong> function <tt>deriv</tt> and these are subsequently evaluated numerically. While the nonlinear component of the marginal effect in Equation 9 (i.e. <span class="math inline">\(\partial Q(p)/\partial \eta(p)\)</span>) is rather straightforward to derive for any of the transformations (10)-(13), the derivative of the linear predictor (i.e. <span class="math inline">\(\partial \eta(p)/\partial x_{j}\)</span>) requires parsing the <tt>formula</tt> argument in order to obtain an expression suitable for <tt>deriv</tt>. The function <tt>maref.rqt</tt> can handle simple expressions with common functions like <tt>log</tt>, <tt>exp</tt>, etc., interaction terms, and `as is’ terms (i.e. <tt>I()</tt>). However, using functions that are not recognised by <tt>deriv</tt> will trigger an error.</p>
<div class="figure">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAkAAAAEgCAMAAABrWDzDAAAAjVBMVEUAAAAAADoAAGYAOmYAOpAAZrY6AAA6ADo6AGY6OmY6OpA6ZrY6kNtmAABmADpmAGZmOgBmOpBmZmZmZrZmtrZmtv+QOgCQOjqQOmaQZgCQkDqQtpCQ27aQ29uQ2/+zs7O2ZgC2Zjq2Zma225C2/7a2///bkDrb25Db/7bb////tmb/25D//7b//9v///9lQ8UdAAAACXBIWXMAAA7DAAAOwwHHb6hkAAATnklEQVR4nO2dCWPcthGFacdyXEfK1a6cHhE3bazWWon//+d1CQIkAOI+iCH3PVsXFySw2I+DGVzsBgjKUNe6ANC+BYCgLAEgKEsACMoSAIKyBICgLAEgKEsACMoSAIKyBICgLAEgKEsACMoSAIKyBICgLAEgKEsACMoSAIKyRBug53v+y+Xzt6YFIapr/ZxP4y/t6oc0QFK1zChBi8b6mQBqVz+kARor5/Kx664/Xn/62ro09DTWz/nXtvVDGaCxUl5/fBoun74O4k6DFjFozh++Na0fygCJFoxVFNqwlVj9MCt0alc/lAF6+TACdO669wDIJFY/fzwBIJvGO+z14TQ1YQBoJWGB3h4BkFFj0zXCc/n+CT6QQZMPdNfWR6QM0GSau+67n0+IwkziUdi7J0RhZqEfyC0K9UMaIPREe0SgfmgDBJEXAIKyBICgLAEgKEsACMoSAIKyBICgLAEgKEsACMoSAIKyBICgLBUGqNuNyr7v262f0gCVvVw9tQKoTbbxAkAeASC3bgmgvu/jTwJAbt0QQD3/ihMAcut2AOql7xECQG4BII+aArQDjACQRwDIrdsBaI8+EADa6nJBohSFseX8D133wTLHHQBte7l6qgcQW6F1+cGV7Q5qCQB5VA8gtsLGts7vePUDgIrq9eHd7799ta/TOl79AKDCenvs7oaX95aFxsern9h3NG4Y1k0brpS4XDMhCnOrFkBsJ5FBbN2Tfbl2AkBu1QJIOIe34ySmSasfbZrNDmoJFsgjWCC3qvlAYy8ZfKDMbHdQS4jCPMJovFsAyCMA5FZNJ9o/1rMDVetI5M6ypY0/Xv3EAxQw1rMD1Sro26Nzr7mb94EsYz3xq0Faq1pBx631fdnuoJaqAXRzYz01st1BLdVzom9trKdGtjuoJURhHgEgtwCQRwjj3QJAHgEgtwCQRwDIrXpR2K11lNXIdge1VM0CBXWU7UAAyK16TVhIR9kOBIDcgg/kEQBy64YBCltnCIDcul2AAlc6Iwpz62YBCt1rAQC5BYA8AkBuASCP4AO5dbMA7cIHal9LXt0uQIjCiuiGAQpTWx+IfjUBILPmObcAyC0AZFJn/LVRCWgLAK2lzPhPKOi0kMC2K0BgGTLO3VQAaKXO8VeA5okstiVxCYUgrFsEyBV+rdYbJVugPMEH2vZyMYrb7hdOtFu3B5C9C9q43DGloC/daXh+55oO5RUA2vZyEbICZC5SShPGptJdPhVwogHQRpfzSPZ6zABZy5NQ0GlzLdvWWmE6NkAvLMo4bZJvCalej8kHshcnpaAsELOtyQ0TfXK4EgB66e7GH2+POQhtWUG6zdGjMGdZ0JHoVjxAr7/Mpvnf6TfZpgAxYqyBl7soAMitW/CBpjbLApBvo5mUgl6N84f/OReleHVsH+haQd3UjtXPN1+9o+fHX4wkJ/r+8vkbnGhrwmnN4PNeuup70YgllSKtJ/oKUJGxsGMCtJvBwgkbW8dP2C5pyRaoyA12TICGM7NAWW3YFjXTa19qAQJLkOgDZY6lHhkg37YJhfNN12J51g1YePbxo/FhlvnmHkazvyhsBmhtgSJyTwDozwCEbu9RELHvqP0dJgBa+UBReccX9BxioW/vYTSRYTyFO4xbHg2gyB2G21og+hxlhPFOgkjcYaYoLDbjSgAFPozmmACFhPEULJDQQlHC/uaVmrDAbI8J0GR8PGE8pcc98SgsKU9MaXUryQIVCOS3r5nEpytULqjnURDHBGjTfItlmJhj28FU+jpwGF8mu7aDqfR15DC+SG5tB1Ppa+MwvsXjnix59bYheu3s+AwxmOpJSDOMt83YsPHD//lUaTA1cCP2YwJEMoyPWy44zzLznlLrIwzbiP2YAFEM4y2LdazZNAcobCP2YwK0ab6BMgHkyqM9QEHZHhGg17/OxwitylAAmtwht6Ne0wcqIPrkcCVYIJrrwiQfaPrVl0O9KKyEjgxQ0MrU7R/3NOMwWZ/e8mqs4kfj9zJjs4yq+UDtHvdkcociYzRJ8IHcqudEN3vcU8+cHwWX0F3FDQJAbh0lCpOu3K3NzcYAPWM+UEbCJpfj4lMQVw7PtgBdbe/LXZllTwBoo8tN6pn5Mfk7Zq5ClDaYOv2PP1XP9qAAEZ3v0rOLmq1NL8+PjlHKYOqXp+v/IjuU0VfiaDzF+S6841AFaLE6ic1YSkGv7Lx0nTMKrZFtEyWOxhOc79IpiCh9iuvjMZdtokMDVHC+SzHNrVcvdzGvkbIAZHePEMa7lT4jscjmAaXELzdtRcY12K2RLsdLKQV9QRifkbDB5ZSLMRD4nnY2f2hQj7iMU0oU9pC1/6icLQDa4HLaqPs8TWOkwx15qXu/lAOo3Low+gRlDKYSGSzUZ20IgPg/R9+Psn1HQYCm/ZPydGiACproGmLGZ5DbMHvCwbEF1aSkJozSDVZZiWH8dvl6LrO+Dveg5ymHdhMkGR6qURh9JTVhBU108YuIPV362Zm2m6GQvmkA5FZaE0bDRNv4kZolT+/hjJkdo/hpLD/9WbB+yIO03yjMPOVZa5aCup+dhqixBQJAlS5nO18jJgQgdxoA5NZee6Kt52vmJMDNKQ6QmBWd04YdGqD2O9W7ztYcGv8koPIWiO+jnTNf4dAANd+pvnCtlvaBRP0E7ZVYLts22qEFWnvPyWt2As5PmVDG6+e/n/MtEHnt1QeSJQ1nmUjQD8bhllTQcZ/Nu6wO+y498221tyjM1PU8fze2RfrByJmtjecDkUdobwAZ5B4T1Q+uEnkMEkbj3UrriR7b+BZOtLvvMAkgn0FK8YG+ZK03ULI9JkA//ePqAFUDyGoSbPbcOa3HAIy8vsfb09h6NJ46QYlh/OVTmXVPBllNguMUaczL7wP18xjZUAegEloAIk5Qaj/Q68Pf6gBk+0SDChoShanPcCYPEHUTlN6ReK4zGm/5RMtVo2G0rLAPFLI2froJ7Z0hxLFZRC4KCxo/z9HKKSofhQWsjRdrny8/+LMlDVPyfKAs+xPpA5X1A+I6gtLCeO/a+GlxZsDjsLq0MmymBIBe3o1R6uWju581/VEHukko7kZGdUWnhfHetfGvD+9+/220QJbhjgNHYaKXw/bWeapSG43njnPlKuUDDFob//bY3Q0v3husSy3ERooHyPcswrBUofmO2401JYhGFEaXIOIWaEpWjaAA80YDILrdQdV8oDKPOigP0LyJ2UBiVQaBh9HkiV4UJifqlnGuQq7QxMzy3UtQ9CfJ5rrUWLVCk6mN+4Gi7zBuJCLnYFiu1SvLfHxrfibFv+/nzL2lrNmSJKgWQAV6WnnztQw8pBCkjZv20qFaAA1TV7QHouBuDuJdihUBCu5p9aeIBEjdYaqXDvJF8/30WlUfyD3UEx5kKAWg5xtVBCispzUouziAeokR9XvPNw4SVq1WFHb2PQkiopujs71AQ9UACu1pteSmvR7jA61WxffyUTkKC1GSD+SfDB1mgYzjGLSsUD0nOrCnNfDViCisF42VClBM6OUsikeBUVhQN4dtIIwQQ+RG4/MlmxiFomUmkJ2fFahNOxLtmZNBiCJAmv8T2wPUy3MO1X2ie/WQ4dxhcpGWFEQBGqgwRBCgtf8cR5Cy0a983E+iMFbj+FsX8BnWU1jmBBgiB5DBe44kKOoUhbWpf7NTHhfVHiCnsW6O0A4Bklols02JMFpsKzzRM94p8ZqvoHXVLT9omyFiAK0qYw2QGl2ZCQp0mzg50rN3tdDNXtDaigCIpWs2/koMoLV0SnR2osc3eCvF5hlpD/+e9+eULtseoIjPqEFhSQFkPDh16ig2Igmgruv7Qb5RpT5p7aJkorD42WSbmyJKAFmzkE1CNEDCM+a9Q0t6YXzUzkX9egQASji726zglACySf1kA3ygyYQIz1i6iLykcDY2q0f7KC7ULgGazmUY1S4/HYDsGWimYWnTLM7y5BkbR9MU5jQARTbq4f0CNF+qaqtGBiDHe3RFYto1mM0xtkXzUIb0gr7oeTAMlpEAqEAhJnNUHiUqADkvb4/E5tN5P876KWHLSf2gAbTC0DR57SgASZfmKBW6WvGENS5nMBX8O/eQl+NrBJZr9IvHPNiS0QIocEgjNYsCLNEAKPLiEzqzn6wcFgSZwdCjMFNLSMkHqmKCjLmlNnG7BIiNPpg/ef75m8ZS5WcfOCdaE4rCmmQvseTnqTVAY7uS0FFmHA+ztUmr7aekpq7XU9kKurFaAqRJYslgohoDxPprbH2B2mc6D5Jb4zFr08XjK2WYol/BZ+4T8LyRSloBRIAkIcVzagsQ+wA7y72v+SLdMKyNjKGLSP65pFDN0NKYma+zKujmogyQovYAdYbZg+wvfkwxmx6ApKO9/LuyTkN0QupnkASIPEHtAZo/S60VYcZpOWju4jF+8MrBXlgcMY7Ryzw5ryMVdHMZuKFJUGsfqFP4UVojNuNiNhuD+rWeNb9IvVI/t1i9glC/OscYv9EBiKaaAnSFxDCWyV4WFoPbnVWEroMkS/OD5lU+UhvWr7Cz7dfRGiC5AM3nrxrUEiD101oYEZ08vWQypCRqYpNUFASCUvDlmgyrXZYSQBQRagiQHk1PH3Qnjg6i6TJ1+rkBUrp+lHViw2zYtPaqM6jnBW0h6q7PLAIASXHSHHBZmyzpT/vUZznmklwecW5vgGU+cTlL+PFN5ACIFlHtAVJbGKFevKS6NJyhfrFMFh9I6TI04WJe5Ly4VuLP5gBFzXzZXu19IOHmTB+rOkSh+7Rzk9TrlknWChht6It/rawcz1ZN3R6gqMl3m6txFCboGabNWFc4WKd89ZJ/M/S6C2M4VWmeBCbDsM5VujoRgIxlaLaOR1PrwdSBW5PFRbG7xhpABh9GSWY4dz48t5ArB13xzAYaAFkK0Vlf2VAUAOq7TgRH7G/HaTI1kpOzSmZyryWsZrdqfY3FLvU0ojD2l70UrQ1Re4DYVuLC8RDWSE8tuzOLo6svAvRIcrCk7zaAVgXdVHq2bkwM0yy2UnOAhBckOmZ4rzFLY26gVPsSuoxZvYL03ewDrQu6rQyhl78kLTiiBRDHYeYmxr5ESWNGnQag/EUFoCGitRIgbYFTc4B48M5bJrkP2OrhlFCw4SIE0JBgY7pB4an8u2kNUMf9Vd49rMzvqAlQsGoBlP44rJyWSudp+pl2reWKZRNGXY7bn8XqKFN1DgxQ9sNobF0YKerMXAXZrbYA9dLaHGF19JU3bfmpBVCpx2EN63HgEsUzlMZiuKoBFGKiJ4fZZWiSYqyiomqB7NKBqgtYLYBCKsg+gkFItXygMo/DSpEPsDBFFzTyHVlMtFIA42gmNdGKwuioq9yEBVqgga7p4QJAblXzgUJMNOWmS6jyJ3mTTywsly/hpksIFsit1h2J5AWA3AJAHhHsiSalZgDtRmXft5A3yNiNQt/xdsNw1I5Xka8nmmA1ZNYPACoqnwUiWA0AKPF4HXm6OQhWAwBKPN5I5KoBACUebyRy1QCAEo83ErlqAECJxxuJXDUAoMTjjUSuGgBQ4vFGIlcN5ACCbkoACMoSAIKyBICgLAEgKEsACMoSAIKyBICgLAEgKEsACMoSAIKyBICgLAEgKEsACMoSAIKyBICgLBUG6PWhW6+Iep7WuRhfW+vy6WvEKeNS4lNsFs10wOopC9C4ru75Tj96PtlfW+mFrakKPeX1x6fh8v1TXBbNdMTqKQvQuKKX3SKy3r48WV9b6fzun9c0wae8jPVxPkVl0U5HrJ6yAF0+f2PUK2KLNU/m10zX+PQ17pRrisgsWumI1VMWoHFJ+KqIow293gPG1wwaayjmlLfH+9gsWumI1bOBBWI6n2JusYhTXh/uo7NopSNWzwY+ENP5FNoCSzUUcMrl4yk+i1Y6YvWUjsLu137+aDnffvtqfM2g8S0Gn8IrKDKLVjpi9WzUD/TuyfLaWqKjI+iUZ7aZyikyi2Y6YPWgJxrKEgCCsgSAoCwBIChLAAjKEgCCsgSAoCwBIChLAAjKEgCCsgSAoCwBIChLAAjKEgCCsgSAoCwBIChLAAjKEgCCsgSAoCwBIChLAAjKEgCCsgSAoCwBIChLAAjKEgCCsgSAoCwBIChLAAjKEgCCsrQ5QON+fe/nTY58+x29PZ6WJNffzOmf7+Xj40Zc+9Xe6mdrgF4fxm2L511qAipo+cOW+FojykvP98Zku9Du6mdrgNg7GTfqu95p76cd16bNsC9/+Xm88dgPvj32Ncl3P5/mJOMZ/5n2KB3P/Px3lmhguybzCjqzrUjHrdz2qt3Vz9YAvT3yu+t8P+68dn1jbDPsq/GddmMbf/AjLEl3kpJMJpqf+ZH9GJSdB1/ux/98X+1danf1s70T/cK2Wxvf1fV98zd2/Yv/Jmzt9ciYZGnjpyRjbS1nTi+NbbpI9Mu3P5723YbtrX6aRGGX79n7e/syVdB5dBuVClqOnE9KEn6T8TOnxON9xs9++/KvX77tHKBhX/WzNUBs832+5ex0n4xu4xI/TBuxsyPLHbYk8dxhw/OvY93sGKDd1U+TKGxss+c2nm+9LlWQ2Ix9buOXJFIbP1eQvP3xeNqufaDd1U+TfiC+5SyPMp47EUwMyy621yPX20u8MB14e5SjjLmCWGzxcdzP9m7cDXmqsd1qb/VzhJ5oqWfs8sOw6xasiqrWzxEAWmrkebx3990TXUM16+cQAEHtBICgLAEgKEv/B7SuRnUOFTAwAAAAAElFTkSuQmCC" alt />
<p class="caption">Figure 5. Predicted 10th (solid line), 50th (dashed line), and 90th (dot-dashed line) centiles of ozone conditional on solar radiation (a) and corresponding estimated marginal effects (b) using the symmetric proposal I transformation in the New York Air Quality data set.</p>
</div>
<p>The predicted quantiles of ozone and the marginal effects of solar radiation are plotted in Figure 5 using the following code:</p>
<pre><code>&gt; par(mfrow = c(1, 2))
&gt; plot(Ozone ~ Solar.R, data = dd, xlab = &quot;Solar radiation (lang)&quot;,
+    ylab = &quot;Ozone (ppb)&quot;)
&gt; for(i in 1:3) lines(x, qhat[ ,i], lty = c(1, 2, 4)[i], lwd = 2)
&gt; plot(range(x), range(dqhat), type = &quot;n&quot;, xlab = &quot;Solar radiation (lang)&quot;,
+    ylab = &quot;Marginal effect&quot;)
&gt; for(i in 1:3) lines(x, dqhat[ ,i], lty = c(1, 2, 4)[i], lwd = 2)</code></pre>
<p>The effect of solar radiation on different quantiles of ozone levels shows a nonlinear behavior, especially at lower ranges of radiation (below <span class="math inline">\(50\)</span> Ly) and on the median ozone. It might be worth testing the goodness-of-fit of the model. In the previous analysis, it was found evidence of lack of fit for the linear specification (5). In contrast, the output reported below indicates that, in general, the goodness of fit of the quantile models based on the transformation model (15) has improved since the test statistics are now smaller at all values of <span class="math inline">\(p\)</span>. However, such improvement is not yet satisfactory for the median.</p>
<pre><code>&gt; GOFTest(fit.rqt, alpha = 0.05, B = 1000, seed = 416)

Goodness-of-fit test for quantile regression based on the cusum process
Quantile 0.1: Test statistic = 0.0393; p-value = 0.025
Quantile 0.5: Test statistic = 0.1465; p-value = 0.005
Quantile 0.9: Test statistic = 0.0212; p-value = 0.127</code></pre>
<p>The TS and RC estimators generally provide similar estimates and predictions. However, computation based on the cusum process tends to be somewhat slow, as shown further below. This is also true for the RC test provided by <tt>GOFTest</tt>.</p>
<pre><code>&gt; system.time(fit.rqt &lt;- rcrq(Ozone ~ Solar.R, data = dd, tsf = &quot;mcjI&quot;,
+    symm = TRUE, dbounded = FALSE, lambda = seq(1, 3, by = 0.005),
+    tau = c(.1, .5, .9)))
   user  system elapsed
  36.88    0.03   37.64</code></pre>
<p>An example using doubly bounded transformations is demonstrated using the A-level Chemistry Scores data set. The latter is available from <strong>Qtools</strong> and it consists of 31022 observations of A-level scores in Chemistry for England and Wales students, 1997. The data set also includes information of prior academic achievement as assessed with General Certificate of Secondary Education (GCSE) average scores. The goal is to evaluate the ability of GCSE to predict A-level scores. The latter are based on national exams in specific subjects (e.g. chemistry) with grades ranging from A to F. For practical purposes, scores are converted numerically as follows: A = 10, B = 8, C = 6, D = 4, E = 2, and F = 0. The response is therefore doubly bounded between 0 ad 10. It should be noted that this variable is discrete, although, for the sake of simplicity, here it is assumed that the underlying process is continuous.</p>
<p>The model considered here is <span class="math display">\[\begin{equation}\label{eq:16}
\tag{16}
Q_{h_{AOa}\{\text{score}\}}(p) = \beta_{0}(p) + \beta_{1}(p) \cdot \text{gcse},
\end{equation}\]</span> where <span class="math inline">\(h_{AOa}\)</span> denotes the asymmetric Aranda-Ordaz transformation in (12). This model is fitted for <span class="math inline">\(p = 0.9\)</span>:</p>
<pre><code>&gt; data(Chemistry)
&gt; fit.rqt &lt;- tsrq(score ~ gcse, data = Chemistry, tsf = &quot;ao&quot;, symm = FALSE,
+    lambda = seq(0,2,by=0.01), tau = 0.9)</code></pre>
<p>The predicted <span class="math inline">\(90\)</span>th centile of A-level scores conditional on GCSE and the marginal effect of GCSE are plotted in Figure 6. There is clearly a positive, nonlinear association between the two scores. The nonlinearity is partly explained by the floor and ceiling effects which result from the boundedness of the measurement scale. Note, however, that the S-shaped curve is not symmetric about the inflection point. As a consequence, the marginal effect is skewed to the left. Indeed, the estimate <span class="math inline">\(\hat{\lambda}_{0.9} = 0\)</span> and the narrow confidence interval give support to a complementary log-log transformation:</p>
<pre><code>&gt; summary(fit.rqt, conditional = FALSE, se = &quot;nid&quot;)

call:
summary.rqt(object = fit.rqt, se = &quot;nid&quot;, conditional = FALSE)

Aranda-Ordaz asymmetric transformation (doubly bounded response)

Summary for unconditional inference

tau =  0.9

Optimal transformation parameter:
       Value   Std. Error  Lower bound  Upper bound
 0.000000000  0.001364422 -0.002674218  0.002674218

Coefficients linear model (transformed scale):
                 Value  Std. Error Lower bound Upper bound
(Intercept) -4.3520060 0.015414540  -4.3822179  -4.3217941
gcse         0.8978072 0.002917142   0.8920898   0.9035247

Degrees of freedom: 31022 total; 31020 residual</code></pre>
<p>Alternatively, one can estimate the parameter <span class="math inline">\(\delta_{p}\)</span> using a two-parameter transformation:</p>
<pre><code>&gt; coef(tsrq2(score ~ gcse, data = chemsub, dbounded = TRUE,
+    lambda = seq(0, 2, by = 0.1), delta = seq(0, 2, by = 0.1),
+    tau = 0.9), all = TRUE)

(Intercept)        gcse      lambda       delta
 -4.1442274   0.8681246   0.0000000   0.0000000</code></pre>
<p>These results confirm the asymmetric nature of the relationship since <span class="math inline">\(\hat{\delta}_{0.9} = 0\)</span>. Similar results (not shown) were obtained with <tt>nlrq2</tt>.</p>
<p>In conclusion, the package <strong>Qtools</strong> offers several options in terms of transformations and estimation algorithms, the advantages and disadvantages of which are discussed by . In particular, they found that the symmetric Proposal I transformation improves considerably on the Box-Cox method and marginally on the Aranda-Ordaz transformation in terms of mean squared error of the predictions. Also, asymmetric transformations do not seem to improve sufficiently often on symmetric transformations to be especially recommendable. However, the Box-Cox and the symmetric Aranda-Ordaz transformations should not be used when individual out-of-range predictions represent a potential inconvenience as, for example, in multiple imputation (see section further below). Finally, in some situations transformation-based quantile regression may be competitive as compared to methods based on smoothing, as demonstrated by a recent application to anthropometric charts <span class="citation">(Boghossian et al. 2016)</span>.</p>
</div>
<div id="conditional-lss" class="section level2">
<h2>Conditional LSS</h2>
<p>Quantile-based measures of location, scale, and shape can be assessed <em>conditionally</em> on covariates. A simple approach is to a fit a linear model as in (4) or a transformation-based model as in (7), and then predict <span class="math inline">\(\hat{Q}_{Y|X}(p)\)</span> to obtain the conditional LSS measures in Equation 3 for specific values of <span class="math inline">\(\mathbf{x}\)</span>.</p>
<p>Estimation of conditional LSS can be carried out by using the function <tt>qlss.formula</tt>. The conditional model is specified in the argument <tt>formula</tt>, while the probability <span class="math inline">\(p\)</span> is given in <tt>probs</tt>. (As seen in Equation 3, the other probabilities of interest to obtain the decomposition of the conditional quantiles are <span class="math inline">\(1-p\)</span>, <span class="math inline">\(0.25\)</span>, <span class="math inline">\(0.5\)</span>, and <span class="math inline">\(0.75\)</span>.) The argument <tt>type</tt> specifies the required type of regression model, more specifically <tt>rq</tt> for linear models and <tt>rqt</tt> for transformation-based models. The function <tt>qlss.formula</tt> will take any additional argument to be passed to <tt>quantreg::rq</tt> or <tt>tsrq</tt> (e.g. <tt>subset</tt>, <tt>weights</tt>, etc.).</p>
<p>Let’s consider the New York Air Quality data example discussed in the previous section and assume that the transformation model (15) holds for the quantiles <span class="math inline">\(p \in \{0.05, 0.1, 0.25, 0.5, 0.75,\)</span> <span class="math inline">\(0.9, 0.95\}\)</span>. Then the conditional LSS summary of the distribution of ozone conditional on solar radiation for <span class="math inline">\(p = 0.05\)</span> and <span class="math inline">\(p = 0.1\)</span> is calculated as follows:</p>
<pre><code>&gt; fit.qlss &lt;- qlss(formula = Ozone ~ Solar.R, data = airquality, type =
+    &quot;rqt&quot;, tsf = &quot;mcjI&quot;, symm = TRUE, dbounded = FALSE,  lambda =
+    seq(1, 3, by = 0.005), probs = c(0.05, 0.1))
&gt; fit.qlss

call:
qlss.formula(formula = Ozone ~ Solar.R, probs = c(0.05, 0.1),
    data = airquality, type = &quot;rqt&quot;, tsf = &quot;mcjI&quot;, symm = TRUE,
    dbounded = FALSE, lambda = seq(1, 3, by = 0.005))

Conditional Quantile-Based Location, Scale, and Shape
-- Values are averaged over observations --

** Location **
Median
[1] 30.2258
** Scale **
Inter-quartile range (IQR)
[1] 43.40648
Inter-quantile range (IPR)
    0.05      0.1
88.02909 73.93430
**Shape**
Skewness index
     0.05       0.1
0.5497365 0.5180108
Shape index
    0.05      0.1
1.960315 1.661648</code></pre>
<p>The output, which is of class <tt>“qlss”</tt>, is a named list with the same LSS measures seen in the case of unconditional quantiles. However, these are now conditional on solar radiation. By default, the predictions are the fitted values, which are averaged over observations for printing purposes. An optional data frame for predictions can be given via the argument <tt>newdata</tt> in <tt>predict.qlss</tt>. If <tt>interval = TRUE</tt>, the latter computes confidence intervals at the specified <tt>level</tt> using <tt>R</tt> bootstrap replications (it is, therefore, advisable to set the seed before calling <tt>predict.qlss</tt>). The conditional LSS measures can be conveniently plotted using the <tt>plot.qlss</tt> function as shown in the code below. The argument <tt>z</tt> is required and specifies the covariate used for plotting. Finally, the argument <tt>whichp</tt> specifies one probability (and one only) among those given in <tt>probs</tt> that should be used for plotting (e.g. <span class="math inline">\(p = 0.1\)</span> in the following example).</p>
<pre><code>&gt; set.seed(567)
&gt; x &lt;- seq(9, 334, length = 200)
&gt; qhat &lt;- predict(fit.qlss, newdata = data.frame(Solar.R = x),
+    interval = TRUE, level = 0.90, R = 500)
&gt; plot(qhat, z = x, whichp = 0.1, interval = TRUE, type = &quot;l&quot;,
+    xlab = &quot;Solar radiation (lang)&quot;, lwd = 2)</code></pre>
<p>Figure 7 shows that both the median and the IQR of ozone increase nonlinearly with increasing solar radiation. The distribution of ozone is skewed to the right and the degree of asymmetry is highest at low values of solar radiation. This is due to the extreme curvature of the median which takes on values close to the 10th centile (Figure 5). (Recall that the index approaches 1 when <span class="math inline">\(Q(p) \approx Q(0.5)\)</span>.) However, the sparsity of observations at the lower end of the observed range of solar radiation determines substantial uncertainty as reflected by the wider confidence interval (Figure 7). At <span class="math inline">\(p = 0.1\)</span>, the conditional shape index is on average equal to <span class="math inline">\(1.66\)</span> and it increases monotonically from <span class="math inline">\(1.32\)</span> to about <span class="math inline">\(1.85\)</span>, remaining always below the tail-weight threshold of a normal distribution (<span class="math inline">\(1.90\)</span>).</p>
<div class="figure">
<img src="data:image/png;base64,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" alt />
<p class="caption">Figure 7. Location, scale and shape of ozone levels conditional on solar radiation in the New York Air Quality data set. Dashed lines denote the bootstrapped <span class="math inline">\(90%\)</span> point-wise confidence intervals.</p>
</div>
</div>
</div>
<div id="other-functions-in-qtools" class="section level1">
<h1>Other functions in <strong>Qtools</strong></h1>
<div id="restricted-quantile-regression" class="section level2">
<h2>Restricted quantile regression</h2>
<p>Besides a loss of precision, high sparsity (low density) might also lead to a violation of the basic property of monotonicity of quantile functions. Quantile crossing occurs when <span class="math inline">\(\mathbf{x}_{i}^{\top}\hat{\boldsymbol \beta}(p) &gt; \mathbf{x}_{i}^{\top}\hat{\boldsymbol \beta}(p&#39;)\)</span> for some <span class="math inline">\(\mathbf{x}_{i}\)</span> and <span class="math inline">\(p &lt; p&#39;\)</span>. This problem typically occurs in the outlying regions of the design space <span class="citation">(Koenker 2005)</span> where also sparsity occurs more frequently. Balanced designs with larger sample sizes would then offer some assurance against quantile crossing, provided, of course, that the QR models are correctly specified. Model’s misspecification, indeed, can still be a cause of crossing of the quantile curves. Restricted regression quantiles (RRQ) <span class="citation">(He 1997)</span> might offer a practical solution when little can be done in terms of modelling. This approach applies to a subclass of linear models <span class="math display">\[
Y = \mathbf{x}^{\top}\beta + \epsilon
\]</span> and linear heteroscedastic models <span class="math display">\[
Y = \mathbf{x}^{\top}\beta + (\mathbf{x}^{\top}\gamma)\,\epsilon,
\]</span> where <span class="math inline">\(\mathbf{x}^{\top}\gamma &gt; 0\)</span> and <span class="math inline">\(\epsilon \sim F\)</span>. Basically, it consists in fitting a reduced regression model passing through the origin. The reader is referred to  for details. Here, it is worth stressing that when the restriction does not hold, i.e. if the model is more complex than a location–scale-shift model, then RRQ may yield unsatisfactory results . See also  for an examination of the asymptotic properties of the restricted QR estimator. In particular, the relative efficiency of RRQ as compared to RQ depends on the error distribution. For some common unimodal distributions,  showed that RRQ in <em>iid</em> models is more efficient than RQ. This property is lost when the error is asymmetric. In contrast, the efficiency of RRQ in heteroscedastic models is comparable to that of RQ even for small samples.</p>
<p>The package <strong>Qtools</strong> provides the functions <tt>rrq</tt>, <tt>rrq.fit</tt> and <tt>rrq.wfit</tt> which are, respectively, the ‘restricted’ analogous of <tt>rq</tt>, <tt>rq.fit</tt>, and <tt>rq.wfit</tt> in <strong>quantreg</strong>. S3 methods <tt>print</tt>, <tt>coef</tt>, <tt>predict</tt>, <tt>fitted</tt>, <tt>residuals</tt>, and <tt>summary</tt> are available for objects of class <tt>“rrq”</tt>. In particular, confidence intervals are obtained using the functions <tt>boot</tt> and <tt>boot.ci</tt> from package <strong>boot</strong>. Future versions of the package will develop the function <tt>summary.rrq</tt> to include asymptotic standard errors <span class="citation">(Zhao 2000)</span>. An application is shown below using an example discussed by . The data set, available from <strong>Qtools</strong>, consists of <span class="math inline">\(118\)</span> measurements of esterase concentrations and number of bindings counted in binding experiments.</p>
<pre><code>&gt; data(&quot;esterase&quot;)
&gt; taus &lt;- c(.1, .25, .5, .75, .9)
&gt; fit.rq &lt;- rq(Count ~ Esterase, data = esterase, tau = taus)
&gt; yhat1 &lt;- fitted(fit.rq)
&gt; fit.rrq &lt;- rrq(Count ~ Esterase, data = esterase, tau = taus)
&gt; yhat2 &lt;- fitted(fit.rrq)</code></pre>
<p>The predicted 90th centile curve crosses the 50th and 75th curves at lower esterase concentrations (Figure 8). The crossing is removed in predictions based on RRQs.</p>
<div class="figure">
<img src="data:image/png;base64,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" alt />
<p class="caption">Figure 8. Predicted quantiles of number of bindings conditional on esterase concentration using regression quantiles (a) and restricted regression quantiles (b) in the Esterase data set.</p>
</div>
<p>As discussed above, the reliability of the results depends on the validity of the restriction carried by RRQ. A quick check can be performed using the location–scale-shift specification of the Khmaladze test.</p>
<pre><code>&gt; kt &lt;- KhmaladzeTest(formula = Count ~ Esterase, data = esterase,
+ taus = seq(.05,.95,by = .01), nullH = &quot;location-scale&quot;)
&gt; KhmaladzeFormat(kt, 0.05)

Khmaladze test for the location-shift hypothesis
Joint test is not significant at 10% level
Test(s) for individual slopes:
 not significant at 10% level</code></pre>
<p>The quantile crossing problem can be approached also by directly rearranging the fitted values <span class="math inline">\(\hat{Q}_{Y|X = \mathbf{x}}(p)\)</span> to obtain monotone (in <span class="math inline">\(p\)</span>) predictions for each <span class="math inline">\(\mathbf{x}\)</span> <span class="citation">(Chernozhukov, Fernandez-Val, and Galichon 2010)</span>. This method is implemented in the package <strong>Rearrangement</strong> <span class="citation">(Graybill et al. 2016)</span>. As compared to RRQ, this approach is more general as it is not confined to, for example, location–scale-shift models <span class="citation">(Chernozhukov, Fernandez-Val, and Galichon 2010)</span>; however, in contrast to RRQ, it does not yield estimates of parameters (e.g. slopes) of the model underlying the final monotonised curves. Such estimates, available from <tt>rrq</tt> objects, may be of practical utility when summarising the results.</p>
</div>
<div id="conditional-quantiles-of-discrete-data" class="section level2">
<h2>Conditional quantiles of discrete data</h2>
<p>Modeling discrete response variables, such as categorical and count responses, has been traditionally approached with distribution-based methods: a parametric model <span class="math inline">\(F_{Y|X}(y;\theta)\)</span> is assumed and then fitted by means of MLE. Binomial, negative binomial, multinomial and Poisson regressions are well-known in many applied sciences. Because of the computational advantages and the asymptotic properties of MLE, these methods have long ruled among competing alternatives.</p>
<p>Modeling conditional functions of discrete data is less common and, on a superficial level, might even appear as an unnecessary complication. However, a deeper look at its rationale will reveal that a distribution-free analysis can provide insightful information in the discrete case as it does in the continuous case. Indeed, methods for conditional quantiles of continuous distributions can be—and have been—adapted to discrete responses.</p>
<div id="jittering-for-count-responses" class="section level3">
<h3>Jittering for count responses</h3>
<p>Let <span class="math inline">\(Y\)</span> be a count variable such as, for example, the number of car accidents during a week or the number of visits of a patient to their doctor during a year. As usual, <span class="math inline">\(X\)</span> denotes a vector of covariates. Poisson regression, which belongs to the family of generalized linear models (GLMs), is a common choice for this kind of data, partly because of its availability in many statistical packages. Symbolically, <span class="math inline">\(Y \sim \textrm{Pois}(\theta)\)</span> where <span class="math display">\[
\theta \equiv \mathrm{E}(Y|X = \mathbf{x}) = h^{-1}\left(\mathbf{x}^{\top}\boldsymbol{\beta}\right)
\]</span> and <span class="math inline">\(h\)</span> is the logarithmic link function. Note that the variance also is equal to <span class="math inline">\(\theta\)</span>. Indeed, moments of order higher than <span class="math inline">\(2\)</span> governing the shape of the distribution depend on the same parameter. Every component of the conditional LSS in a Poisson model is therefore controlled by <span class="math inline">\(\theta\)</span>. If needed, more flexibility can be achieved using a distribution-free approach.</p>
<p><span class="citation">Machado and Santos Silva (2005)</span> proposed the model <span class="math display">\[\begin{equation}\label{eq:17}
\tag{17}
Q_{h\left(Z;p\right)}(p) = \mathbf{x}^{\top}\boldsymbol \beta(p),
\end{equation}\]</span> where <span class="math inline">\(Z = Y + U\)</span> is obtained by jittering <span class="math inline">\(Y\)</span> with a <span class="math inline">\([0,1)\)</span>-uniform noise <span class="math inline">\(U\)</span>, independent of <span class="math inline">\(Y\)</span> and <span class="math inline">\(X\)</span>. In principle, any monotone transformation <span class="math inline">\(h\)</span> can be considered. A natural choice for count data is a log-linear model , i.e. <span class="math display">\[\begin{equation*}
h\left(Z;p\right) =
\begin{cases}
 \log\left(Z - p\right) &amp; \text{for $Z &gt; p$}\\[.5cm]
 \log \zeta &amp; \text{for $Z \leq p$}.
\end{cases}
\end{equation*}\]</span> where <span class="math inline">\(0 &lt; \zeta &lt; p\)</span>. It follows that <span class="math inline">\(Q_{Z|X}(p) = p + \exp\left(\mathbf{x}^{\top}\boldsymbol \beta(p)\right)\)</span>. (Note that the <span class="math inline">\(p\)</span>th quantile of the conditional distribution of <span class="math inline">\(Z\)</span> is bounded below by <span class="math inline">\(p\)</span>.) Given the continuity between counts induced by jittering, standard inference for linear quantile functions <span class="citation">(Koenker and Bassett 1978)</span> can be applied to fit (17). In practice, a sample of <span class="math inline">\(M\)</span> jittered responses <span class="math inline">\(Z\)</span> is taken to estimate <span class="math inline">\(\hat{\boldsymbol \beta}_{m}(p)\)</span>, <span class="math inline">\(m = 1,\ldots,M\)</span>; the noise is then averaged out, <span class="math inline">\(\hat{\boldsymbol \beta}(p) = \frac{1}{M} \sum_{m} \hat{\boldsymbol \beta}_{m}(p)\)</span>.</p>
<div class="figure">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAYAAAAEgCAMAAACKBVRjAAAAclBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZrYAv8Q6AAA6ADo6AGY6OmY6OpA6kNtmAABmADpmAGZmOgBmtv+QOgCQOjqQOmaQZgCQtpCQ29uQ2/+2ZgC2tma2///bkDrb///4dm3/tmb/tpD/25D//7b//9v////QEO3PAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAQeUlEQVR4nO1dCXvjKBIlvTtReraT2XH3HvF2Wpkk/P+/uOY+BBKFwCXiet+M7Vhcfg8VRYFoxgmoYNgNuHWQAMggAZBBAiCDBEAGCYAMEgAZJAAySABkkADIIAGQQQIggwRABgmADBIAGSQAMkgAZJAAyCABkEECIIMEQAYJgAwSABkkADJIAGSQAMggAZBBAiCDBEAGCYAMEgAZJAAySABkkADIIAGQQQIggwRABgmADBIAGVAB3h6YwJefmeIGxzRVppnnWby4LzoJ8PH9JN9ff/vVorjDYZrq0lz4l6/2i14CvP/zZ/C+s7ijoRn/3QT4zHeAMC7bAiTTaP6vIAB/f5IWLjsGAIs7ENieG4BH/PcT4LrFXRGK/832lxkgEgAOJo3LVvtTBijFfz8BttxQYHHHAZOde1uA5XfOAF3BC/rEg3AL/skN3QExv3J/JadSWQO04J/uADBCbhlP/ZZy/skNBSMgl3mvmSQK3gBMXtAuLG+AxY9JGyCe5P/aAqzFoCrDYsVo8gOmIgEW2dIDcCJvHv3d0M43RSsBlqWW8J8eACDN6j8IjyDAktzFrZUwQCv8H8kNHUCAgiBcjn+e5p/uAAjKgqCLr7IDMKhZ/d3QEQSoSZKMQMCb1d8NPbwAdYsAawMApFkkQJ0B2uCfBCjHzgEgzT8JUIxaA8SXA7DvunZzQ5/0/DMzCg8nwA4PNLUEwPw/igBt/8f3R2BxkBrUPNvW8PZ7xtmqLH6JhgNAGL7oZ4Le/3iGFQcSQDC+XsOe4pdoOABfSwBwcf5XcxLuuhRATPYupu5i5MSfr8rc6Tf9/bd/M3Zq8APqB4DcEsyxBUjzHwvw9vWZnx/FZPvyp4h5vNxz/Wa+f3i0c/E9P6B2AODJGfB1xgB4cfAx4CT5vlgiIYCyR+bNfm/Hh30CVCRxY+8iAnoFL6iiOPAYoN8/fiiiH9jdM9dv/vf7BegyA9MYXACvp3Mb+bu8Nb0DqgxQIf+jC+DGAEH+5X/95r7fL0BX/ocXwHlBZ+X+nAMvqI0A8CSrSwABBhWgTY1FqBwAeGYArm7WrQpQaYD4yhJAXbNuVIC+AwCkWTcrADwJhH8SYB3d+R9XgBc5E9ZT4tzKc33xChUGaPaoL+B/WAHOF1///emkncyXzN6L6uIVKmLQUP6PKsCUhLuueNdTrV7rAXX8R6/NmnVVAdL8e7/19V682iBEnzsAHoOG839QATbxIgUQ4TY5BhTwD/8B3fgXj7nCm9VGgNXd0YBygjvg9a5kZQz6A+ADcCn/gbaD3gGC97+e376pMeClgxe0g39WwP/oCzLC6r8/sZNZm7yvqnEFu/o/W7P/0WOuowog5gFf/scetRf0sLoFA158N/tzaccUPGY5rAAtasyiI/885J8ESGG3/V+rS54iVNGsGxIAPgHzev68yX9ls25HgM78kwBbAE/AQv4BGUHNuhkB6vifK/knAWJsGqD4vKyQ/9XHkVNlkwAhtvmP7pEg/Dyv1pMsmwQIUMi/K2vBf76idNlHEgD/qIJtBygMJITLL9r9yQvg/9QVInI1N0Xn7l6HAgfUCyTIQ1hnfxBYFSCKgDLvcxFuQIBC/pnmP3b/echsvvBAJxLAopR/5vHPIvc/a+mm6AYgARYoP4xVCeAFnrdXH4PCSYAUAIfhirbPc/n0K3nKEI0BIQr5N9Tt4p+8oCWK+7+izl/3Ktj9sFb47Qrgj5fAw7iBu09WC+8mwNFPzvXtcG/+MQQ4+rmhvieSjtGEDmXMvz8IrGND3V4CHP3kXE+AbIzMa6NLM7flv0oARWqOWoVx7oCVGKVtZIJ/Xrb5sCS6Vwab0J6Dsr4f8Ogn55ouvhajXIwRM3TzZ0l0rxCLO2Af0AVQRn7KMBQI0JP/G3ZDBXL8B2OAz7992zb/QuAC76pKgNdV66JwdDdUwJtaLWC/Nvy77u/xn19mUOZtuw1VJujptJn86IOwgA3tl6zjxvzLL/OZ88NLImERgGNAxg0FrU91hrdHcHMdN6A/WnxM30A2dLSBKhN03t4KO8Ad4ELL+das8r8uQLAHOo86E1QwBhzdDeUutLy2imX4X75tZC7k/5a8oMDuWf9nfRVRpFl0f+f+5DNP4b80s9KqkkSghCjFFdboT23NALm1irjwfnz3M5M5794mmwVNWGSC3h5OH9/z0+WrC5CeWq0gMD+p7r+atZT/HXfAy+pILAbhs3iS/dtBBuHN8GeEhPkppL/M/QzbVZNw3Rm9XP348XygaOhW+DPEwvzzTvzvEOB13QRduv/ro3medEe9jaCMNVPxAQD/vKL7Q/jfMwZsTIfPMlHu8cUrC2DZz4Y/IxeJ15sfEP834gVp+5MPf8YuEoevvHhZ4U1rmRCluKLa5M7+ZHwgGqGna3V/XimA8C+LzmdoUG8TaIKn6BHR+Lp4kWnm2u4P5r9KAHUyfckJJQ3qbQNpYryNhcnW2BGiqvtXmB9XNSxhyZpws3obgakni3LTXn+BMhN520Id/5/uDlgLLKxuzzEjtGd9upsfWXFNwuOOAdnoWAlBhn8ODT3s4P+TeUFBwGdt76G/O5Y57yfivbf58RrbMCFKcUGp7tXF3sLgsHfNs/6T4x3U/ffwXyXA+b5sXbhJvRWlylcdexAfp9j98ZPpj8nu39v8uAaAEqrR9/1pe12yRb3wYjX/8oMeWaOlq6UA+7r/Dv4rBDD/dlEu0Ny4Xmi55gkupl8ntzaYFUCZH/HJo/8K5idoVHHCrW23jeutLp6Z2APnsQDRGKD5Z+a5U0D3381/hQBb+x0a11tfPLP8+4zbuLRNqrs/g1ufvebHtAyYUPzrUXLJ8Sr17ijfp8cwvpgoyO7PtdWZGcT6tOC/fj2g5KTIFvWa9NCtXF73XxQTzA9s7Dm16L6KBvQPMw/IznDziEM/4rPzjbhvoiztCfprYxulGEOAeBAtgHF+mObQeEXm1ThIln6WNP455adG/H9WAXznk5kX8crs51lNEGZv6E3zn6q4Ff2fVAC98BUHJpQFUvzPs4385+nPVdyO/lEEyFiC9X1pbCGALUbSPxXMu5ICtOT/2gJUb09P5Uiq4i37BsZHW3/xruifiqa9iTpa0j/MHZBSINs7XehBD7/Msz2C73jdd83xjOtt2v2X7W+QsE9xiZ6YEMCwE15iZvBlDEp/jGbOj8UgAqR6+/I7x46vl3M+Jd3euiMk6hBV0AwDCxDdFWHnDA6EUWNBTD+09/egf2wB4kVHn3/u3wGcKbplGrXwMucczyzaWx/b0rYJ+xS3EYuYwsCD6vLurzlJP6gBfegfR4C1aJxi1nc09X8mh6XfMz6w2nvRP5AAUfal8TFLYcroe0EfSfdu+jvxP6gAnkGy8y5/2mXDnvPs936ejzmsoSP9gwpgJ7fa9iwF4Nrnj/g/HP0DC8DUZmcX9fGWWuQnQ/Yu9rtaH4lRBWBh0MEGG6wKkmytUa3t6U//oAI4+oOIp/pobY9xj2ZWx/416B9VALfZbTlDM5bfbfdhx6V/TAHs0MsCyy9h+7q1UKyG/WvRP6AAkxl6zbqCNUOMOUtjEsEjDn7ua2AwAbxJr1lg1CWxOez8k9Hj0PSPJcDkzIoO9jAz6dVUC9I1/cYYQSu6Kvt8JAFMvzazMBvzcR3dTLrMt+Clz+t2folRBHBev+38aqOV6fuWfa/zM1g9CPSPIoDt15yrzT2q/1vyo2i/+RYiAAr7vKMADY+ttMwYd0dOAKzlYUv2uT8xLq2i4in3BmcP9hKg0aF90+RTYyMOtu+zKN5pRl3GIZtfKjv/xiJReSFtEyo0OT09pN84nr7LE3d+55WWN7nW9iwn4TU47h2wtAqe2bfsa/rNE3Ze4tJ/Oq/a9B9bgN3HViaImWP2vb4PbJ2ron7kPbgAO4pL8WLJt47/5Pp+VQP2uz2HHgOqi5uifql3czpnf9XwFKOJ03lkL6jODV32fdfzeYL9SgJMLY07VRUONAgv2J8TYJ7hMYEgCIIb7DMLAD09Pcu+zBR2/YB9eKxhWj65jYhD3AEh+57Vmb3Pln0Xj4O1KxxaQFk7At8N9U1CyuiEXd8jDtCLEw5niwG0BfC9IEOM39u5W1tklnyVK9j2DOO/ZfubAV8AgYzVsT3frADbzh9YoRUkuv7B0NMNvSs6O9o5OKHf48jX1DsB/K6/uWn32Px3HYTF4X6FAoQd3/HPebjT1qzG8JQWAY5PvUJfN/R8D7gDoo5vT1nSKyse/26ty6wQhJ7tAB3forMb+vK33wsF4CH7bvXXDr1mNYDb10AA9ccQZsdHRzdUHmn2kvFDl4NwQJxbdpR/ue5v1sP8PYlqkdIXD9hWTOB7QUHPt1e1Ai5Z4PhEDyMN2PEt8AVIUcfMph/P57emxwwIUfaDBNegOIgAi6tR0Ci0/yy09v5EYTjgC5C+7Oi3JsfKEZh7t0t0SP6PLgC3Q65yg+KR1r8/xsThBLDG3wlgjv+MRtpwNjYqjiYA86hX70tbv5gEkwDN6rVeZmjn7bzMJ9zOxEbm/4ACxMxPdirsReDc54HNv8SxBEh1ed8LctkHp90BX4Bljw+oH9vAbONgAjDn7Zt4RNt6Dwd8AZbfWks/sn9fiiMLcBNAFyDo5CRAg4Sw4iI/fni3HgxkARZd/gasfoijCXBzIAGQ0U2Awu3pt2f0I/QSoHhz7s0Z/Qi9BIBuT79ZoN8Bt45uY8DW9nSCRi8BGgJe9SFz7GSQBNibgwRAzkECIOcgAZBzkADIOUgA5BwkAHIOEgA5x7gCEARIAGSQAMggAZBBAiCDBEAGCYAMEgAZJAAySABkkADIIAGQQQIggwRABgmADBIAGUgCvIkjz96fWGaH4zL9A2MnUI5XtX0PkENvvCzP8cJkHaAqFsAR4FU0XPzcl/ui9O9/PPO3r8+AHELhS1JADi4YPUFynOU+WVgVC6AIcL77z4UfscP6LXP4X4RX8QPPJ0AOgUtSUI63f/x5ArTq48ezeAM2KgaiCXr79kt27UJckgJzXPolJMfHj/9eOnN5DrlPGZIhCUQBxBb38paL42JBOd4e7p5BOV4ehTUpz3GxieIugP2MBUa5A+RxmV3vmUvSD9AdIHE+jXsHQIzn24MY8KDmFjRqvMht/Y/AOsADUwxEAYRRKfVpHrTDUZxDGwZADu5Oxi7LIar4+NdPWBULjDEPUL3zBHG5L1nkMe995wHgKhagmTAySABkkADIIAGQQQIggwRABgmADBIAGSQAMkgAZJAAyCABkEECIIMEQAYJgAwSABkkADJIAGSQAMggAZBBAiCDBEAGCYAMEgAZJAAySABkkADIIAGQQQIggwRAxsACqH9P6M48m7LjIQlMjCxAyDgJcG1YxuUz2e9P5kU8bvrlp3602z2vnftXV5DxCQQQD2mJJ1Ivf57l00LigSb5aLd6Tlg8P3Te9RhRT4wsgBwDfvulH1EUdF8+XSj3lNHX9AXExmYxsgDGBF2UuFP9/UmOyurCWRofdU1fQG1uBp9BAC6fWNQGR194fzqZBJdrB+39Ap9AAPG4qBJAmHr9Sf7/9Vlf0xeQG5zEyAI86IdXlbH5+C69IGWM5DOkf//TXOPqwhExsACfAyQAMkgAZJAAyCABkPF/Zaa2lJMhfWMAAAAASUVORK5CYII=" alt />
<p class="caption">Figure 9. Predicted 10th, 50th, and 90th centiles of number of bindings conditional on esterase concentration using Poisson regression and distribution-free quantile regression (QR) based on jittering in the Esterase data set.</p>
</div>
<p><span class="citation">Machado and Santos Silva (2005)</span>’s methods, including large-<span class="math inline">\(n\)</span> approximations for standard errors, are implemented in the function <tt>rq.counts</tt>. The <tt>formula</tt> argument specifies a log-linear model as in (17). Prior to version 1.4, flexible transformations as described above (e.g., Box-Cox) were allowed. As of version 1.4 of the package, this option has been removed since inference under transformations other than logarithmic was found unreliable and this was likely due to coding issues.</p>
<p>In the example below, estimation is carried out using <span class="math inline">\(M=50\)</span> jittered samples and <span class="math inline">\(\zeta = 10^{-5}\)</span> (see <span class="citation">Machado and Santos Silva (2005)</span> for further details on these settings).</p>
<pre><code>R&gt; data(esterase)
R&gt; fit.rq.counts &lt;- rq.counts(formula = Count ~ Esterase, tau = 0.1,
+ data = esterase, M = 50, zeta = 1e-05)</code></pre>
<p>Figure 9 shows a contrast between centile curves as predicted by the Poisson and the QR models in the Esterase data set. The Poisson distribution clearly underestimates the variability in the data. An empirical modeling of the conditional quantiles seems to be preferred in this case. Of course, the assumption of log-linearity of the models would need to be carefully assessed (note that <tt>GOFTest</tt> can be applied also to <tt>rq.counts</tt> objects).</p>
</div>
<div id="conditional-mid-quantiles-for-discrete-responses" class="section level3">
<h3>Conditional mid-quantiles for discrete responses</h3>
<p><span class="citation">Geraci and Farcomeni (2019)</span> developed quantile regression methods for discrete responses by extending Parzen’s definition of marginal mid-quantiles which we discussed previously. These methods are general as they can be applied to a large variety of discrete responses, including binary, ordinal, and count variables.</p>
<p><span class="citation">Geraci and Farcomeni (2019)</span> first defined the conditional mid-distribution function as <span class="math display">\[\begin{equation}\label{eq:18}
\tag{18}
G_{Y|X}(y) \equiv \Pr(Y \leq y|X) - 0.5\cdot \Pr(Y = y|X).
\end{equation}\]</span> Then, they introduced the <em>conditional</em> mid-quantile function as its inverse, that is <span class="math inline">\(H_{Y|X}(p) \equiv G^{-1}_{Y|X}(p)\)</span>.</p>
<p>Estimation is carried out in a two-step approach. In the first step, conditional mid-probabilities are obtained nonparametrically and, in the second step, regression coefficients are estimated by solving an implicit equation. When constraining the quantile index to a data-driven admissible range, the second-step estimating equation has a least-squares type, closed-form solution. Such estimator is shown to be strongly consistent and asymptotically normal. Its good performance is shown in a simulation study with data generated from different discrete response models.</p>
<div class="figure">
<img src="data:image/png;base64,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" alt />
<p class="caption">Figure 10. Predicted 50th and 90th centiles of number of bindings conditional on esterase concentration using Poisson regression and mid-quantile regression (mid-QR) in the Esterase data set.</p>
</div>
<p>In the example below, the function <tt>midrq</tt> is applied to the Esterase data set to obtain 10th and 90th conditional mid-quantiles (plotted in Figure 10). As opposed to <tt>rq.counts</tt>, the function <tt>midrq</tt> supports Box-Cox and Aranda-Ordaz transformations. S3 methods for <tt>midrq</tt> objects (e.g., <tt>summary</tt>, <tt>coef</tt>, <tt>predict</tt>, <tt>residuals</tt>, <tt>vcov</tt>) are available in the <strong>Qtools</strong> package. The latter also provides the function <tt>cmidecdf</tt> to fit the conditional mid-CDF. See <span class="citation">Geraci and Farcomeni (2019)</span> for details on estimation.</p>
<pre><code>R&gt; data(esterase)
R&gt; fit.midrq &lt;- midrq(Count ~ Esterase, tau = c(0.5, 0.9),
+ data = esterase, type = 1, lambda = 0)</code></pre>
</div>
</div>
<div id="quantile-based-multiple-imputation" class="section level2">
<h2>Quantile-based multiple imputation</h2>
<p>Regression models play an important role in conditional imputation of missing values. QR can be used as an effective approach for multiple imputation (MI) when location-shift models are inadequate <span class="citation">(Muñoz and Rueda 2009; Bottai and Zhen 2013; Geraci 2016)</span>.</p>
<p>In <strong>Qtools</strong>, <tt>mice.impute.rq</tt> and <tt>mice.impute.rrq</tt> are auxiliary functions written to be used along with the functions of the R package <strong>mice</strong> <span class="citation">(van Buuren and Groothuis-Oudshoorn 2011)</span>. The former is based on the standard QR estimator (<tt>rq.fit</tt>) while the latter on the restricted counterpart (<tt>rrq.fit</tt>). Both imputation functions allow for the specification of the transformation-based QR models discussed previously. The equivariance property is useful to achieve linearity of the conditional model and to ensure that imputations lie within some interval when imputed variables are bounded. An example is available from the help file  using the <tt>nhanes</tt> data set. See also <span class="citation">Geraci (2016)</span> and <span class="citation">Geraci and McLain (2018)</span> for a thorough description of these methods.</p>
</div>
</div>
<div id="final-remarks" class="section level1">
<h1>Final remarks</h1>
<p>Quantiles have long occupied an important place in statistics. The package <strong>Qtools</strong> builds on recent methodological and computational developments of quantile functions and related methods to promote their application in statistical data modelling.</p>
</div>
<div id="acknowledgements" class="section level1">
<h1>Acknowledgements</h1>
<p>This work was partially supported by an ASPIRE grant from the Office of the Vice President for Research at the University of South Carolina. Please cite the Qtools package as: Geraci, M. (2016). Qtools: A collection of models and other tools for quantile inference. R Journal, 8(2), 117-138.</p>
</div>
<div id="references" class="section level1 unnumbered">
<h1>References</h1>
<div id="refs" class="references">
<div id="ref-aranda_1981">
<p>Aranda-Ordaz, F. J. 1981. “On Two Families of Transformations to Additivity for Binary Response Data.” <em>Biometrika</em> 68 (2): 357–63.</p>
</div>
<div id="ref-azzalini_bowman_1990">
<p>Azzalini, A., and A. W. Bowman. 1990. “A Look at Some Data on the Old Faithful Geyser.” <em>Journal of the Royal Statistical Society C</em> 39 (3): 357–65.</p>
</div>
<div id="ref-benjamini_krieger_1996">
<p>Benjamini, Y., and A. M. Krieger. 1996. “Concepts and Measures for Skewness with Data-Analytic Implications.” <em>Canadian Journal of Statistics</em> 24 (1): 131–40.</p>
</div>
<div id="ref-benoit_etal">
<p>Benoit, D. F., R. Al-Hamzawi, K. Yu, and D. Van den Poel. 2014. <em>BayesQR: Bayesian Quantile Regression</em>. <a href="https://cran.r-project.org/package=bayesQR">https://cran.r-project.org/package=bayesQR</a>.</p>
</div>
<div id="ref-boghossian_etal">
<p>Boghossian, N. S., M. Geraci, E. M. Edwards, K. A. Morrow, and J. D. Horbar. 2016. “Anthropometric Charts for Infants Born Between 22 and 29 Weeks’ Gestation.” <em>Pediatrics</em>.</p>
</div>
<div id="ref-bottai_zhen_2013">
<p>Bottai, M., and H. Zhen. 2013. “Multiple Imputation Based on Conditional Quantile Estimation.” <em>Epidemiology, Biostatistics, and Public Health</em> 10 (1): e8758.</p>
</div>
<div id="ref-box_cox">
<p>Box, G. E. P., and D. R. Cox. 1964. “An Analysis of Transformations.” <em>Journal of the Royal Statistical Society B</em> 26 (2): 211–52.</p>
</div>
<div id="ref-buchinsky_1995">
<p>Buchinsky, M. 1995. “Quantile Regression, Box-Cox Transformation Model, and the US Wage Structure, 1963-1987.” <em>Journal of Econometrics</em> 65 (1): 109–54.</p>
</div>
<div id="ref-boot">
<p>Canty, A., and B. D. Ripley. 2014. <em>Boot: Bootstrap R (S-Plus) Functions</em>. <a href="https://cran.r-project.org/package=boot">https://cran.r-project.org/package=boot</a>.</p>
</div>
<div id="ref-chamberlain_1994">
<p>Chamberlain, G. 1994. “Quantile Regression, Censoring, and the Structure of Wages.” In <em>Advances in Econometrics: Sixth World Congress</em>, edited by C. Sims. Vol. 1. Cambridge, UK: Cambridge University Press.</p>
</div>
<div id="ref-chernozhukov_etal">
<p>Chernozhukov, V., I. Fernandez-Val, and A. Galichon. 2010. “Quantile and Probability Curves Without Crossing.” <em>Econometrica</em> 78 (3): 1093–1125.</p>
</div>
<div id="ref-davison_hinkley">
<p>Davison, A. C., and D. V. Hinkley. 1997. <em>Bootstrap Methods and Their Applications</em>. Cambridge: Cambridge University Press.</p>
</div>
<div id="ref-dehbi_etal">
<p>Dehbi, H.-M., M. Cortina-Borja, and M. Geraci. 2016. “Aranda-Ordaz Quantile Regression for Student Performance Assessment.” <em>Journal of Applied Statistics</em> 43 (1): 58–71.</p>
</div>
<div id="ref-doksum">
<p>Doksum, K. 1974. “Empirical Probability Plots and Statistical Inference for Nonlinear Models in the Two-Sample Case.” <em>The Annals of Statistics</em> 2 (2): 267–77.</p>
</div>
<div id="ref-geraci_2104">
<p>Geraci, M. 2014. “Linear Quantile Mixed Models: The Lqmm Package for Laplace Quantile Regression.” <em>Journal of Statistical Software</em> 57 (13): 1–29.</p>
</div>
<div id="ref-geraci_2016">
<p>———. 2016. “Estimation of Regression Quantiles in Complex Surveys with Data Missing at Random: An Application to Birthweight Determinants.” <em>Statistical Methods in Medical Research</em> 25 (4): 1393–1421.</p>
</div>
<div id="ref-geraci_bottai_2014">
<p>Geraci, M., and M. Bottai. 2014. “Linear Quantile Mixed Models.” <em>Statistics and Computing</em> 24 (3): 461–79.</p>
</div>
<div id="ref-geraci_farcomeni_2019">
<p>Geraci, M., and A. Farcomeni. 2019. “Mid-Quantile Regression for Discrete Responses.” <em>arXiv Preprint arXiv:1907.01945 [stat.ME]</em>.</p>
</div>
<div id="ref-geraci_jones_2015">
<p>Geraci, M., and M. C. Jones. 2015. “Improved Transformation-Based Quantile Regression.” <em>Canadian Journal of Statistics</em> 43 (1): 118–32.</p>
</div>
<div id="ref-geraci_mclain_2018">
<p>Geraci, M., and A. McLain. 2018. “Multiple Imputation for Bounded Variables.” <em>Psychometrika</em> 83 (4): 919–40.</p>
</div>
<div id="ref-gilchirst_2000">
<p>Gilchrist, W. 2000. <em>Statistical Modelling with Quantile Functions</em>. Boca Raton, FL: Chapman &amp; Hall/CRC.</p>
</div>
<div id="ref-rearrangement">
<p>Graybill, W., M. Chen, V. Chernozhukov, I. Fernandez-Val, and A. Galichon. 2016. <em>Rearrangement: Monotonize Point and Interval Functional Estimates by Rearrangement</em>. <a href="https://cran.r-project.org/package=Rearrangement">https://cran.r-project.org/package=Rearrangement</a>.</p>
</div>
<div id="ref-groeneveld_1998">
<p>Groeneveld, R. A. 1998. “A Class of Quantile Measures for Kurtosis.” <em>The American Statistician</em> 52 (4): pp. 325–29.</p>
</div>
<div id="ref-groeneveld_meeden_1984">
<p>Groeneveld, R. A., and G. Meeden. 1984. “Measuring Skewness and Kurtosis.” <em>Journal of the Royal Statistical Society D</em> 33 (4): pp. 391–99.</p>
</div>
<div id="ref-hald_2003">
<p>Hald, A. 2003. <em>A History of Probability and Statistics and Their Applications Before 1750</em>. New York, NY: John Wiley &amp; Sons.</p>
</div>
<div id="ref-he_1997">
<p>He, X. 1997. “Quantile Curves Without Crossing.” <em>The American Statistician</em> 51 (2): 186–92.</p>
</div>
<div id="ref-he_zhu_2003">
<p>He, X. M., and L. X. Zhu. 2003. “A Lack-of-Fit Test for Quantile Regression.” <em>Journal of the American Statistical Association</em> 98 (464): 1013–22.</p>
</div>
<div id="ref-horn_1983">
<p>Horn, P. S. 1983. “A Measure for Peakedness.” <em>The American Statistician</em> 37 (1): 55–56.</p>
</div>
<div id="ref-hyndman_fan_1996">
<p>Hyndman, R. J., and Y. Fan. 1996. “Sample Quantiles in Statistical Packages.” <em>The American Statistician</em> 50 (4): 361–65.</p>
</div>
<div id="ref-jones_2007">
<p>Jones, M. C. 2007. “Connecting Distributions with Power Tails on the Real Line, the Half Line and the Interval.” <em>International Statistical Review</em> 75 (1): 58–69.</p>
</div>
<div id="ref-jones_etal_2011">
<p>Jones, M. C., J. F. Rosco, and A. Pewsey. 2011. “Skewness-Invariant Measures of Kurtosis.” <em>The American Statistician</em> 65 (2): 89–95.</p>
</div>
<div id="ref-khmaladze_etal_2004">
<p>Khmaladze, E. V., and H. L. Koul. 2004. “Martingale Transforms Goodness-of-Fit Tests in Regression Models,” 995–1034.</p>
</div>
<div id="ref-koenker_2005">
<p>Koenker, R. 2005. <em>Quantile Regression</em>. New York, NY: Cambridge University Press.</p>
</div>
<div id="ref-quantreg">
<p>———. 2013. <em>Quantreg: Quantile Regression</em>. <a href="https://cran.r-project.org/package=quantreg">https://cran.r-project.org/package=quantreg</a>.</p>
</div>
<div id="ref-koenker_bassett_1978">
<p>Koenker, R., and G. Bassett. 1978. “Regression Quantiles.” <em>Econometrica</em> 46 (1): 33–50.</p>
</div>
<div id="ref-koenker_dorey">
<p>Koenker, R., and V. D’Orey. 1987. “Algorithm AS 229: Computing Regression Quantiles.” <em>Journal of the Royal Statistical Society C</em> 36 (3): 383–93.</p>
</div>
<div id="ref-koenker_machado_1999">
<p>Koenker, R., and J. A. F. Machado. 1999. “Goodness of Fit and Related Inference Processes for Quantile Regression.” <em>Journal of the American Statistical Association</em> 94 (448): 1296–1310.</p>
</div>
<div id="ref-koenker_park_1996">
<p>Koenker, R., and B. J. Park. 1996. “An Interior Point Algorithm for Nonlinear Quantile Regression.” <em>Journal of Econometrics</em> 71 (1-2): 265–83.</p>
</div>
<div id="ref-koenker_xiao">
<p>Koenker, R., and Z. J. Xiao. 2002. “Inference on the Quantile Regression Process.” <em>Econometrica</em> 70 (4): 1583–1612.</p>
</div>
<div id="ref-lehmann">
<p>Lehmann, E. L. 1975. <em>Nonparametrics: Statistical Methods Based on Ranks</em>. San Francisco, CA: Holden-Day.</p>
</div>
<div id="ref-ma_etal_2011">
<p>Ma, Y., M. G. Genton, and E. Parzen. 2011. “Asymptotic Properties of Sample Quantiles of Discrete Distributions.” <em>Annals of the Institute of Statistical Mathematics</em> 63 (2): 227–43.</p>
</div>
<div id="ref-machado_mata">
<p>Machado, J. A. F., and J. Mata. 2000. “Box–Cox Quantile Regression and the Distribution of Firm Sizes.” <em>Journal of Applied Econometrics</em> 15 (3): 253–74.</p>
</div>
<div id="ref-machado_silva_2005">
<p>Machado, J. A. F., and J. M. C. Santos Silva. 2005. “Quantiles for Counts.” <em>Journal of the American Statistical Association</em> 100 (472): 1226–37.</p>
</div>
<div id="ref-mu_he">
<p>Mu, Y. M., and X. M. He. 2007. “Power Transformation Toward a Linear Regression Quantile.” <em>Journal of the American Statistical Association</em> 102 (477): 269–79.</p>
</div>
<div id="ref-munoz_rueda_2009">
<p>Muñoz, J. F., and M. Rueda. 2009. “New Imputation Methods for Missing Data Using Quantiles.” <em>Journal of Computational and Applied Mathematics</em> 232 (2): 305–17.</p>
</div>
<div id="ref-parzen_1979">
<p>Parzen, E. 1979. “Nonparametric Statistical Data Modeling.” <em>Journal of the American Statistical Association</em> 74 (365): 105–21.</p>
</div>
<div id="ref-parzen_2004">
<p>———. 2004. “Quantile Probability and Statistical Data Modeling.” <em>Statistical Science</em> 19 (4): 652–62.</p>
</div>
<div id="ref-powell_1991">
<p>Powell, J. L. 1991. “Estimation of Monotonic Regression Models Under Quantile Restrictions.” In <em>Nonparametric and Semiparametric Methods in Econometrics and Statistics: Proceedings of the Fifth International Symposium on Economic Theory and Econometrics</em>, edited by W. Barnett, J. Powell, and G. Tauchen, 357–84. New York, NY: Cambridge University Press.</p>
</div>
<div id="ref-powell_1994">
<p>———. 1994. “Estimation of Semiparametric Models.” In <em>Handbook of Econometrics</em>, edited by F. Engle Robert and L. McFadden Daniel, Volume 4:2443–2521. Elsevier.</p>
</div>
<div id="ref-ruppert_1987">
<p>Ruppert, D. 1987. “What Is Kurtosis?: An Influence Function Approach.” <em>The American Statistician</em> 41 (1): 1–5.</p>
</div>
<div id="ref-smith_reich">
<p>Smith, L., and B. Reich. 2013. <em>BSquare: Bayesian Simultaneous Quantile Regression</em>. <a href="https://cran.r-project.org/package=BSquare">https://cran.r-project.org/package=BSquare</a>.</p>
</div>
<div id="ref-staudte_2014">
<p>Staudte, R. G. 2014. “Inference for Quantile Measures of Kurtosis, Peakedness and Tail-Weight.” <em>arXiv Preprint arXiv:1047.6461v1 [math.ST]</em>. <a href="https://doi.org/10.1080/03610926.2015.1056366">https://doi.org/10.1080/03610926.2015.1056366</a>.</p>
</div>
<div id="ref-tukey">
<p>Tukey, J. W. 1965. “Which Part of the Sample Contains the Information?” <em>Proceedings of the National Academy of Sciences of the United States of America</em> 53 (1): 127–34.</p>
</div>
<div id="ref-mice">
<p>van Buuren, S., and K. Groothuis-Oudshoorn. 2011. “Mice: Multivariate Imputation by Chained Equations in R.” <em>Journal of Statistical Software</em> 45 (3): 1–67.</p>
</div>
<div id="ref-yu_jones">
<p>Yu, K. M., and M. C. Jones. 1998. “Local Linear Quantile Regression.” <em>Journal of the American Statistical Association</em> 93 (441): 228–37.</p>
</div>
<div id="ref-zhao_2000">
<p>Zhao, Q. S. 2000. “Restricted Regression Quantiles.” <em>Journal of Multivariate Analysis</em> 72 (1): 78–99.</p>
</div>
<div id="ref-zheng_1998">
<p>Zheng, J. X. 1998. “A Consistent Nonparametric Test of Parametric Regression Models Under Conditional Quantile Restrictions.” <em>Econometric Theory</em> 14 (1): 123–38.</p>
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
