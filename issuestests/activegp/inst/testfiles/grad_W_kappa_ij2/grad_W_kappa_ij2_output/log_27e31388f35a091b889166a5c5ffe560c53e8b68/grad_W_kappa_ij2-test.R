testlist <- list(ct = -469831375L, design1 = c(4.24195415756373e+22, -1.3484668303288e-218,  8.07634259695606e-201, 9.96356289148442e-247, 2.90006540622778e+287,  -3.62253220237966e+84, -0.00016852503890871, -5.51903795077038e-05,  -2.04972055854821e+224, 2.91998178219736e-47, 4.09707721003032e+206,  -1.08136198436748e+108, -0.0456404306303113, 7.86531961485621e-108,  1.77775555112607e+279, 1.92512546208025e-122, -1.74847823197689e+192,  -8.62176304742102e+250, 1.6260684855955e+96, 1.56395602788288e+138,  1.86510843342709e-245, -1.6578235520724e-126, 8.31920255513824e+76,  1.21214794644861e-73, -1.82852408321013e+183, 4.29485968908016e-206,  4.54964027613698e+119, -1.51652249314335e+167, -3.75004888626212e-129,  3.69390615123829e+234, 5.50122451930252e+234, -5.85649931437095e+106,  2.33603150842745e+187, -2.61014782890184e-89, 5.39802665415686e+140,  4.34952641997584e-92, 4.43042828616646e-127, 3.44019924376599e-175,  5.97911312413231e+292, -2.91472249704818e-218, -1.65068658328465e-137,  -2.23942978672215e+46, 8.11011748043062e+134, -1.03257662527594e+153,  1.07152618122477e+139, -1.32829145719433e+231, 4.88048830900701e-239,  -5.26071435728122e+264, -5.76397108542496e-280, -9.94650562032047e+188,  -1.49918877353769e+56, 1.81312413287634e-164, 7.26431178286288e+160,  3.97887764037891e-75, -3.63104284120958e+53, 1.311014330822e+226,  -8.01925069391582e-77), design2 = structure(c(Inf, NA, 2.58069493284837e+92,  Inf), .Dim = c(2L, 2L)), i1 = 1419925127L, i2 = -1492469888L,      theta = c(-1.33698660466065e+53, -3.02572039529584e-63, -1.96975805132333e+72,      1.26817317254928e+168, 3.62182926739918e+128, -1.6784234595817e-149,      1.68203628804983e+173, -9.06568165877148e-121, -1.17329755822429e-301,      5.87163517871365e-141, 1.08815997512014e+274, 1.603379463214e-58,      1.04613837189851e-10, -1.88831983614963e+146, -2.76293308229909e-194,      -6.97205378261285e+79, 2.75677352114531e+53, -3.06267740736202e-211,      -5.51075422447846e-282, 1.12721217890837e+271, 2.9729297112535e-135,      -5.64072057025014e-246, -8.97412910754601e+223, -0.000149059420130128,      4.00006695917432e+209, -1.54856930949977e+206, -4.76640662754041e-43,      -4.14492971520566e+211, -1.33375904223317e-19, 7.50294615700782e+275,      -3.54919152161866e+86, -8.46815791703838e-38, -4.6931372601083e+27,      3.74333823177032e-85, 7.18084704185976e-13, 5.43925348550642e+77,      -2.63954756372253e+203, -8.035191682105e+62, 4.52785719052646e-99,      1.62589982823472e-175, 1.55591213325014e+162, 8.63031018389494e-255,      -3.60762946158194e-249, 1.61089170743615e+221, -3.2420135871162e+210,      -2.97824390177137e-198, -2.02672679124856e+265, -4.09672374931837e+105,      -3.55042108182604e+163, -1.9150834128595e+25, 3.03926171802815e-246,      8.75722384783549e-71, -5.9539182104698e+28, 9.7054729016666e+22,      1.7151226723779e+109, -382818358160.389, -1.69542457924557e+47,      2.64297568621164e-111, 8.46097541770778e+100, -1.19732208473033e+90,      5.38108856078511e+282, 9.30723297885881e-143, -3.51918368026617e+251,      -7.09263908480733e-09, 2.46539398545318e-70, 3.16704468326766e-46,      7.18541476435729e-176, -3.77063484535263e-05, 6.28890620448226e+190,      6.08729433160384e-232, -1.61117534396225e+300, 3.61015168119058e+131,      8.041084637703e-159, -9.63564433138483e-293, -9.60941475400201e+153,      2.76131403207845e+80, -1.18033525358934e+188, 1.55329352025042e+109,      -3.02382294508374e+224, 7.50163458170595e-87, 4.20512184659921e-74,      -2.84719579668055e-06, 4.50552038952894e+266, -1.92601461032577e-262     ))
result <- do.call(activegp:::grad_W_kappa_ij2,testlist)
str(result)