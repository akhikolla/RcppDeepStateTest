<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Stéphane Laurent" />

<meta name="date" content="2020-01-07" />

<title>Owen cumulative functions</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Owen cumulative functions</h1>
<h4 class="author">Stéphane Laurent</h4>
<h4 class="date">2020-01-07</h4>


<div id="TOC">
<ul>
<li><a href="#the-owen-distribution">The Owen distribution</a></li>
<li><a href="#non-central-student-distribution">Non-central Student distribution</a></li>
<li><a href="#limitations">Limitations</a></li>
<li><a href="#application-to-equivalence-testing">Application to equivalence testing</a><ul>
<li><a href="#one-sample">One sample</a></li>
<li><a href="#inconclusive-equivalence-test">Inconclusive equivalence test</a></li>
<li><a href="#parallel-design">Parallel design</a></li>
</ul></li>
<li><a href="#the-owen-t-function">The Owen <span class="math inline">\(T\)</span>-function</a></li>
<li><a href="#the-owen-q-functions">The Owen <span class="math inline">\(Q\)</span>-functions</a></li>
<li><a href="#application-equal-tailed-tolerance-interval">Application: Equal-tailed tolerance interval</a></li>
<li><a href="#internal-functions-numerical-integration">Internal functions: numerical integration</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

<div id="the-owen-distribution" class="section level1">
<h1>The Owen distribution</h1>
<p>Let <span class="math inline">\(Z \sim {\cal N}(0,1)\)</span> and <span class="math inline">\(X \sim \chi^2_\nu\)</span> be two independent random variables. For real numbers <span class="math inline">\(\delta_1\)</span> and <span class="math inline">\(\delta_2\)</span>, define the two random variables <span class="math display">\[
T_1 = \frac{Z+\delta_1}{\sqrt{X/\nu}}
\quad \text{and} \quad\;
T_2 = \frac{Z+\delta_2}{\sqrt{X/\nu}}.
\]</span></p>
<p>Both <span class="math inline">\(T_1\)</span> and <span class="math inline">\(T_2\)</span> follow a non-central Student distribution. The number of degrees of freedom is <span class="math inline">\(\nu\)</span> for each of them, and their respective non-centrality parameters are <span class="math inline">\(\delta_1\)</span> and <span class="math inline">\(\delta_2\)</span> respectively.</p>
<p>Owen (1965) studied the distribution of the pair <span class="math inline">\((T_1, T_2)\)</span>.</p>
<p>The four Owen cumulative functions are <span class="math display">\[
\begin{align}
O_1(\nu, t_1, t_2, \delta_1, \delta_2) &amp; = \Pr(T_1 \leq t_1, T_2 \leq t_2), \\
O_2(\nu, t_1, t_2, \delta_1, \delta_2) &amp; = \Pr(T_1 \leq t_1, T_2 \geq t_2), \\
O_3(\nu, t_1, t_2, \delta_1, \delta_2) &amp; = \Pr(T_1 \geq t_1, T_2 \geq t_2), \\
O_4(\nu, t_1, t_2, \delta_1, \delta_2) &amp; = \Pr(T_1 \geq t_1, T_2 \leq t_2).
\end{align}
\]</span></p>
<p>Owen provided an efficient way to evaluate these functions <em>when <span class="math inline">\(\nu\)</span> is an integer number</em>. Owen’s algorithms are implemented in the <code>OwenQ</code> package.</p>
<p>For <span class="math inline">\(\delta_1 &gt; \delta_2\)</span>, these four functions are implemented in the <code>OwenQ</code> package under the respective names <code>powen1</code>, <code>powen2</code>, <code>powen3</code> and <code>powen4</code>. For general values of <span class="math inline">\(\delta_1\)</span> and <span class="math inline">\(\delta_2\)</span>, they are implemented under the respective names <code>psbt1</code>, <code>psbt2</code>, <code>psbt3</code> and <code>psbt4</code>.</p>
</div>
<div id="non-central-student-distribution" class="section level1">
<h1>Non-central Student distribution</h1>
<p>Owen (1965) also provided an algorithm to evaluate the cumulative distribution function of a univariate non-central Student distribution with an integer number of degrees of freedom. This evaluation is performed by the function <code>ptOwen</code> of the <code>OwenQ</code> package.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">ptOwen</span>(<span class="dt">q=</span><span class="dv">1</span>, <span class="dt">nu=</span><span class="dv">3</span>, <span class="dt">delta=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1-2" title="2"><span class="co">## [1] 0.1573494</span></a>
<a class="sourceLine" id="cb1-3" title="3"><span class="kw">pt</span>(<span class="dt">q=</span><span class="dv">1</span>, <span class="dt">df=</span><span class="dv">3</span>, <span class="dt">ncp=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1-4" title="4"><span class="co">## [1] 0.1573494</span></a></code></pre></div>
<p>It is known that the <code>pt</code> function is not reliable when the non-centrality parameter <code>ncp</code> is large. Below we compare the values given by <code>ptOwen</code> and <code>pt</code> to the value given by Wolfram|Alpha (returned by the command <code>N[CDF[NoncentralStudentTDistribution[4,70],80]]</code>):</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1">p1 &lt;-<span class="st"> </span><span class="kw">pt</span>(<span class="dt">q=</span><span class="dv">80</span>, <span class="dt">df=</span><span class="dv">4</span>, <span class="dt">ncp=</span><span class="dv">70</span>)</a>
<a class="sourceLine" id="cb2-2" title="2">p2 &lt;-<span class="st"> </span><span class="kw">ptOwen</span>(<span class="dt">q=</span><span class="dv">80</span>, <span class="dt">nu=</span><span class="dv">4</span>, <span class="dt">delta=</span><span class="dv">70</span>)</a>
<a class="sourceLine" id="cb2-3" title="3">wolfram &lt;-<span class="st"> </span><span class="fl">0.54742763380700947685</span></a>
<a class="sourceLine" id="cb2-4" title="4">p1 <span class="op">-</span><span class="st"> </span>wolfram</a>
<a class="sourceLine" id="cb2-5" title="5"><span class="co">## [1] 0.02268711</span></a>
<a class="sourceLine" id="cb2-6" title="6">p2 <span class="op">-</span><span class="st"> </span>wolfram</a>
<a class="sourceLine" id="cb2-7" title="7"><span class="co">## [1] 3.330669e-16</span></a></code></pre></div>
</div>
<div id="limitations" class="section level1">
<h1>Limitations</h1>
<p>When <code>q</code><span class="math inline">\(=\)</span><code>delta</code>, the value of <code>ptOwen(q, nu, delta)</code> should go to <code>0.5</code> as <code>nu</code> increases to infinity. The examples below show the failure of this expectation when <code>nu</code> is too large.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="kw">ptOwen</span>(<span class="dt">q=</span><span class="dv">50</span>, <span class="dt">nu=</span><span class="dv">3500</span>, <span class="dt">delta=</span><span class="dv">50</span>)</a>
<a class="sourceLine" id="cb3-2" title="2"><span class="co">## [1] 0.4986697</span></a>
<a class="sourceLine" id="cb3-3" title="3"><span class="kw">ptOwen</span>(<span class="dt">q=</span><span class="dv">50</span>, <span class="dt">nu=</span><span class="dv">3600</span>, <span class="dt">delta=</span><span class="dv">50</span>)</a>
<a class="sourceLine" id="cb3-4" title="4"><span class="co">## [1] 0.4989289</span></a>
<a class="sourceLine" id="cb3-5" title="5"><span class="kw">ptOwen</span>(<span class="dt">q=</span><span class="dv">50</span>, <span class="dt">nu=</span><span class="dv">3650</span>, <span class="dt">delta=</span><span class="dv">50</span>)</a>
<a class="sourceLine" id="cb3-6" title="6"><span class="co">## [1] 0.4522949</span></a>
<a class="sourceLine" id="cb3-7" title="7"><span class="kw">ptOwen</span>(<span class="dt">q=</span><span class="dv">50</span>, <span class="dt">nu=</span><span class="dv">3660</span>, <span class="dt">delta=</span><span class="dv">50</span>)</a>
<a class="sourceLine" id="cb3-8" title="8"><span class="co">## [1] 0.3349762</span></a>
<a class="sourceLine" id="cb3-9" title="9"><span class="kw">ptOwen</span>(<span class="dt">q=</span><span class="dv">50</span>, <span class="dt">nu=</span><span class="dv">3670</span>, <span class="dt">delta=</span><span class="dv">50</span>)</a>
<a class="sourceLine" id="cb3-10" title="10"><span class="co">## [1] 0.7607795</span></a>
<a class="sourceLine" id="cb3-11" title="11"><span class="kw">ptOwen</span>(<span class="dt">q=</span><span class="dv">50</span>, <span class="dt">nu=</span><span class="dv">3680</span>, <span class="dt">delta=</span><span class="dv">50</span>)</a>
<a class="sourceLine" id="cb3-12" title="12"><span class="co">## [1] 0</span></a></code></pre></div>
<p>Since all Owen’s algorithms are somehow similar to the algorithm evaluating <code>ptOwen</code>, we can suspect that the other ones also suffer from certain limitations. In the other vignette, we investigate the reliability and the limitations of <code>OwenQ</code>.</p>
<p>In order to do some comparisons, and thanks to the <code>BH</code> package, we have ported the <code>boost</code> implementation of the cumulative Student distribution to <code>OwenQ</code>. It is evaluated by the internal function <code>pt_boost</code>. We concluded that this function is highly reliable. In particular it does not suffer from the failures of <code>ptOwen</code> we have just shown:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1">OwenQ<span class="op">:::</span><span class="kw">pt_boost</span>(<span class="dt">q=</span><span class="dv">50</span>, <span class="dt">nu=</span><span class="dv">3500</span>, <span class="dt">delta=</span><span class="dv">50</span>)</a>
<a class="sourceLine" id="cb4-2" title="2"><span class="co">## [1] 0.4986697</span></a>
<a class="sourceLine" id="cb4-3" title="3">OwenQ<span class="op">:::</span><span class="kw">pt_boost</span>(<span class="dt">q=</span><span class="dv">50</span>, <span class="dt">nu=</span><span class="dv">3600</span>, <span class="dt">delta=</span><span class="dv">50</span>)</a>
<a class="sourceLine" id="cb4-4" title="4"><span class="co">## [1] 0.4987041</span></a>
<a class="sourceLine" id="cb4-5" title="5">OwenQ<span class="op">:::</span><span class="kw">pt_boost</span>(<span class="dt">q=</span><span class="dv">50</span>, <span class="dt">nu=</span><span class="dv">3650</span>, <span class="dt">delta=</span><span class="dv">50</span>)</a>
<a class="sourceLine" id="cb4-6" title="6"><span class="co">## [1] 0.4987206</span></a>
<a class="sourceLine" id="cb4-7" title="7">OwenQ<span class="op">:::</span><span class="kw">pt_boost</span>(<span class="dt">q=</span><span class="dv">50</span>, <span class="dt">nu=</span><span class="dv">3660</span>, <span class="dt">delta=</span><span class="dv">50</span>)</a>
<a class="sourceLine" id="cb4-8" title="8"><span class="co">## [1] 0.4987238</span></a>
<a class="sourceLine" id="cb4-9" title="9">OwenQ<span class="op">:::</span><span class="kw">pt_boost</span>(<span class="dt">q=</span><span class="dv">50</span>, <span class="dt">nu=</span><span class="dv">3670</span>, <span class="dt">delta=</span><span class="dv">50</span>)</a>
<a class="sourceLine" id="cb4-10" title="10"><span class="co">## [1] 0.4987271</span></a>
<a class="sourceLine" id="cb4-11" title="11">OwenQ<span class="op">:::</span><span class="kw">pt_boost</span>(<span class="dt">q=</span><span class="dv">50</span>, <span class="dt">nu=</span><span class="dv">3680</span>, <span class="dt">delta=</span><span class="dv">50</span>)</a>
<a class="sourceLine" id="cb4-12" title="12"><span class="co">## [1] 0.4987303</span></a></code></pre></div>
</div>
<div id="application-to-equivalence-testing" class="section level1">
<h1>Application to equivalence testing</h1>
<p>The Owen distribution intervenes in the calculation of the power of equivalence tests.</p>
<div id="one-sample" class="section level2">
<h2>One sample</h2>
<p>Assume a statistical model given by a sample <span class="math inline">\(y_i \sim_{\text{iid}} {\cal N}(\mu, \sigma^2)\)</span> for <span class="math inline">\(i=1, \ldots, n\)</span>. We want to demonstrate that, up to a given confidence level, the mean <span class="math inline">\(\mu\)</span> belongs to a certain interval <span class="math inline">\([\Delta_1, \Delta_2]\)</span>. In other words, we are interested in the alternative hypothesis <span class="math inline">\(H_1\colon\{\Delta_1 \leq \mu \leq \Delta_2\}\)</span>.</p>
<p>Consider the usual <span class="math inline">\(100(1-2\alpha)\%\)</span>-confidence interval about <span class="math inline">\(\mu\)</span>: <span class="math display">\[
\left[\bar y - t^\ast_{n-1}(\alpha)\frac{\hat\sigma}{\sqrt{n}}, \, 
\bar y + t^\ast_{n-1}(\alpha)\frac{\hat\sigma}{\sqrt{n}} \right].
\]</span></p>
<p>The <span class="math inline">\(H_1\)</span> hypothesis is accepted at level <span class="math inline">\(\alpha\)</span> when this interval falls into the interval <span class="math inline">\([\Delta_1, \Delta_2]\)</span>.</p>
<p>This can be written as follows: <span class="math display">\[
T_1 := 
\frac{\bar y - \Delta_1}{\hat\sigma/\sqrt{n}} 
\geq t^\ast_{n-1}(\alpha)
\quad \text{and} \quad 
T_2 := 
\frac{\bar y - \Delta_2}{\hat\sigma/\sqrt{n}} 
\leq - t^\ast_{n-1}(\alpha).
\]</span></p>
<p>Observe that <span class="math display">\[
T_1 = \frac{z - \delta_1}{\dfrac{\sqrt{n-1}\hat\sigma/\sigma}{\sqrt{n-1}}}
\]</span> where <span class="math display">\[
z = \frac{\sqrt{n}}{\sigma}(\bar y - \mu) \sim {\cal N}(0,1)
\quad \text{and} \quad 
\delta_1 = \frac{\mu - \Delta_1}{\sigma/\sqrt{n}}.
\]</span></p>
<p>By reasoning in the same way for <span class="math inline">\(T_2\)</span>, we find that the pair <span class="math inline">\((T_1, T_2)\)</span> follows the Owen distribution with degrees of freedom <span class="math inline">\(\nu = n-1\)</span>, and non-centrality parameters <span class="math inline">\(\delta_1\)</span> given above and <span class="math inline">\(\delta_2 = \tfrac{\mu - \Delta_2}{\sigma/\sqrt{n}}\)</span>.</p>
<p>Therefore the power of the test - <em>i.e.</em> the probability to accept <span class="math inline">\(H_1\)</span> - is given by <span class="math display">\[
O_4\bigl(n-1, t^\ast_{n-1}(\alpha), -t^\ast_{n-1}(\alpha), \delta_1, \delta_2\bigr),
\]</span> and then can be evaluated thanks to <code>powen4</code>.</p>
</div>
<div id="inconclusive-equivalence-test" class="section level2">
<h2>Inconclusive equivalence test</h2>
<p>The result of the equivalence test is said to be <em>inconclusive</em> when only one of the bounds of the confidence interval falls into the interval <span class="math inline">\([\Delta_1, \Delta_2]\)</span>.</p>
<p>The probability to get an inconclusive result can be obtained with the <code>OwenQ</code> package. We show and check that below with the help of simulations.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1">Delta1 &lt;-<span class="st"> </span><span class="dv">-2</span>; Delta2 &lt;-<span class="st"> </span><span class="dv">2</span> </a>
<a class="sourceLine" id="cb5-2" title="2">mu &lt;-<span class="st"> </span><span class="dv">1</span>; sigma &lt;-<span class="st"> </span><span class="dv">6</span>; n &lt;-<span class="st"> </span>30L</a>
<a class="sourceLine" id="cb5-3" title="3">alpha &lt;-<span class="st"> </span><span class="fl">0.05</span></a>
<a class="sourceLine" id="cb5-4" title="4">nsims &lt;-<span class="st"> </span><span class="fl">1e6</span>L</a>
<a class="sourceLine" id="cb5-5" title="5">equivalence &lt;-<span class="st"> </span>inconclusive &lt;-<span class="st"> </span><span class="kw">numeric</span>(nsims)</a>
<a class="sourceLine" id="cb5-6" title="6"><span class="cf">for</span> (i <span class="cf">in</span> 1L<span class="op">:</span>nsims) {</a>
<a class="sourceLine" id="cb5-7" title="7">  y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n, mu, sigma)</a>
<a class="sourceLine" id="cb5-8" title="8">  CI &lt;-<span class="st"> </span><span class="kw">t.test</span>(<span class="dt">x =</span> y, <span class="dt">conf.level =</span> <span class="dv">1-2</span><span class="op">*</span>alpha)<span class="op">$</span>conf.int</a>
<a class="sourceLine" id="cb5-9" title="9">  equivalence[i] &lt;-<span class="st"> </span>(CI[<span class="dv">1</span>] <span class="op">&gt;</span><span class="st"> </span>Delta1) <span class="op">&amp;&amp;</span><span class="st"> </span>(CI[<span class="dv">2</span>] <span class="op">&lt;</span><span class="st"> </span>Delta2)</a>
<a class="sourceLine" id="cb5-10" title="10">  inconclusive[i] &lt;-<span class="st"> </span>((CI[<span class="dv">1</span>] <span class="op">&lt;</span><span class="st"> </span>Delta1) <span class="op">&amp;&amp;</span><span class="st"> </span>(CI[<span class="dv">2</span>] <span class="op">&gt;</span><span class="st"> </span>Delta1)) <span class="op">||</span></a>
<a class="sourceLine" id="cb5-11" title="11"><span class="st">    </span>((CI[<span class="dv">1</span>] <span class="op">&lt;</span><span class="st"> </span>Delta2) <span class="op">&amp;&amp;</span><span class="st"> </span>(CI[<span class="dv">2</span>] <span class="op">&gt;</span><span class="st"> </span>Delta2))</a>
<a class="sourceLine" id="cb5-12" title="12">}</a></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1">dof &lt;-<span class="st"> </span>n<span class="dv">-1</span></a>
<a class="sourceLine" id="cb6-2" title="2">q &lt;-<span class="st"> </span><span class="kw">qt</span>(<span class="dv">1</span><span class="op">-</span>alpha, dof)</a>
<a class="sourceLine" id="cb6-3" title="3">se &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="dv">1</span><span class="op">/</span>n)<span class="op">*</span>sigma</a>
<a class="sourceLine" id="cb6-4" title="4">delta1 &lt;-<span class="st"> </span>(mu<span class="op">-</span>Delta1)<span class="op">/</span>se; delta2 &lt;-<span class="st"> </span>(mu<span class="op">-</span>Delta2)<span class="op">/</span>se</a>
<a class="sourceLine" id="cb6-5" title="5"><span class="co"># probability to get equivalence</span></a>
<a class="sourceLine" id="cb6-6" title="6"><span class="kw">mean</span>(equivalence)</a>
<a class="sourceLine" id="cb6-7" title="7"><span class="co">## [1] 0.092927</span></a>
<a class="sourceLine" id="cb6-8" title="8"><span class="kw">powen4</span>(dof, q, <span class="op">-</span>q, delta1, delta2)</a>
<a class="sourceLine" id="cb6-9" title="9"><span class="co">## [1] 0.09300963</span></a>
<a class="sourceLine" id="cb6-10" title="10"><span class="co"># probability to get inconclusive</span></a>
<a class="sourceLine" id="cb6-11" title="11"><span class="kw">mean</span>(inconclusive)</a>
<a class="sourceLine" id="cb6-12" title="12"><span class="co">## [1] 0.901587</span></a>
<a class="sourceLine" id="cb6-13" title="13"><span class="kw">ptOwen</span>(q, dof, delta2) <span class="op">-</span><span class="st"> </span><span class="kw">ptOwen</span>(<span class="op">-</span>q, dof, delta1) <span class="op">-</span><span class="st"> </span><span class="kw">powen4</span>(dof, q, <span class="op">-</span>q, delta1, delta2)</a>
<a class="sourceLine" id="cb6-14" title="14"><span class="co">## [1] 0.90139</span></a></code></pre></div>
</div>
<div id="parallel-design" class="section level2">
<h2>Parallel design</h2>
<p>Now consider two independent samples <span class="math inline">\(x_i \sim_{\text{iid}} {\cal N}(\mu, \sigma^2)\)</span> for <span class="math inline">\(i=1, \ldots, n_1\)</span>. and <span class="math inline">\(y_i \sim_{\text{iid}} {\cal N}(\nu, \sigma^2)\)</span> for <span class="math inline">\(i=1, \ldots, n_2\)</span> and the alternative hypothesis <span class="math inline">\(H_1\colon\bigl\{|\mu-\nu| \leq \Delta\bigr\}\)</span>. The power of this test is evaluated by the function <code>powerTOST</code> below. The parameter <code>delta0</code> corresponds to the difference <span class="math inline">\(\mu-\nu\)</span>.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1">powerTOST &lt;-<span class="st"> </span><span class="cf">function</span>(alpha, delta0, Delta, sigma, n1, n2) {</a>
<a class="sourceLine" id="cb7-2" title="2">  se &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="dv">1</span><span class="op">/</span>n1 <span class="op">+</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>n2) <span class="op">*</span><span class="st"> </span>sigma</a>
<a class="sourceLine" id="cb7-3" title="3">  delta1 &lt;-<span class="st"> </span>(delta0 <span class="op">+</span><span class="st"> </span>Delta) <span class="op">/</span><span class="st"> </span>se</a>
<a class="sourceLine" id="cb7-4" title="4">  delta2 &lt;-<span class="st"> </span>(delta0 <span class="op">-</span><span class="st"> </span>Delta) <span class="op">/</span><span class="st"> </span>se</a>
<a class="sourceLine" id="cb7-5" title="5">  dof &lt;-<span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span>n2 <span class="op">-</span><span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb7-6" title="6">  q &lt;-<span class="st"> </span><span class="kw">qt</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>alpha, dof)</a>
<a class="sourceLine" id="cb7-7" title="7">  <span class="kw">powen4</span>(dof, q, <span class="op">-</span>q, delta1, delta2)</a>
<a class="sourceLine" id="cb7-8" title="8">}</a></code></pre></div>
</div>
</div>
<div id="the-owen-t-function" class="section level1">
<h1>The Owen <span class="math inline">\(T\)</span>-function</h1>
<p>The <code>OwenQ</code> package also provides an implementation of the Owen <span class="math inline">\(T\)</span>-function, under the name <code>OwenT</code>. This is a port of the function <code>owens_t</code> of <code>boost</code>, the peer-reviewed collection of C++ libraries.</p>
<p><img src="data:image/png;base64,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" /></p>
</div>
<div id="the-owen-q-functions" class="section level1">
<h1>The Owen <span class="math inline">\(Q\)</span>-functions</h1>
<p>The Owen cumulative functions are based on the two Owen <span class="math inline">\(Q\)</span>-functions <span class="math display">\[
Q_1(\nu, t, \delta, R) = \frac{1}{\Gamma\left(\frac{\nu}{2}\right)2^{\frac12(\nu-2)}}
\int_0^R \Phi\left(\frac{tx}{\sqrt{\nu}}-\delta\right)
x^{\nu-1} e^{-\frac{x^2}{2}} \mathrm{d}x
\]</span> and <span class="math display">\[
Q_2(\nu, t, \delta, R) = \frac{1}{\Gamma\left(\frac{\nu}{2}\right)2^{\frac12(\nu-2)}}
\int_R^\infty \Phi\left(\frac{tx}{\sqrt{\nu}}-\delta\right)
x^{\nu-1} e^{-\frac{x^2}{2}} \mathrm{d}x.
\]</span></p>
<p>They are implemented in the <code>OwenQ</code> package under the respective names <code>OwenQ1</code> and <code>OwenQ2</code> (for integer values of <span class="math inline">\(\nu\)</span>).</p>
</div>
<div id="application-equal-tailed-tolerance-interval" class="section level1">
<h1>Application: Equal-tailed tolerance interval</h1>
<p>Consider the statistical model given by a sample <span class="math inline">\(y_i \sim_{\text{iid}} {\cal N}(\mu, \sigma^2)\)</span> for <span class="math inline">\(i=1, \ldots, n\)</span>.</p>
<p>An equal-tailed <span class="math inline">\((p,\alpha)\)</span>-tolerance interval is an interval containing at least <span class="math inline">\(100p\%\)</span> of the “center data” with <span class="math inline">\(100(1-\alpha)\%\)</span> confidence.</p>
<p>The natural choice for such an interval is, as shown by Owen (1965), <span class="math display">\[
\bigl[\bar y - k_e \hat\sigma, \bar y + k_e \hat\sigma]
\]</span> where <span class="math inline">\(k_e\)</span> satisfies <span class="math display">\[
O_2(n-1, k_e\sqrt{n}, -k_e\sqrt{n}, \delta, -\delta) = 1-\alpha
\]</span> where <span class="math inline">\(\delta = \sqrt{n}z_{(1+p)/2}\)</span>.</p>
<p>Therefore, the tolerance factor <span class="math inline">\(k_e\)</span> can be determined with the help of the <code>powen2</code> function of the <code>OwenQ</code> package. But it is more efficient to use the function <code>spowen2</code> for this purpose; <code>spowen2(nu, t, delta)</code> has the same value as <code>powen2(nu, t, -t, delta, -delta)</code> but it is evaluated more efficiently.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1">p &lt;-<span class="st"> </span><span class="fl">0.9</span>; alpha &lt;-<span class="st"> </span><span class="fl">0.05</span></a>
<a class="sourceLine" id="cb8-2" title="2">n &lt;-<span class="st"> </span><span class="dv">100</span></a>
<a class="sourceLine" id="cb8-3" title="3">delta &lt;-<span class="st"> </span><span class="kw">sqrt</span>(n)<span class="op">*</span><span class="kw">qnorm</span>((<span class="dv">1</span><span class="op">+</span>p)<span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb8-4" title="4"><span class="kw">uniroot</span>(<span class="cf">function</span>(ke) <span class="kw">spowen2</span>(n<span class="dv">-1</span>, ke<span class="op">*</span><span class="kw">sqrt</span>(n), delta) <span class="op">-</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>alpha), </a>
<a class="sourceLine" id="cb8-5" title="5">        <span class="dt">lower=</span><span class="kw">qnorm</span>(<span class="dv">1</span><span class="op">-</span>alpha), <span class="dt">upper=</span><span class="dv">5</span>, <span class="dt">extendInt =</span> <span class="st">&quot;upX&quot;</span>, <span class="dt">tol=</span><span class="fl">1e-9</span>)<span class="op">$</span>root</a>
<a class="sourceLine" id="cb8-6" title="6"><span class="co">## [1] 1.981513</span></a></code></pre></div>
<p>The <span class="math inline">\(k_e\)</span> factors are tabulated in Krishnamoorthy &amp; Mathew’s book.</p>
</div>
<div id="internal-functions-numerical-integration" class="section level1">
<h1>Internal functions: numerical integration</h1>
<p>The <code>OwenQ</code> package provides three internal functions, <code>iOwenQ1</code>, <code>iOwenQ2</code> and <code>ipowen4</code>, which respectively perform the evaluation of <span class="math inline">\(Q_1\)</span>, <span class="math inline">\(Q_2\)</span> and <span class="math inline">\(O_4\)</span> by numerical integration using the <code>RcppNumerical</code> package. They can be called with a positive non-integer value of <span class="math inline">\(\nu\)</span>. The evaluation of <span class="math inline">\(O_4\)</span> with <code>ipowen4</code> is correct only for <span class="math inline">\(t_1 &gt; t_2\)</span> and <span class="math inline">\(\delta_1 &gt; \delta_2\)</span>.</p>
</div>
<div id="references" class="section level1">
<h1>References</h1>
<ul>
<li><p>Owen, D. B. (1965). <em>A special case of a bivariate noncentral t-distribution.</em> Biometrika 52, 437-446.</p></li>
<li><p>Krishnamoorthy &amp; Mathew (2009). <em>Statistical Tolerance Regions</em>. Wiley.</p></li>
</ul>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
