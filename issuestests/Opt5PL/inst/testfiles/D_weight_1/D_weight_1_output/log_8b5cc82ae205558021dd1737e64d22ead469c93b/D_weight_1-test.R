testlist <- list(inv1 = structure(c(1.33779158334884e+255, 1014.41659610807,  5.85929043357043e-147, 7.38820098576188e+48, 4.31633818039447e+275,  4.77241229424564e+213, 1.536788205081e-70, 1.35985283229e-200,  2.88148870178626e-36, 3.37445149680423e-242, 4.33314130601525e+197,  1.5271771130006e+47, NaN, 4.02398140921988e-217, 2.3599888596967e-51,  6.94041433797649e-235, NA, 8.56546540366183e+157, 2.01512468999105e+52,  8.72562049796477e-252, 2.9391941043041e-235, 2.51768938896267e-42,  3.86367239973903e-17, 6.61466418158144e-301, 1.15011507333551e+67,  0.000118372330344953, NA, 7.15748514439391e-217, 6.35841310923034e-61,  -Inf, 2.57060431561171e-171, 1.24959200147743e-188, 108477607277.522,  Inf, 3.62204285143567e+193, 1.2715376014106e+104), .Dim = c(6L,  6L)), inv2 = structure(c(1.73899214119948e+105, 4.77675600257841e+303,  6.14688652699751e-10, 4.22676518120684e-216, 3.84330998010736e-298,  4.36029219275766e-246, 1.02355929424686e+132, 2.49537616188609e+135,  3.10389567630613e-170, 1.2659644075439e-133, 3.804177660294e-63,  1.15456835233763e+21, 4.13756524083396e-191, 2.35205047162603e+180,  2.18882243302974e-160, 3.25360295804045e+267, 6.07163235239169e+190,  7.30379866861861e+288, 2.5704109616095e+151, 2.49500312763905e-222,  3.45534303020298e+248, 2.99284738103634e-11, 7.16806384455902e-88,  1.06077301374053e-73, 4.83120452779365e+72, 2.05656194263181e+119,  4.99361848781735e+274, 1.43390356004187e+303, 8.23032671781061e-230,  1.25646427106505e-70), .Dim = 5:6), inv3 = structure(c(1.74670712252002e-89,  5.26084996747338e-141, 1.03196628325176e+138), .Dim = c(1L, 3L )), q = c(1.27890654606226e-188, 7527485546020.59, -2.14488209182332e+105,  Inf, -2.02048162434253e-44, NaN, 3.42032101584627e-93, 8.27932373953685e-269,  -4.36408839884835e-38, Inf, 0), T1 = c(-5.70400762505135e-238,  -2.07081855709675e-80, 8.5455382271307e+192, 3.13880924774272e-45,  -1.31829639664378e-67, -3.88007310706922e+111, -2.73349784924818e-273,  3.74346808450414e+144, -1.11691051946455e+197, 8.24572025426636e-140,  -3143310072.61663, -2.7154489829733e+175, -8.99302500161768e+140,  1.38164596936339e+132, 1.0427490088369e-173, 1.33396984348503e-166,  -3.22048262438252e-233, -899109387869.941, -5.80325779441735e+65,  -3.02866560953896e+104, NA, -9.06850566920262e+282, 4.63877483327205e+62,  -5.6240952560463e-74, -1.4458869385411e-68, 0.0071543511529997,  -1.70060342788749e-43, -1.85921099298703e+32, 869729451107702,  -6.40224370293622e+262, -6.25281312970967e+211, -1.23564473316565e-266,  -3.01267155424124e-77, 1.38496627364502e+41, -2.70179665334174e-176,  -7.77752531682237e-298, -1.63731843829226e-198, -4.62759232740779e-205,  1.66633462670291e-32, 1.45342792648455e-268, 4.90457643113392e-204,  2.38395639244005e+148, 7.77331130481836e+295, -1.20509976596249e+99,  -3.30076249319665e-47, 7.69574054488415e-24, Inf, NaN, -2.73128308680604e+126,  7.04770681659135e-119, -8.70419004886074e-200, -3.29073095521994e-118,  4.53742166926922e+27, 1.83022226777067e-288, 7.09880286895475e+239,  -1.80471011938495e-217, -987689888031272, -3.35262492003067e+233,  -7.52334729366899e-175, 4.90457643113392e-204, -1.73242535028081e-255,  1.89045627153742e-83, 4.62993284519814e+141, -2.96832121510248e+248,  2.26228628103453e-308, -1.28462879892518e+49, 4.45231659910143e+103,  -2.17954322173227e-274, -2.8037364869221e-33, 2.75942888158733e-307,  -6.26090049991747e+56, 0.000336919605581402, -5.29721002733514e-305,  -4.18413394321102e-91, 3.65700452771446e+41, 2.4173207762824e-265,  -3.04439602961377e-172, -6.07482970854101e-96, 1.02115779901467e-61,  -1.60520562931653e+131, 9.32367420976005e+86, 0), T2 = c(5.61680736417283e+76,  -2.40946879114043, 8.35702861817218e-106, NaN, -2.37346002276272e-55,  -Inf, -Inf, -4.70818414220532e+135, -1.98179933013598e-297, -2.8596606276986e+126,  -2.69791479876656e+64, -6.06870267837955e-183, -4.62523063177022e-11,  1.30378100053724e-58, 2.06226197337801e-294, -1.2859601668122e-36,  1.35747444673436e+230, -1.08517278778407e+21, 0), T3 = c(2.77730703874016e+236,  7.69894547972171e-89, 4.79081512353446e-238, -6.95266449137555e+179,  -4.8009062148321e-51, -1.03735133505817e+89, -1.92543005321734e+37,  -1398590797162098, 4.55892887662829e-51, -3.35895169723046e-231,  3.84841827489841e-132, -1.06283595190779e-273, -1.55546278627295e+101,  -2.32410196309005e-153, -3.01277955902886e-24, -1.10321006984924e+275,  -1.34105756730763e+76, -5.77783211459989e-261, -2.88977819304177e+203,  8.51910493988421e+248, 2.06264973798797e-300, 1.69617677150846e-176,  3.95356067376995e-05, -3.80147658297875e-75, -7.9547895040856e+143,  -2.57911090135425e+123, -3.51254464728356e+273, -2.34328404761519e+260,  8.80712201373375e+183, 2.31766489729392e-54, 4.18428537539022e-148,  1.3348033285467e-139, 1.67087417924583e-167, 6.9554206202846e-180,  -7.79209911505028e+98, 1.36005180340415e+121, 1.15842075614821e+229,  8.35637198583682e-278, -3.75230294330584e+66, -3.21015763055744e-32,  -1.55755204553061e+235, -7.72216968758778e-253, 8.98946105140077e+269,  -3.21962601466631e+161, 1.30921793400396e+71, 8.26375539876811e-190,  9.31283971174604e+89, -6.75448839328513e-220, 1.64109314280215e+75,  2.8040291576442e+27, 2.29030793996049e-111, -6.54475334577904e-151,  1.16304723133863e-218, -1.18723772976676e-284, -9.51031387410402e-191,  8.77265415793993e-187, 1.57168822390924e+240, -1.3971731260787e+92,  1.34932341104641e+292, -3.22947485332121e-288, 9.99304288613868e-60,  -7.59914517471652e-256, -1.39293428846137e-222, 9.85840006934584e-112,  -2.22218593248605e-107, 2.98108453682534e+190, -1.37581714363424e-206,  -5.68667497245759e-225, -9.65180973065669e+90, 9702948313841402,  3.51092011436345e+221, -1.31426308960198e-70, 2.63415471326608e-277,  -2.78333952996708e-10, -7.65986890271382e+184, -5.06875442470097e+59,  2.02990007093655e-114, -2.82943423225195e-306, -1.24961327230796e-277,  1.0755146169429e-113, 2.69652629028302e-45, -1.71556230015838e+240,  -4.4848092241629e-168, -1.97776636533322e-305, -7.87099934488094e+182 ), W = c(6.47599652406816e+188, -1.5600959424723e+246, -7.50585834614888e+284,  -9.27444379465874e+240, 9.49004278472289e+222, -2.74091669569808e+256,  -6.06628630504608e-44, -0.00101940368673233, 3.06107636871548e+238,  6.55275385389841e-240, -1.48399874396118e+47, 9.16904933188939e-35,  -2.07467736400536e-284, 6.94131478577824e+164, -5.5967216936932e-168,  -3.58047314657879e-10, 4.92682010218359e-88, -1.11188922097758e-72,  1.3976614997431e-176, -1.46673586226245e+64, 1.54710493323576e-298,  6.01409586841658e+221, 8.84504292234847e-195, 1.58469253118779e+132,  -4.87411146232111e+199, -6.57814475580888e-121, -3.95540666931765e-64,  -Inf, NaN, 2.76504354121682e-247, 1.73449647887861e-218, -7.99673422465593e+32,  -2.65451953001246e-24, 2.90992270379842e-226, 1.59363195528273e-85,  Inf, 3.57163680144006e+306, -708033289221.513, 2.70556548924223e-169,  1.94564217794711e-174, 2.16961927502633e-222, 2.86187280622422e+259,  -1.70099699382665e-276, 5.99249482420488e+109, -6.87851197370956e+103,  -4.04479138133641e+229, 1.15534477548193e+107, 5.71273754056285e-194,  2.01701324239408e+253, -3.11231333158067e-229, -Inf, -2.19771425923763e-185,  9.33597072267938e-293, 7.34305010414498e-165, -1.04191463999044e-193,  2.15177012013628e+165, -6.94313509841751e-208, 0), X = c(-1.04703359173554e-212,  -3.42948307300528e+169, -6.51103576841566e-199, -2.93575222347303e-83,  -3.28194667000537e+125, 6.61638600910275e+291, -37034973.3593513,  1.60248082816804e+117, 6.07806465126004e+149, -3.17274301152241e+173,  -9.77957845880317e+284, -2.56192885165833e-151, 1.28402779167093e-24,  -3.13694800025497e+280, -9.41875620434269e+105, -2.58218418239757e-257,  235775800.569269, 2.93234828383537e+306, 1.74336798610312e+158,  -3.23996823600008e+307, 3.71852009042203e-178, 2.00450353241887e-289,  -0.355520358278044, -9.69696954181406e+117, 1.87530197807736e+264,  -1.49050369515146e+182, 7.83683595432385e-121, 1.18621303716913e+215,  4.00672952441635e+247, -3.02647383613533e-101, 4.37844838790188e-259,  -5.35765550796585e+53, -3.31793778051243e-250, -2.9280857136942e+237,  8.7232339596998e-300, -2.1982514955913e-140, -3.19872616458614e+210,  4.99905765930714e+96, -2.68540880864927e-58, 2.8599207715114e+131,  -1.32823238796479e+48, 3.28611465477582e-280, -9.32694551540778e-188,  1.38446335569036e-157, 6.82352732631755e+109, 3.19701192463971e+181,  5.58039116575475e-56, 9.65942106981727e-296, 5.38681454408316e+99,  4.60708941895819e-43, -8.72175113732623e-102, 1.15856374824078e-119,  3.25637725726099e-68, -1.55100810944387e-230, 3.0732633245373e-306,  1.20516273440326e+156, -6.84845090835605e-281, -5.08671465747351e+56,  -4.91709527398552e-54, 1.61735794413119e-10, 9.23411968862526e+300,  -4.99715944123857e-30, 2.35458596489426e+305, 9.96991807989574e+266,  8.94805533399633e-275, 1.04971660718909e+131, -4.21834594157785e-17,  1321635663320.91, 1.27748336110306e+83, -1.23611188154045e-169,  -1.21272332505494e-60, -1.05926609209561e+306, -4.02204501148241e-184,  1.61238093354263e-282, -3.77643286783061e+292, 1.12159218305967e+247,  1.37372131146506e+114, -2.69732320395018e-280, -4.91236828352399e-208,  -6.75812575494598e-80, -4.90245137747196e+26))
result <- do.call(Opt5PL:::D_weight_1,testlist)
str(result)